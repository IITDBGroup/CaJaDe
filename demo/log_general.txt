INFO 2021-09-27 16:37:30,515[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 16:38:02,056[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 16:38:02] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 16:38:02,144[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 16:38:02] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 16:38:02,342[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 16:38:02] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO 2021-09-27 16:57:10,050[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 17:00:16,712[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 17:00:16] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 17:00:16,783[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 17:00:16] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 17:00:33,150[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 17:00:33] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 17:00:33,210[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 17:00:33] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 17:00:39,596[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 17:00:39] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 17:00:44,932[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 17:00:44,933[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 17:00:44,934[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 17:00:44,934[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 17:00:44,934[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 17:00:44,934[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 17:00:44,934[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 17:00:45,131[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS ;
ERROR 2021-09-27 17:00:45,140[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 286, in run_experiment
    user_pt_size, pt_dict, pt_relations = pg.gen_provenance_table(query=user_query[0],
  File "/home/juseung/CaJaDe/src/provenance_getter.py", line 67, in gen_provenance_table
    self.cur.execute(original_PT_view)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 1: CREATE VIEW original_pt AS ;
                                   ^

INFO 2021-09-27 17:00:45,145[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 17:00:45] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:18:32,328[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:18:34,882[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:18:34] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:18:35,004[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:18:35] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 20:18:41,544[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:18:41] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:18:41,589[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:18:41] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 20:18:45,880[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:18:45] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:18:50,439[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:18:50,439[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:18:50,440[experiments.py:run_experiment:269]f1_sample_type : 's.0'
ERROR 2021-09-27 20:18:50,641[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 286, in run_experiment
    user_pt_size, pt_dict, pt_relations = pg.gen_provenance_table(query=user_query[0],
  File "/home/juseung/CaJaDe/src/provenance_getter.py", line 61, in gen_provenance_table
    gen_original_pt_query = output.decode("utf-8")
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 190: invalid continuation byte
INFO 2021-09-27 20:18:50,666[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:18:50] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:22:39,785[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:22:42,133[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:22:42] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:22:42,218[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:22:42] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:22:47,239[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:22:47] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:22:47,278[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:22:47] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:22:51,950[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:22:51] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:22:56,699[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:22:56,700[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:22:56,700[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:22:56,700[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:22:56,700[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:22:56,700[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:22:56,700[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:22:56,701[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:22:56,701[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:22:56,701[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:22:56,701[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:22:56,701[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:22:56,701[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:22:56,702[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:22:56,702[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:22:56,702[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:22:56,702[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:22:56,702[experiments.py:run_experiment:269]f1_sample_type : 's.0'
ERROR 2021-09-27 20:22:56,905[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 286, in run_experiment
    user_pt_size, pt_dict, pt_relations = pg.gen_provenance_table(query=user_query[0],
  File "/home/juseung/CaJaDe/src/provenance_getter.py", line 61, in gen_provenance_table
    gen_original_pt_query = output.decode("utf-8")
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 376: invalid start byte
INFO 2021-09-27 20:22:56,912[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:22:56] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:26:51,921[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:26:54,376[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:26:54] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:26:54,443[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:26:54] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:26:59,057[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:26:59] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:26:59,101[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:26:59] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:27:03,080[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:27:03] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:27:07,093[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:27:07,093[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:27:07,093[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:27:07,094[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:27:07,095[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:27:07,095[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 20:27:07,306[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 20:27:07,396[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 20:27:07,427[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 20:27:07,428[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 20:27:07,428[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 20:27:07,429[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 20:27:08,121[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:27:08,268[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:27:08,411[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:27:08,552[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 20:27:08,685[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 20:27:08,685[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 20:27:08,685[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 20:27:08,685[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 20:27:08,703[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 20:27:08,709[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:27:08,756[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 20:27:08,773[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 20:27:08,773[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 20:27:08,861[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:27:08,862[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:27:08,863[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:27:08,863[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:27:08,863[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:27:08,864[pattern_generator.py:gen_patterns:1207]   a_5
0  106
1  112
2  108
3   69
4   85
DEBUG 2021-09-27 20:27:09,749[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 20:27:09,757[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:27:09,759[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:27:09,778[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   NOP
5   regular season   HOU
6   regular season   LAC
7   regular season   ATL
8   regular season   POR
9   regular season   WAS
10  regular season   DAL
11  regular season   CLE
12  regular season   UTA
13  regular season   MIA
14  regular season   TOR
15  regular season   CHA
16  regular season   MEM
17  regular season   BKN
18  regular season   PHI
19  regular season   DET
20  regular season   ORL
21  regular season   OKC
22  regular season   NYK
23  regular season   SAS
24  regular season   BOS
DEBUG 2021-09-27 20:27:09,797[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 20:27:09,797[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:27:09,824[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:27:09,825[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:27:09,825[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:27:09,825[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:27:09,825[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:27:09,826[pattern_generator.py:gen_patterns:1207]   a_5
0  107
1   99
2  107
3   83
4  108
DEBUG 2021-09-27 20:27:10,677[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 20:27:10,692[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:27:10,693[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:27:10,719[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   NOP
4   regular season   PHX
5   regular season   SAS
6   regular season   POR
7   regular season   DAL
8   regular season   OKC
9   regular season   SAC
10  regular season   LAL
11  regular season   DEN
12  regular season   IND
13  regular season   TOR
14  regular season   UTA
15  regular season   MIN
16  regular season   DET
17  regular season   CLE
18  regular season   WAS
19  regular season   MEM
20  regular season   CHA
21  regular season   NYK
22  regular season   MIL
23  regular season   BOS
DEBUG 2021-09-27 20:27:10,738[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 20:27:10,738[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:27:10,765[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:27:10,765[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:27:10,766[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:27:10,766[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:27:10,766[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:27:10,766[pattern_generator.py:gen_patterns:1207]   a_5
0  107
1  129
2  115
3  104
4  112
DEBUG 2021-09-27 20:27:11,448[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 20:27:11,450[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 482, in run_experiment
    Create_Stats_Table(conn=conn, stats_trackers=stats_trackers, stats_relation_name='time_and_params', schema=result_schema)
  File "/home/juseung/CaJaDe/src/experiments.py", line 62, in Create_Stats_Table
    cur.execute('CREATE SCHEMA IF NOT EXISTS '+schema)
psycopg2.errors.InsufficientPrivilege: permission denied for database nba

INFO 2021-09-27 20:27:11,451[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:27:11] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:41:59,882[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:42:13,129[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:13] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:42:13,191[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:13] "GET /static/main.css HTTP/1.1" 200 -
ERROR 2021-09-27 20:42:19,126[app.py:log_exception:1454]Exception on /db/ [POST]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 26, in db_connect
    globals()['conn'] = pg2.connect(database=form_data['dbname'],
  File "/home/juseung/cajade/lib/python3.8/site-packages/psycopg2/__init__.py", line 126, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  Peer authentication failed for user "postgres"

INFO 2021-09-27 20:42:19,128[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:19] "[35m[1mPOST /db/ HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:42:42,538[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:42:45,214[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:45] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:42:45,277[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:45] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:42:50,281[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:50] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:42:50,327[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:50] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:42:53,984[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:53] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:42:58,942[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:42:58,942[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:42:58,943[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:42:58,944[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:42:58,944[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:42:58,944[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:42:58,944[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:42:58,944[experiments.py:run_experiment:269]f1_sample_type : 's.0'
ERROR 2021-09-27 20:42:59,151[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 286, in run_experiment
    user_pt_size, pt_dict, pt_relations = pg.gen_provenance_table(query=user_query[0],
  File "/home/juseung/CaJaDe/src/provenance_getter.py", line 61, in gen_provenance_table
    gen_original_pt_query = output.decode("utf-8")
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xde in position 373: invalid continuation byte
INFO 2021-09-27 20:42:59,157[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:42:59] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:44:14,980[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:44:17,660[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:44:17] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:44:17,722[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:44:17] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 20:44:21,466[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:44:21] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:44:21,513[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:44:21] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:44:25,092[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:44:25] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:44:29,167[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:44:29,168[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 20:44:29,370[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 20:44:29,462[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 20:44:29,482[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 20:44:29,484[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 20:44:29,484[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 20:44:29,484[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 20:44:29,923[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:44:30,055[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:44:30,200[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:44:30,350[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 20:44:30,487[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 20:44:30,487[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 20:44:30,487[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 20:44:30,487[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 20:44:30,499[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 20:44:30,501[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:44:30,520[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 20:44:30,534[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 20:44:30,534[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 20:44:30,583[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:44:30,584[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:44:30,585[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:44:30,585[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:44:30,585[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:44:30,587[pattern_generator.py:gen_patterns:1207]   a_5
0   99
1   97
2  104
3   92
4  120
DEBUG 2021-09-27 20:44:31,484[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 20:44:31,493[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:44:31,494[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:44:31,515[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   UTA
5   regular season   HOU
6   regular season   NOP
7   regular season   MIA
8   regular season   TOR
9   regular season   SAC
10  regular season   ATL
11  regular season   LAC
12  regular season   CLE
13  regular season   POR
14  regular season   DAL
15  regular season   MEM
16  regular season   IND
17  regular season   SAS
18  regular season   WAS
19  regular season   CHA
20  regular season   OKC
21  regular season   ORL
22  regular season   DET
23  regular season   DEN
24  regular season   BKN
25  regular season   CHI
26  regular season   PHI
27  regular season   NYK
28  regular season   BOS
DEBUG 2021-09-27 20:44:31,535[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 20:44:31,535[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:44:31,561[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:44:31,562[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:44:31,562[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:44:31,562[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:44:31,562[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:44:31,563[pattern_generator.py:gen_patterns:1207]   a_5
0  105
1  112
2   83
3  118
4  135
DEBUG 2021-09-27 20:44:32,180[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 20:44:32,193[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:44:32,195[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:44:32,217[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   NOP
4   regular season   SAS
5   regular season   LAL
6   regular season   SAC
7   regular season   POR
8   regular season   DAL
9   regular season   OKC
10  regular season   DEN
11  regular season   IND
12  regular season   TOR
13  regular season   CLE
14  regular season   UTA
15  regular season   DET
16  regular season   PHX
17  regular season   NYK
18  regular season   ATL
19  regular season   BKN
20  regular season   CHA
21  regular season   HOU
22  regular season   WAS
23  regular season   ORL
24  regular season   BOS
25  regular season   MIL
DEBUG 2021-09-27 20:44:32,235[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 20:44:32,235[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:44:32,261[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:44:32,262[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:44:32,262[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:44:32,262[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:44:32,262[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:44:32,263[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1  100
2  102
3  107
4  132
DEBUG 2021-09-27 20:44:32,881[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 20:44:32,883[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 482, in run_experiment
    Create_Stats_Table(conn=conn, stats_trackers=stats_trackers, stats_relation_name='time_and_params', schema=result_schema)
  File "/home/juseung/CaJaDe/src/experiments.py", line 62, in Create_Stats_Table
    cur.execute('CREATE SCHEMA IF NOT EXISTS '+schema)
psycopg2.errors.InsufficientPrivilege: permission denied for database nba

INFO 2021-09-27 20:44:32,884[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:44:32] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:48:00,786[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:48:02,990[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:48:02] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:48:03,070[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:48:03] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:48:08,983[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:48:08] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:48:09,025[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:48:09] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:48:12,446[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:48:12] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:48:16,497[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:48:16,498[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:48:16,499[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:48:16,499[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:48:16,499[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:48:16,499[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:48:16,499[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:48:16,499[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 20:48:16,699[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 20:48:16,789[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 20:48:16,810[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 20:48:16,812[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 20:48:16,812[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 20:48:16,812[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 20:48:17,248[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:48:17,397[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:48:17,544[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:48:17,690[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 20:48:17,828[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 20:48:17,829[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 20:48:17,829[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 20:48:17,829[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 20:48:17,845[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 20:48:17,848[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:48:17,880[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 20:48:17,892[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 20:48:17,892[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 20:48:17,938[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:48:17,941[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:48:17,941[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:48:17,941[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:48:17,941[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:48:17,943[pattern_generator.py:gen_patterns:1207]   a_5
0   94
1  105
2   88
3  115
4  100
DEBUG 2021-09-27 20:48:18,838[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 20:48:18,852[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:48:18,855[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:48:18,875[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   UTA
4   regular season   PHX
5   regular season   NOP
6   regular season   LAC
7   regular season   WAS
8   regular season   CLE
9   regular season   POR
10  regular season   BKN
11  regular season   HOU
12  regular season   ATL
13  regular season   TOR
14  regular season   CHA
15  regular season   MEM
16  regular season   MIA
17  regular season   DAL
18  regular season   CHI
19  regular season   ORL
20  regular season   OKC
21  regular season   LAL
22  regular season   SAS
23  regular season   NYK
24  regular season   IND
25  regular season   BOS
26  regular season   DET
DEBUG 2021-09-27 20:48:18,898[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 20:48:18,898[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:48:18,926[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:48:18,927[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:48:18,927[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:48:18,927[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:48:18,927[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:48:18,928[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1   85
2  115
3  118
4   94
DEBUG 2021-09-27 20:48:19,550[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 20:48:19,560[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:48:19,564[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:48:19,591[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   LAC
4   regular season   POR
5   regular season   PHX
6   regular season   OKC
7   regular season   SAC
8   regular season   LAL
9   regular season   NOP
10  regular season   DEN
11  regular season   DAL
12  regular season   MEM
13  regular season   IND
14  regular season   MIN
15  regular season   WAS
16  regular season   CHA
17  regular season   CLE
18  regular season   UTA
19  regular season   DET
20  regular season   BKN
21  regular season   PHI
22  regular season   NYK
23  regular season   HOU
24  regular season   ORL
25  regular season   TOR
26  regular season   MIA
27  regular season   BOS
28  regular season   CHI
DEBUG 2021-09-27 20:48:19,612[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 20:48:19,613[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:48:19,638[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:48:19,639[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:48:19,639[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:48:19,639[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:48:19,639[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:48:19,640[pattern_generator.py:gen_patterns:1207]   a_5
0   85
1   97
2  104
3  105
4   92
DEBUG 2021-09-27 20:48:20,325[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 20:48:20,397[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 131, in explanation
    cursor.execute(query)
psycopg2.InterfaceError: cursor already closed
INFO 2021-09-27 20:48:20,401[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:48:20] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:50:09,283[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:50:11,834[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:50:11] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:50:11,894[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:50:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:50:16,735[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:50:16] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:50:16,771[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:50:16] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:50:20,133[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:50:20] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:50:23,518[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:50:23,519[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:50:23,526[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:50:23,526[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:50:23,526[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:50:23,526[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:50:23,526[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:50:23,526[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:50:23,527[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:50:23,528[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:50:23,528[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:50:23,528[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 20:50:23,726[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 20:50:23,794[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 20:50:23,820[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 20:50:23,823[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 20:50:23,823[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 20:50:23,823[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 20:50:24,365[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:50:24,494[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:50:24,637[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:50:24,762[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 20:50:24,908[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 20:50:24,908[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 20:50:24,908[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 20:50:24,909[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 20:50:24,923[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 20:50:24,925[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:50:24,949[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 20:50:24,957[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 20:50:24,957[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 20:50:25,000[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:50:25,002[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:50:25,002[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:50:25,003[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:50:25,003[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:50:25,004[pattern_generator.py:gen_patterns:1207]   a_5
0  116
1  124
2   97
3   88
4   93
DEBUG 2021-09-27 20:50:25,722[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 20:50:25,735[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:50:25,737[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:50:25,757[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   HOU
5   regular season   LAC
6   regular season   DAL
7   regular season   CHA
8   regular season   CLE
9   regular season   MEM
10  regular season   UTA
11  regular season   MIA
12  regular season   SAC
13  regular season   NOP
14  regular season   POR
15  regular season   TOR
16  regular season   WAS
17  regular season   ATL
18  regular season   SAS
19  regular season   LAL
20  regular season   NYK
21  regular season   DET
22  regular season   DEN
23  regular season   ORL
DEBUG 2021-09-27 20:50:25,774[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 20:50:25,774[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:50:25,797[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:50:25,798[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:50:25,798[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:50:25,798[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:50:25,798[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:50:25,799[pattern_generator.py:gen_patterns:1207]   a_5
0   99
1  104
2  104
3  106
4   88
DEBUG 2021-09-27 20:50:26,513[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 20:50:26,528[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:50:26,530[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:50:26,557[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   POR
4   regular season   LAC
5   regular season   SAS
6   regular season   NOP
7   regular season   SAC
8   regular season   DEN
9   regular season   OKC
10  regular season   DAL
11  regular season   LAL
12  regular season   ATL
13  regular season   MEM
14  regular season   DET
15  regular season   BKN
16  regular season   NYK
17  regular season   UTA
18  regular season   TOR
19  regular season   IND
20  regular season   MIN
21  regular season   CLE
22  regular season   CHA
23  regular season   PHI
24  regular season   WAS
25  regular season   CHI
26  regular season   MIL
27  regular season   MIA
DEBUG 2021-09-27 20:50:26,582[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 20:50:26,583[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:50:26,623[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:50:26,624[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:50:26,624[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:50:26,624[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:50:26,624[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:50:26,625[pattern_generator.py:gen_patterns:1207]   a_5
0  100
1   97
2  114
3  103
4  107
DEBUG 2021-09-27 20:50:27,327[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 20:50:27,395[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:50:27] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 20:51:53,718[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:51:56,644[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:51:56] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:51:56,704[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:51:56] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:52:01,124[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:52:01] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:52:01,168[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:52:01] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:52:04,721[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:52:04] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:52:08,406[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:52:08,407[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:52:08,407[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:52:08,407[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:52:08,407[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:52:08,408[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:52:08,409[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:52:08,409[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:52:08,409[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:52:08,409[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 20:52:08,614[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 20:52:08,716[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 20:52:08,736[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 20:52:08,738[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 20:52:08,738[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 20:52:08,738[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 20:52:09,203[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:52:09,346[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:52:09,492[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:52:09,639[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 20:52:09,786[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 20:52:09,787[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 20:52:09,787[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 20:52:09,787[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 20:52:09,804[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 20:52:09,809[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:52:09,837[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 20:52:09,850[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 20:52:09,850[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 20:52:09,901[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:52:09,902[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:52:09,903[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:52:09,903[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:52:09,903[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:52:09,904[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1  106
2  106
3  114
4   98
DEBUG 2021-09-27 20:52:10,640[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 20:52:10,653[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:52:10,654[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:52:10,672[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   HOU
4   regular season   PHX
5   regular season   UTA
6   regular season   NOP
7   regular season   ATL
8   regular season   WAS
9   regular season   MIN
10  regular season   MEM
11  regular season   BKN
12  regular season   CHA
13  regular season   POR
14  regular season   TOR
15  regular season   SAC
16  regular season   CLE
17  regular season   IND
18  regular season   SAS
19  regular season   LAL
20  regular season   MIA
21  regular season   OKC
22  regular season   ORL
23  regular season   DEN
24  regular season   DAL
25  regular season   BOS
DEBUG 2021-09-27 20:52:10,694[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 20:52:10,695[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:52:10,725[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:52:10,726[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:52:10,727[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:52:10,727[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:52:10,727[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:52:10,728[pattern_generator.py:gen_patterns:1207]   a_5
0  130
1   85
2  135
3   85
4   93
DEBUG 2021-09-27 20:52:11,424[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 20:52:11,442[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:52:11,447[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:52:11,490[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   NOP
3   regular season   PHX
4   regular season   LAC
5   regular season   OKC
6   regular season   DAL
7   regular season   SAC
8   regular season   POR
9   regular season   DEN
10  regular season   LAL
11  regular season   IND
12  regular season   SAS
13  regular season   WAS
14  regular season   CLE
15  regular season   DET
16  regular season   PHI
17  regular season   NYK
18  regular season   ATL
19  regular season   UTA
20  regular season   BKN
21  regular season   TOR
22  regular season   CHA
23  regular season   MIA
24  regular season   ORL
25  regular season   HOU
26  regular season   BOS
27  regular season   CHI
DEBUG 2021-09-27 20:52:11,524[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 20:52:11,525[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:52:11,551[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:52:11,552[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:52:11,552[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:52:11,552[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:52:11,552[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:52:11,553[pattern_generator.py:gen_patterns:1207]   a_5
0   63
1  108
2   94
3  108
4  116
DEBUG 2021-09-27 20:52:12,248[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 20:52:12,326[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 131, in explanation
    cursor.execute(query)
psycopg2.InterfaceError: cursor already closed
INFO 2021-09-27 20:52:12,331[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:52:12] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 20:55:07,835[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 20:55:12,258[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:55:12] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 20:55:12,334[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:55:12] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:55:19,082[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:55:19] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 20:55:19,125[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:55:19] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 20:55:22,485[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:55:22] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 20:55:25,932[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 20:55:25,933[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 20:55:25,933[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 20:55:25,934[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 20:55:25,934[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 20:55:25,934[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 20:55:25,935[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 20:55:25,935[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 20:55:25,935[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 20:55:25,935[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 20:55:25,936[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 20:55:25,936[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 20:55:25,936[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 20:55:25,937[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 20:55:25,937[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 20:55:25,937[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 20:55:25,938[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 20:55:25,938[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 20:55:26,144[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 20:55:26,241[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 20:55:26,272[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 20:55:26,274[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 20:55:26,274[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 20:55:26,274[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 20:55:26,815[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:55:26,958[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:55:27,099[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 20:55:27,240[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 20:55:27,386[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 20:55:27,387[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 20:55:27,387[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 20:55:27,387[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 20:55:27,403[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 20:55:27,409[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:55:27,450[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 20:55:27,468[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 20:55:27,468[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 20:55:27,520[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:55:27,527[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:55:27,527[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:55:27,527[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:55:27,528[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:55:27,530[pattern_generator.py:gen_patterns:1207]   a_5
0  101
1  108
2  100
3  112
4  103
DEBUG 2021-09-27 20:55:28,265[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 20:55:28,285[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:55:28,288[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:55:28,314[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   LAC
4   regular season   HOU
5   regular season   PHX
6   regular season   UTA
7   regular season   NOP
8   regular season   CLE
9   regular season   POR
10  regular season   DAL
11  regular season   WAS
12  regular season   SAC
13  regular season   MIA
14  regular season   TOR
15  regular season   BKN
16  regular season   MEM
17  regular season   IND
18  regular season   SAS
19  regular season   LAL
20  regular season   DET
21  regular season   DEN
22  regular season   PHI
23  regular season   NYK
24  regular season   BOS
25  regular season   ATL
DEBUG 2021-09-27 20:55:28,332[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 20:55:28,332[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:55:28,356[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:55:28,357[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:55:28,357[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:55:28,357[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:55:28,357[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:55:28,358[pattern_generator.py:gen_patterns:1207]   a_5
0   98
1  114
2  124
3  106
4   87
DEBUG 2021-09-27 20:55:29,087[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 20:55:29,101[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 20:55:29,104[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 20:55:29,125[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   LAC
4   regular season   POR
5   regular season   NOP
6   regular season   SAC
7   regular season   DAL
8   regular season   PHX
9   regular season   LAL
10  regular season   OKC
11  regular season   DEN
12  regular season   BKN
13  regular season   WAS
14  regular season   ATL
15  regular season   CLE
16  regular season   MEM
17  regular season   IND
18  regular season   MIN
19  regular season   UTA
20  regular season   DET
21  regular season   PHI
22  regular season   NYK
23  regular season   HOU
24  regular season   CHA
25  regular season   ORL
26  regular season   BOS
27  regular season   MIL
DEBUG 2021-09-27 20:55:29,148[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 20:55:29,149[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 20:55:29,184[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 20:55:29,186[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 20:55:29,186[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 20:55:29,186[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 20:55:29,186[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 20:55:29,187[pattern_generator.py:gen_patterns:1207]   a_5
0  111
1   88
2   99
3   89
4  118
DEBUG 2021-09-27 20:55:30,039[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 20:55:30,129[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 128, in explanation
    globals()['cursor'] = conn.cursor()
psycopg2.InterfaceError: connection already closed
INFO 2021-09-27 20:55:30,132[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 20:55:30] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 21:01:49,784[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 21:01:53,409[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:01:53] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 21:01:53,475[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:01:53] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 21:01:58,309[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:01:58] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 21:01:58,349[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:01:58] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:02:02,412[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:02:02] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 21:02:06,037[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 21:02:06,037[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 21:02:06,037[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 21:02:06,037[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 21:02:06,037[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 21:02:06,038[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 21:02:06,039[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 21:02:06,234[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 21:02:06,328[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 21:02:06,351[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 21:02:06,353[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 21:02:06,353[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 21:02:06,353[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 21:02:06,787[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:02:06,935[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:02:07,080[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:02:07,228[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 21:02:07,364[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 21:02:07,364[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 21:02:07,364[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 21:02:07,364[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 21:02:07,380[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 21:02:07,387[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:02:07,425[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 21:02:07,437[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 21:02:07,438[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 21:02:07,488[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:02:07,490[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:02:07,491[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:02:07,491[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:02:07,491[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:02:07,492[pattern_generator.py:gen_patterns:1207]   a_5
0  105
1  108
2   98
3  111
4  101
DEBUG 2021-09-27 21:02:08,283[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 21:02:08,298[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:02:08,300[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:02:08,324[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   MIN
5   regular season   POR
6   regular season   MIA
7   regular season   WAS
8   regular season   CHA
9   regular season   CLE
10  regular season   NOP
11  regular season   UTA
12  regular season   ATL
13  regular season   TOR
14  regular season   MEM
15  regular season   BKN
16  regular season   SAC
17  regular season   DAL
18  regular season   CHI
19  regular season   OKC
20  regular season   IND
21  regular season   PHI
22  regular season   LAL
23  regular season   HOU
24  regular season   ORL
25  regular season   DET
26  regular season   SAS
DEBUG 2021-09-27 21:02:08,343[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 21:02:08,343[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:02:08,368[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:02:08,370[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:02:08,370[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:02:08,370[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:02:08,370[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:02:08,370[pattern_generator.py:gen_patterns:1207]   a_5
0  111
1  108
2  124
3   94
4   96
DEBUG 2021-09-27 21:02:09,225[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 21:02:09,238[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:02:09,240[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:02:09,275[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   PHX
4   regular season   LAC
5   regular season   LAL
6   regular season   SAS
7   regular season   OKC
8   regular season   SAC
9   regular season   MIN
10  regular season   WAS
11  regular season   CHA
12  regular season   CLE
13  regular season   UTA
14  regular season   ATL
15  regular season   NYK
16  regular season   NOP
17  regular season   DEN
18  regular season   IND
19  regular season   TOR
20  regular season   MEM
21  regular season   DET
22  regular season   BKN
23  regular season   PHI
24  regular season   DAL
25  regular season   MIL
26  regular season   CHI
27  regular season   ORL
28  regular season   MIA
29  regular season   BOS
DEBUG 2021-09-27 21:02:09,310[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 21:02:09,310[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:02:09,341[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:02:09,342[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:02:09,342[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:02:09,342[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:02:09,342[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:02:09,343[pattern_generator.py:gen_patterns:1207]   a_5
0   94
1  108
2   88
3  103
4  110
DEBUG 2021-09-27 21:02:10,038[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 21:02:10,110[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 130, in explanation
    globals()['conn2'] = pg2.connect(database=form_data['test'], #dbname
NameError: name 'form_data' is not defined
INFO 2021-09-27 21:02:10,114[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:02:10] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 21:03:33,884[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 21:03:36,276[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:03:36] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 21:03:36,346[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:03:36] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:03:44,322[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:03:44] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 21:03:44,377[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:03:44] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:03:51,665[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:03:51] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 21:03:55,817[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 21:03:55,818[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 21:03:55,819[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 21:03:55,819[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 21:03:55,819[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 21:03:55,819[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 21:03:55,819[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 21:03:56,028[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 21:03:56,126[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 21:03:56,151[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 21:03:56,153[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 21:03:56,153[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 21:03:56,154[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 21:03:56,623[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:03:56,766[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:03:56,898[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:03:57,028[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 21:03:57,174[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 21:03:57,174[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 21:03:57,174[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 21:03:57,175[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 21:03:57,191[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 21:03:57,193[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:03:57,216[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 21:03:57,225[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 21:03:57,226[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 21:03:57,276[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:03:57,278[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:03:57,278[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:03:57,279[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:03:57,279[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:03:57,280[pattern_generator.py:gen_patterns:1207]   a_5
0   85
1  116
2   97
3  120
4  125
DEBUG 2021-09-27 21:03:58,155[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 21:03:58,167[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:03:58,169[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:03:58,195[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   HOU
4   regular season   MIN
5   regular season   UTA
6   regular season   PHX
7   regular season   NOP
8   regular season   ATL
9   regular season   CLE
10  regular season   SAC
11  regular season   TOR
12  regular season   MIA
13  regular season   WAS
14  regular season   CHA
15  regular season   MEM
16  regular season   BKN
17  regular season   DEN
18  regular season   ORL
19  regular season   PHI
20  regular season   POR
21  regular season   OKC
22  regular season   SAS
23  regular season   BOS
24  regular season   IND
DEBUG 2021-09-27 21:03:58,212[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 21:03:58,212[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:03:58,238[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:03:58,239[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:03:58,239[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:03:58,239[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:03:58,239[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:03:58,239[pattern_generator.py:gen_patterns:1207]   a_5
0  109
1   89
2  100
3   93
4  113
DEBUG 2021-09-27 21:03:58,880[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 21:03:58,897[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:03:58,901[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:03:58,943[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   NOP
4   regular season   LAC
5   regular season   PHX
6   regular season   SAS
7   regular season   DEN
8   regular season   SAC
9   regular season   OKC
10  regular season   DAL
11  regular season   IND
12  regular season   MIN
13  regular season   WAS
14  regular season   MEM
15  regular season   UTA
16  regular season   DET
17  regular season   BKN
18  regular season   PHI
19  regular season   NYK
20  regular season   ATL
21  regular season   LAL
22  regular season   CHA
23  regular season   CLE
24  regular season   MIA
25  regular season   ORL
26  regular season   TOR
27  regular season   BOS
DEBUG 2021-09-27 21:03:58,972[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 21:03:58,973[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:03:59,006[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:03:59,007[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:03:59,007[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:03:59,008[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:03:59,008[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:03:59,008[pattern_generator.py:gen_patterns:1207]   a_5
0   95
1  103
2  108
3   87
4  104
DEBUG 2021-09-27 21:03:59,635[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 21:03:59,699[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:03:59] "[31m[1mEXP /explanation HTTP/1.1[0m" 400 -
DEBUG 2021-09-27 21:05:49,790[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 21:05:49,790[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 21:05:49,791[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 21:05:49,791[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 21:05:49,791[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 21:05:49,791[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 21:05:49,791[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 21:05:49,792[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 21:05:49,792[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 21:05:49,792[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 21:05:49,792[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 21:05:49,792[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 21:05:49,792[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 21:05:49,793[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 21:05:49,793[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 21:05:49,793[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 21:05:49,793[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 21:05:49,793[experiments.py:run_experiment:269]f1_sample_type : 's.0'
ERROR 2021-09-27 21:05:49,794[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 127, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 281, in run_experiment
    scj = Schema_Graph_Generator(conn)
  File "/home/juseung/CaJaDe/src/sg_generator.py", line 24, in __init__
    self.cur = self.conn.cursor()
psycopg2.InterfaceError: connection already closed
INFO 2021-09-27 21:05:49,797[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:05:49] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 21:06:02,320[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 21:06:04,786[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:06:04] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 21:06:04,862[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:06:04] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:06:13,879[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:06:13] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 21:06:13,920[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:06:13] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:06:19,084[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:06:19] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 21:06:22,844[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 21:06:22,844[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 21:06:22,844[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 21:06:22,844[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 21:06:22,845[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 21:06:22,846[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 21:06:22,846[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 21:06:22,846[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 21:06:22,846[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 21:06:23,056[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 21:06:23,167[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 21:06:23,187[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 21:06:23,188[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 21:06:23,189[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 21:06:23,189[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 21:06:23,648[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:06:23,795[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:06:23,940[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:06:24,087[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 21:06:24,235[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 21:06:24,235[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 21:06:24,235[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 21:06:24,235[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 21:06:24,250[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 21:06:24,252[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:06:24,276[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 21:06:24,286[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 21:06:24,286[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 21:06:24,337[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:06:24,339[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:06:24,340[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:06:24,340[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:06:24,340[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:06:24,341[pattern_generator.py:gen_patterns:1207]   a_5
0  109
1   92
2  110
3  128
4   94
DEBUG 2021-09-27 21:06:25,183[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 21:06:25,196[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:06:25,198[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:06:25,217[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   UTA
5   regular season   MIN
6   regular season   HOU
7   regular season   NOP
8   regular season   DAL
9   regular season   WAS
10  regular season   CHA
11  regular season   MIA
12  regular season   CLE
13  regular season   BKN
14  regular season   TOR
15  regular season   MEM
16  regular season   BOS
17  regular season   LAL
18  regular season   ORL
19  regular season   DET
20  regular season   DEN
21  regular season   CHI
22  regular season   SAC
23  regular season   PHI
24  regular season   POR
25  regular season   ATL
DEBUG 2021-09-27 21:06:25,236[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 21:06:25,237[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:06:25,262[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:06:25,263[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:06:25,264[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:06:25,264[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:06:25,264[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:06:25,265[pattern_generator.py:gen_patterns:1207]   a_5
0  106
1  112
2  109
3  134
4   89
DEBUG 2021-09-27 21:06:25,902[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 21:06:25,916[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:06:25,918[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:06:25,943[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   NOP
3   regular season   SAS
4   regular season   LAC
5   regular season   PHX
6   regular season   POR
7   regular season   LAL
8   regular season   OKC
9   regular season   SAC
10  regular season   IND
11  regular season   MIN
12  regular season   TOR
13  regular season   WAS
14  regular season   MEM
15  regular season   BKN
16  regular season   DAL
17  regular season   ATL
18  regular season   DEN
19  regular season   CLE
20  regular season   CHA
21  regular season   NYK
22  regular season   DET
23  regular season   UTA
24  regular season   PHI
25  regular season   CHI
26  regular season   MIA
27  regular season   BOS
28  regular season   ORL
DEBUG 2021-09-27 21:06:25,963[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 21:06:25,963[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:06:25,988[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:06:25,989[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:06:25,989[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:06:25,989[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:06:25,989[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:06:25,990[pattern_generator.py:gen_patterns:1207]   a_5
0   92
1  125
2  131
3  109
4   63
DEBUG 2021-09-27 21:06:26,605[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 21:06:26,682[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:06:26] "[31m[1mEXP /explanation HTTP/1.1[0m" 400 -
INFO 2021-09-27 21:17:34,104[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 21:17:36,743[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:17:36] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 21:17:36,815[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:17:36] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 21:17:42,233[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:17:42] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 21:17:42,283[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:17:42] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:17:45,769[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:17:45] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 21:17:49,141[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 21:17:49,141[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 21:17:49,141[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 21:17:49,142[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 21:17:49,142[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 21:17:49,142[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 21:17:49,142[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 21:17:49,143[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 21:17:49,143[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 21:17:49,143[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 21:17:49,144[experiments.py:run_experiment:269]result_schema : 'test'
DEBUG 2021-09-27 21:17:49,144[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 21:17:49,144[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 21:17:49,144[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 21:17:49,145[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 21:17:49,145[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 21:17:49,145[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 21:17:49,146[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 21:17:49,347[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 21:17:49,430[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 21:17:49,451[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 21:17:49,453[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 21:17:49,453[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 21:17:49,453[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 21:17:49,998[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:17:50,145[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:17:50,290[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:17:50,433[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 21:17:50,578[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 21:17:50,579[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 21:17:50,579[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 21:17:50,579[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 21:17:50,594[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 21:17:50,596[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:17:50,632[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 21:17:50,654[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 21:17:50,655[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 21:17:50,720[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:17:50,722[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:17:50,722[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:17:50,723[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:17:50,723[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:17:50,725[pattern_generator.py:gen_patterns:1207]   a_5
0   94
1  109
2   96
3  105
4  101
DEBUG 2021-09-27 21:17:51,629[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 21:17:51,644[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:17:51,646[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:17:51,667[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   LAC
4   regular season   PHX
5   regular season   HOU
6   regular season   NOP
7   regular season   UTA
8   regular season   MIA
9   regular season   CLE
10  regular season   POR
11  regular season   TOR
12  regular season   BKN
13  regular season   ATL
14  regular season   WAS
15  regular season   CHA
16  regular season   MEM
17  regular season   DAL
18  regular season   PHI
19  regular season   ORL
20  regular season   LAL
21  regular season   SAS
22  regular season   NYK
23  regular season   IND
24  regular season   BOS
25  regular season   CHI
DEBUG 2021-09-27 21:17:51,692[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 21:17:51,692[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:17:51,725[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:17:51,726[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:17:51,727[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:17:51,727[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:17:51,727[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:17:51,727[pattern_generator.py:gen_patterns:1207]   a_5
0   87
1  100
2   89
3  129
4  104
DEBUG 2021-09-27 21:17:52,401[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 21:17:52,418[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:17:52,421[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:17:52,463[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   NOP
3   regular season   LAC
4   regular season   POR
5   regular season   SAC
6   regular season   LAL
7   regular season   DAL
8   regular season   SAS
9   regular season   PHX
10  regular season   OKC
11  regular season   IND
12  regular season   CHA
13  regular season   CLE
14  regular season   UTA
15  regular season   DET
16  regular season   BKN
17  regular season   ATL
18  regular season   NYK
19  regular season   MIN
20  regular season   DEN
21  regular season   MEM
22  regular season   PHI
23  regular season   WAS
24  regular season   CHI
25  regular season   MIA
26  regular season   HOU
DEBUG 2021-09-27 21:17:52,501[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 21:17:52,501[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:17:52,527[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:17:52,528[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:17:52,528[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:17:52,528[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:17:52,528[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:17:52,529[pattern_generator.py:gen_patterns:1207]   a_5
0   90
1  112
2  128
3  101
4   97
DEBUG 2021-09-27 21:17:53,157[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 21:17:53,243[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:17:53] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 21:47:01,748[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 21:47:11,015[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:47:11] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 21:47:11,094[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:47:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 21:47:16,702[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:47:16] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 21:47:16,747[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:47:16] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 21:47:20,527[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:47:20] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 21:47:23,577[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 21:47:23,577[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 21:47:23,578[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 21:47:23,578[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 21:47:23,578[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 21:47:23,578[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 21:47:23,579[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 21:47:23,579[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 21:47:23,579[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 21:47:23,579[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 21:47:23,579[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 21:47:23,579[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 21:47:23,580[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 21:47:23,580[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 21:47:23,580[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 21:47:23,580[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 21:47:23,580[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 21:47:23,580[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 21:47:23,780[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 21:47:23,856[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 21:47:23,880[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 21:47:23,884[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 21:47:23,885[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 21:47:23,885[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 21:47:24,450[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:47:24,597[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:47:24,742[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 21:47:24,890[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 21:47:25,037[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 21:47:25,038[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 21:47:25,038[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 21:47:25,038[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 21:47:25,058[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 21:47:25,062[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:47:25,092[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 21:47:25,102[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 21:47:25,102[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 21:47:25,152[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:47:25,154[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:47:25,154[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:47:25,154[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:47:25,156[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:47:25,157[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1   95
2   97
3  130
4   83
DEBUG 2021-09-27 21:47:26,119[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 21:47:26,133[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:47:26,135[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:47:26,184[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   MIN
4   regular season   UTA
5   regular season   NOP
6   regular season   HOU
7   regular season   WAS
8   regular season   POR
9   regular season   DAL
10  regular season   ATL
11  regular season   CHA
12  regular season   CLE
13  regular season   BKN
14  regular season   TOR
15  regular season   SAC
16  regular season   LAC
17  regular season   MEM
18  regular season   MIA
19  regular season   IND
20  regular season   OKC
21  regular season   ORL
22  regular season   DEN
23  regular season   CHI
24  regular season   PHI
DEBUG 2021-09-27 21:47:26,228[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 21:47:26,228[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:47:26,281[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:47:26,282[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:47:26,282[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:47:26,282[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:47:26,282[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:47:26,283[pattern_generator.py:gen_patterns:1207]   a_5
0  116
1  104
2   83
3  118
4  108
DEBUG 2021-09-27 21:47:27,010[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 21:47:27,029[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 21:47:27,034[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 21:47:27,075[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   POR
4   regular season   OKC
5   regular season   NOP
6   regular season   PHX
7   regular season   DAL
8   regular season   DEN
9   regular season   LAC
10  regular season   LAL
11  regular season   SAC
12  regular season   IND
13  regular season   MIN
14  regular season   TOR
15  regular season   WAS
16  regular season   CHA
17  regular season   PHI
18  regular season   ATL
19  regular season   CLE
20  regular season   MEM
21  regular season   NYK
22  regular season   DET
23  regular season   UTA
24  regular season   BKN
25  regular season   ORL
26  regular season   MIA
27  regular season   HOU
28  regular season   CHI
DEBUG 2021-09-27 21:47:27,115[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 21:47:27,115[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 21:47:27,148[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 21:47:27,150[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 21:47:27,150[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 21:47:27,151[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 21:47:27,151[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 21:47:27,151[pattern_generator.py:gen_patterns:1207]   a_5
0  100
1  110
2  104
3  115
4   93
DEBUG 2021-09-27 21:47:27,804[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 21:47:27,906[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 21:47:27] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 22:42:28,230[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:42:31,098[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:31] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:42:31,155[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:31] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 22:42:31,224[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:31] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO 2021-09-27 22:42:35,876[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:35] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:42:35,922[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:35] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:42:39,696[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:39] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:42:43,306[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:42:43,307[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:42:43,307[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:42:43,307[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:42:43,307[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:42:43,308[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:42:43,309[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:42:43,309[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:42:43,309[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:42:43,309[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:42:43,309[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:42:43,309[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:42:43,529[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:42:43,641[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:42:43,670[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:42:43,674[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:42:43,674[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:42:43,674[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:42:44,131[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:42:44,277[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:42:44,422[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:42:44,563[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:42:44,705[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:42:44,706[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:42:44,706[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:42:44,706[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:42:44,722[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:42:44,725[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:42:44,752[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:42:44,763[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:42:44,763[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:42:44,831[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:42:44,833[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:42:44,833[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:42:44,834[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:42:44,834[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:42:44,835[pattern_generator.py:gen_patterns:1207]   a_5
0  130
1  115
2  104
3  104
4  101
DEBUG 2021-09-27 22:42:45,695[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:42:45,715[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:42:45,719[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:42:45,764[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   HOU
4   regular season   NOP
5   regular season   UTA
6   regular season   PHX
7   regular season   BKN
8   regular season   CHA
9   regular season   CLE
10  regular season   POR
11  regular season   LAC
12  regular season   ATL
13  regular season   TOR
14  regular season   WAS
15  regular season   MEM
16  regular season   DAL
17  regular season   DET
18  regular season   ORL
19  regular season   LAL
20  regular season   SAS
21  regular season   IND
22  regular season   BOS
23  regular season   CHI
DEBUG 2021-09-27 22:42:45,789[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:42:45,789[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:42:45,824[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:42:45,825[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:42:45,825[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:42:45,825[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:42:45,825[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:42:45,826[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1  118
2   96
3  110
4  110
DEBUG 2021-09-27 22:42:46,468[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:42:46,482[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:42:46,485[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:42:46,511[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   SAS
4   regular season   POR
5   regular season   LAL
6   regular season   NOP
7   regular season   DAL
8   regular season   TOR
9   regular season   NYK
10  regular season   ATL
11  regular season   CHA
12  regular season   CLE
13  regular season   OKC
14  regular season   MIN
15  regular season   DET
16  regular season   PHI
17  regular season   LAC
18  regular season   SAC
19  regular season   DEN
20  regular season   UTA
21  regular season   MEM
22  regular season   WAS
23  regular season   BOS
24  regular season   ORL
25  regular season   BKN
26  regular season   CHI
27  regular season   MIL
DEBUG 2021-09-27 22:42:46,532[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:42:46,532[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:42:46,558[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:42:46,559[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:42:46,559[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:42:46,560[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:42:46,560[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:42:46,561[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1  116
2   96
3  128
4  104
DEBUG 2021-09-27 22:42:47,220[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 22:42:47,264[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 140, in explanation
    cursor.execute(query)
psycopg2.InterfaceError: cursor already closed
INFO 2021-09-27 22:42:47,269[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:42:47] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 22:44:05,914[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:44:11,649[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:11] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:44:11,718[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:44:21,051[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:21] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:44:21,093[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:21] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:44:24,555[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:24] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:44:27,781[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:44:27,782[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:44:27,782[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:44:27,782[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:44:27,782[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:44:27,782[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:44:27,782[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:44:27,783[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:44:27,783[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:44:27,783[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:44:27,783[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:44:27,783[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:44:27,784[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:44:27,784[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:44:27,784[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:44:27,784[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:44:27,784[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:44:27,784[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:44:27,999[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:44:28,091[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:44:28,113[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:44:28,116[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:44:28,117[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:44:28,117[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:44:28,693[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:44:28,848[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:44:28,994[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:44:29,126[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:44:29,271[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:44:29,272[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:44:29,272[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:44:29,272[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:44:29,290[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:44:29,293[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:44:29,314[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:44:29,327[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:44:29,327[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:44:29,388[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:44:29,390[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:44:29,390[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:44:29,390[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:44:29,391[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:44:29,392[pattern_generator.py:gen_patterns:1207]   a_5
0   98
1  103
2   83
3   95
4   93
DEBUG 2021-09-27 22:44:30,124[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:44:30,147[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:44:30,152[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:44:30,194[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   NOP
5   regular season   LAC
6   regular season   HOU
7   regular season   ATL
8   regular season   CLE
9   regular season   UTA
10  regular season   BKN
11  regular season   SAC
12  regular season   POR
13  regular season   MIA
14  regular season   TOR
15  regular season   CHA
16  regular season   MEM
17  regular season   WAS
18  regular season   LAL
19  regular season   SAS
20  regular season   IND
21  regular season   OKC
22  regular season   ORL
23  regular season   DET
24  regular season   PHI
DEBUG 2021-09-27 22:44:30,216[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:44:30,216[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:44:30,242[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:44:30,243[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:44:30,243[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:44:30,243[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:44:30,243[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:44:30,244[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1   97
2   97
3  105
4  105
DEBUG 2021-09-27 22:44:30,916[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:44:30,933[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:44:30,936[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:44:30,958[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   PHX
4   regular season   NOP
5   regular season   LAL
6   regular season   DAL
7   regular season   OKC
8   regular season   SAC
9   regular season   DEN
10  regular season   SAS
11  regular season   POR
12  regular season   ATL
13  regular season   TOR
14  regular season   CHA
15  regular season   CLE
16  regular season   MEM
17  regular season   BKN
18  regular season   IND
19  regular season   PHI
20  regular season   WAS
21  regular season   DET
22  regular season   MIA
23  regular season   UTA
24  regular season   NYK
DEBUG 2021-09-27 22:44:30,977[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:44:30,977[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:44:31,001[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:44:31,002[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:44:31,002[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:44:31,002[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:44:31,003[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:44:31,003[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1  134
2  109
3   95
4  108
DEBUG 2021-09-27 22:44:31,642[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 22:44:31,668[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 137, in explanation
    globals()['cursor2'] = conn2.cursor()
NameError: name 'conn2' is not defined
INFO 2021-09-27 22:44:31,670[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:31] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 22:44:51,681[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:44:53,842[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:53] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:44:53,995[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:44:53] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:45:02,181[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:45:02] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:45:02,235[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:45:02] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 22:45:05,925[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:45:05] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:45:08,789[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:45:08,790[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:45:09,000[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:45:09,086[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:45:09,113[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:45:09,117[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:45:09,118[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:45:09,118[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:45:09,673[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:45:09,820[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:45:09,967[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:45:10,113[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:45:10,260[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:45:10,261[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:45:10,261[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:45:10,261[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:45:10,282[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:45:10,288[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:45:10,340[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:45:10,352[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:45:10,352[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:45:10,401[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:45:10,403[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:45:10,404[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:45:10,404[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:45:10,404[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:45:10,406[pattern_generator.py:gen_patterns:1207]   a_5
0  110
1  125
2   83
3  108
4  103
DEBUG 2021-09-27 22:45:11,118[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:45:11,135[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:45:11,137[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:45:11,164[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   LAC
5   regular season   NOP
6   regular season   DAL
7   regular season   UTA
8   regular season   BKN
9   regular season   SAC
10  regular season   HOU
11  regular season   POR
12  regular season   WAS
13  regular season   CLE
14  regular season   ATL
15  regular season   TOR
16  regular season   CHA
17  regular season   MIA
18  regular season   PHI
19  regular season   OKC
20  regular season   NYK
21  regular season   MEM
22  regular season   IND
DEBUG 2021-09-27 22:45:11,183[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:45:11,184[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:45:11,209[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:45:11,210[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:45:11,210[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:45:11,210[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:45:11,210[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:45:11,211[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1  101
2  105
3   97
4  135
DEBUG 2021-09-27 22:45:11,892[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:45:11,906[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:45:11,908[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:45:11,938[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   NOP
3   regular season   LAC
4   regular season   POR
5   regular season   LAL
6   regular season   OKC
7   regular season   DEN
8   regular season   SAC
9   regular season   SAS
10  regular season   PHX
11  regular season   ATL
12  regular season   MIN
13  regular season   CLE
14  regular season   MEM
15  regular season   UTA
16  regular season   BKN
17  regular season   IND
18  regular season   DAL
19  regular season   TOR
20  regular season   PHI
21  regular season   WAS
22  regular season   CHA
23  regular season   BOS
24  regular season   MIL
25  regular season   ORL
26  regular season   MIA
DEBUG 2021-09-27 22:45:11,964[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:45:11,964[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:45:11,992[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:45:11,993[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:45:11,993[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:45:11,993[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:45:11,993[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:45:11,994[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1  121
2  105
3  101
4   98
DEBUG 2021-09-27 22:45:12,609[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 22:45:12,641[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 137, in explanation
    globals()['cursor2'] = conn.cursor()
psycopg2.InterfaceError: connection already closed
INFO 2021-09-27 22:45:12,644[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:45:12] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 22:53:17,896[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:53:20,956[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:53:20] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:53:21,044[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:53:21] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 22:53:28,667[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:53:28] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:53:28,712[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:53:28] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:53:38,329[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:53:38] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:53:41,551[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:53:41,551[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:53:41,552[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:53:41,553[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:53:41,553[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:53:41,553[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:53:41,553[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:53:41,553[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:53:41,782[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:53:41,884[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:53:41,904[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:53:41,908[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:53:41,908[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:53:41,908[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:53:42,365[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:53:42,512[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:53:42,656[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:53:42,802[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:53:42,949[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:53:42,949[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:53:42,949[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:53:42,950[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:53:42,967[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:53:42,970[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:53:43,000[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:53:43,012[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:53:43,012[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:53:43,061[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:53:43,063[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:53:43,063[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:53:43,064[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:53:43,064[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:53:43,065[pattern_generator.py:gen_patterns:1207]   a_5
0   89
1  124
2  108
3   77
4  100
DEBUG 2021-09-27 22:53:43,821[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:53:43,843[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:53:43,849[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:53:43,882[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   BKN
4   regular season   NOP
5   regular season   POR
6   regular season   PHX
7   regular season   MEM
8   regular season   UTA
9   regular season   CLE
10  regular season   HOU
11  regular season   LAC
12  regular season   ATL
13  regular season   TOR
14  regular season   WAS
15  regular season   CHA
16  regular season   MIA
17  regular season   DEN
18  regular season   PHI
19  regular season   ORL
20  regular season   OKC
21  regular season   SAS
22  regular season   NYK
23  regular season   DAL
24  regular season   BOS
DEBUG 2021-09-27 22:53:43,907[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:53:43,908[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:53:43,935[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:53:43,936[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:53:43,936[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:53:43,936[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:53:43,936[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:53:43,937[pattern_generator.py:gen_patterns:1207]   a_5
0  107
1   95
2  120
3  121
4  100
DEBUG 2021-09-27 22:53:44,686[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:53:44,705[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:53:44,708[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:53:44,737[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   PHX
4   regular season   POR
5   regular season   LAC
6   regular season   NOP
7   regular season   DAL
8   regular season   DEN
9   regular season   LAL
10  regular season   IND
11  regular season   MIN
12  regular season   WAS
13  regular season   CLE
14  regular season   DET
15  regular season   ATL
16  regular season   SAC
17  regular season   UTA
18  regular season   BKN
19  regular season   CHA
20  regular season   NYK
21  regular season   TOR
22  regular season   OKC
23  regular season   PHI
24  regular season   MEM
25  regular season   CHI
26  regular season   MIL
27  regular season   BOS
28  regular season   HOU
DEBUG 2021-09-27 22:53:44,781[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:53:44,781[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:53:44,808[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:53:44,809[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:53:44,809[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:53:44,809[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:53:44,809[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:53:44,811[pattern_generator.py:gen_patterns:1207]   a_5
0  106
1  113
2   92
3   96
4  116
DEBUG 2021-09-27 22:53:45,571[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 22:53:45,607[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 146, in explanation
    globals()['cursor2'] = conn.cursor()
psycopg2.InterfaceError: connection already closed
INFO 2021-09-27 22:53:45,612[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:53:45] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 22:54:33,250[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:54:37,164[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:54:37] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:54:37,251[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:54:37] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:54:41,311[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:54:41] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:54:41,354[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:54:41] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:54:44,814[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:54:44] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:54:48,397[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:54:48,397[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:54:48,398[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:54:48,399[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:54:48,617[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:54:48,708[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:54:48,738[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:54:48,741[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:54:48,742[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:54:48,742[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:54:49,300[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:54:49,426[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:54:49,577[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:54:49,717[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:54:49,858[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:54:49,858[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:54:49,858[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:54:49,858[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:54:49,872[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:54:49,874[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:54:49,922[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:54:49,940[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:54:49,940[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:54:49,989[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:54:49,991[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:54:49,991[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:54:49,992[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:54:49,992[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:54:49,993[pattern_generator.py:gen_patterns:1207]   a_5
0  115
1   92
2  116
3   97
4  124
DEBUG 2021-09-27 22:54:50,779[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:54:50,797[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:54:50,799[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:54:50,822[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   UTA
4   regular season   NOP
5   regular season   PHX
6   regular season   LAC
7   regular season   TOR
8   regular season   CLE
9   regular season   DAL
10  regular season   HOU
11  regular season   BKN
12  regular season   SAC
13  regular season   CHA
14  regular season   POR
15  regular season   MEM
16  regular season   ATL
17  regular season   MIA
18  regular season   WAS
19  regular season   IND
20  regular season   SAS
21  regular season   LAL
22  regular season   OKC
23  regular season   ORL
24  regular season   DET
25  regular season   DEN
26  regular season   CHI
27  regular season   PHI
28  regular season   NYK
29  regular season   BOS
DEBUG 2021-09-27 22:54:50,842[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:54:50,843[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:54:50,866[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:54:50,867[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:54:50,867[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:54:50,868[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:54:50,868[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:54:50,868[pattern_generator.py:gen_patterns:1207]   a_5
0   85
1  111
2  105
3  104
4  116
DEBUG 2021-09-27 22:54:51,541[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:54:51,561[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:54:51,565[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:54:51,603[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   SAS
4   regular season   PHX
5   regular season   POR
6   regular season   LAL
7   regular season   NOP
8   regular season   DAL
9   regular season   SAC
10  regular season   MEM
11  regular season   UTA
12  regular season   IND
13  regular season   OKC
14  regular season   CHA
15  regular season   WAS
16  regular season   CLE
17  regular season   ATL
18  regular season   MIN
19  regular season   TOR
20  regular season   DEN
21  regular season   BKN
22  regular season   PHI
23  regular season   NYK
24  regular season   MIL
25  regular season   CHI
26  regular season   MIA
27  regular season   ORL
28  regular season   BOS
29  regular season   HOU
DEBUG 2021-09-27 22:54:51,633[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:54:51,633[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:54:51,662[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:54:51,663[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:54:51,663[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:54:51,663[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:54:51,663[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:54:51,664[pattern_generator.py:gen_patterns:1207]   a_5
0  124
1  120
2   93
3  116
4  101
DEBUG 2021-09-27 22:54:52,476[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-27 22:54:52,499[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 140, in explanation
    globals()['conn'] = pg2.connect(database=db_name,
NameError: name 'db_name' is not defined
INFO 2021-09-27 22:54:52,501[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:54:52] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 22:56:30,695[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:56:33,591[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:56:33] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:56:33,685[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:56:33] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 22:56:48,195[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:56:48] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:56:48,232[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:56:48] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:56:56,670[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:56:56] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:56:59,906[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:56:59,907[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:56:59,907[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:56:59,908[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:56:59,908[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:56:59,909[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:56:59,909[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:56:59,909[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:56:59,909[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:56:59,909[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:56:59,910[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:56:59,910[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:56:59,910[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:56:59,910[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:56:59,910[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:56:59,911[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:56:59,911[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:56:59,911[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:57:00,127[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:57:00,214[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:57:00,234[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:57:00,238[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:57:00,238[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:57:00,238[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:57:00,701[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:57:00,838[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:57:00,964[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:57:01,104[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:57:01,250[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:57:01,251[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:57:01,251[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:57:01,251[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:57:01,271[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:57:01,274[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:57:01,307[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:57:01,317[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:57:01,317[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:57:01,370[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:57:01,372[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:57:01,372[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:57:01,372[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:57:01,372[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:57:01,374[pattern_generator.py:gen_patterns:1207]   a_5
0   98
1   92
2   93
3  115
4   85
DEBUG 2021-09-27 22:57:02,184[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:57:02,198[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:57:02,200[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:57:02,223[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   UTA
5   regular season   HOU
6   regular season   NOP
7   regular season   WAS
8   regular season   SAC
9   regular season   CLE
10  regular season   MEM
11  regular season   TOR
12  regular season   ATL
13  regular season   CHA
14  regular season   LAC
15  regular season   MIA
16  regular season   BKN
17  regular season   IND
18  regular season   DET
19  regular season   ORL
20  regular season   PHI
21  regular season   LAL
22  regular season   SAS
23  regular season   NYK
24  regular season   BOS
25  regular season   DEN
DEBUG 2021-09-27 22:57:02,242[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:57:02,242[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:57:02,275[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:57:02,276[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:57:02,276[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:57:02,276[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:57:02,276[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:57:02,277[pattern_generator.py:gen_patterns:1207]   a_5
0   89
1  116
2  108
3  100
4  103
DEBUG 2021-09-27 22:57:02,956[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:57:02,971[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:57:02,973[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:57:03,024[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   PHX
4   regular season   SAS
5   regular season   DAL
6   regular season   LAC
7   regular season   NOP
8   regular season   SAC
9   regular season   ATL
10  regular season   LAL
11  regular season   WAS
12  regular season   CLE
13  regular season   OKC
14  regular season   DEN
15  regular season   BKN
16  regular season   PHI
17  regular season   IND
18  regular season   TOR
19  regular season   MEM
20  regular season   DET
21  regular season   NYK
22  regular season   MIN
23  regular season   CHA
24  regular season   MIL
25  regular season   BOS
26  regular season   HOU
27  regular season   MIA
28  regular season   ORL
DEBUG 2021-09-27 22:57:03,064[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:57:03,065[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:57:03,089[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:57:03,089[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:57:03,090[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:57:03,090[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:57:03,090[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:57:03,090[pattern_generator.py:gen_patterns:1207]   a_5
0   93
1  112
2   88
3  114
4   95
DEBUG 2021-09-27 22:57:03,815[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 22:57:03,866[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:57:03] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 22:58:15,327[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 22:58:17,673[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:58:17] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 22:58:17,778[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:58:17] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:58:24,809[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:58:24] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 22:58:24,849[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:58:24] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 22:58:28,025[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:58:28] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 22:58:31,182[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 22:58:31,183[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 22:58:31,184[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 22:58:31,184[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 22:58:31,184[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 22:58:31,184[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 22:58:31,185[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 22:58:31,185[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 22:58:31,185[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 22:58:31,185[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 22:58:31,186[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 22:58:31,186[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 22:58:31,186[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 22:58:31,186[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 22:58:31,186[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 22:58:31,187[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 22:58:31,187[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 22:58:31,187[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 22:58:31,394[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 22:58:31,474[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 22:58:31,498[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 22:58:31,503[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 22:58:31,504[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 22:58:31,504[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 22:58:32,063[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:58:32,226[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:58:32,397[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 22:58:32,563[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 22:58:32,713[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 22:58:32,713[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 22:58:32,713[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 22:58:32,713[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 22:58:32,724[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 22:58:32,726[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:58:32,749[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 22:58:32,758[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 22:58:32,758[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 22:58:32,802[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:58:32,803[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:58:32,803[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:58:32,804[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:58:32,804[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:58:32,805[pattern_generator.py:gen_patterns:1207]   a_5
0   92
1  101
2  114
3  104
4   99
DEBUG 2021-09-27 22:58:33,534[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 22:58:33,552[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:58:33,557[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:58:33,607[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   LAC
4   regular season   HOU
5   regular season   NOP
6   regular season   PHX
7   regular season   WAS
8   regular season   SAC
9   regular season   BKN
10  regular season   CHA
11  regular season   CLE
12  regular season   ATL
13  regular season   TOR
14  regular season   UTA
15  regular season   POR
16  regular season   IND
17  regular season   ORL
18  regular season   SAS
19  regular season   BOS
20  regular season   PHI
DEBUG 2021-09-27 22:58:33,640[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 22:58:33,641[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:58:33,677[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:58:33,678[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:58:33,678[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:58:33,679[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:58:33,679[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:58:33,680[pattern_generator.py:gen_patterns:1207]   a_5
0  100
1  103
2   95
3  108
4  134
DEBUG 2021-09-27 22:58:34,334[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 22:58:34,351[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 22:58:34,353[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 22:58:34,389[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   LAC
4   regular season   PHX
5   regular season   SAC
6   regular season   NOP
7   regular season   POR
8   regular season   LAL
9   regular season   DAL
10  regular season   OKC
11  regular season   IND
12  regular season   MIN
13  regular season   WAS
14  regular season   MEM
15  regular season   DEN
16  regular season   BKN
17  regular season   PHI
18  regular season   ATL
19  regular season   UTA
20  regular season   CLE
21  regular season   CHA
22  regular season   DET
23  regular season   MIL
24  regular season   TOR
25  regular season   MIA
26  regular season   BOS
27  regular season   NYK
28  regular season   HOU
DEBUG 2021-09-27 22:58:34,431[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 22:58:34,431[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 22:58:34,465[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 22:58:34,466[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 22:58:34,466[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 22:58:34,466[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 22:58:34,466[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 22:58:34,467[pattern_generator.py:gen_patterns:1207]   a_5
0  105
1  105
2   88
3  108
4  121
DEBUG 2021-09-27 22:58:35,101[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 22:58:35,140[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 22:58:35] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:05:52,409[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:05:54,545[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:05:54] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:05:54,616[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:05:54] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:05:58,276[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:05:58] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:05:58,327[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:05:58] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:06:02,057[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:02] "POST /ajax HTTP/1.1" 200 -
ERROR 2021-09-27 23:06:05,129[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 139, in explanation
    run_experiment(conn=globals()['conn'],result_schema=demoresult)
NameError: name 'demoresult' is not defined
INFO 2021-09-27 23:06:05,132[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:05] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-27 23:06:24,520[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:06:26,209[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:26] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:06:26,322[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:26] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:06:37,891[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:37] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:06:37,942[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:37] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:06:41,227[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:41] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:06:44,342[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:06:44,343[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:06:44,343[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:06:44,343[experiments.py:run_experiment:269]result_schema : 'demoresult'
DEBUG 2021-09-27 23:06:44,344[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:06:44,344[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:06:44,344[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:06:44,345[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:06:44,345[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:06:44,346[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:06:44,346[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:06:44,346[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:06:44,347[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:06:44,347[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:06:44,347[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:06:44,347[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:06:44,347[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:06:44,348[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:06:44,573[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:06:44,658[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:06:44,685[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:06:44,689[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:06:44,690[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:06:44,690[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:06:45,246[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:06:45,373[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:06:45,502[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:06:45,646[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:06:45,792[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:06:45,793[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:06:45,793[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:06:45,793[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:06:45,807[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:06:45,811[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:06:45,834[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:06:45,843[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:06:45,843[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:06:45,894[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:06:45,895[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:06:45,896[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:06:45,896[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:06:45,896[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:06:45,898[pattern_generator.py:gen_patterns:1207]   a_5
0  108
1   93
2   94
3  106
4   88
DEBUG 2021-09-27 23:06:46,689[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:06:46,706[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:06:46,708[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:06:46,758[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   PHX
4   regular season   MIN
5   regular season   UTA
6   regular season   NOP
7   regular season   ATL
8   regular season   TOR
9   regular season   CLE
10  regular season   MEM
11  regular season   BKN
12  regular season   POR
13  regular season   HOU
14  regular season   DAL
15  regular season   MIA
16  regular season   CHA
17  regular season   CHI
18  regular season   LAL
19  regular season   NYK
20  regular season   IND
21  regular season   WAS
22  regular season   DET
23  regular season   OKC
24  regular season   SAS
DEBUG 2021-09-27 23:06:46,793[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:06:46,793[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:06:46,820[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:06:46,820[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:06:46,821[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:06:46,821[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:06:46,821[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:06:46,821[pattern_generator.py:gen_patterns:1207]   a_5
0   89
1  100
2  108
3   89
4   94
DEBUG 2021-09-27 23:06:47,539[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:06:47,556[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:06:47,558[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:06:47,582[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   SAS
4   regular season   LAC
5   regular season   PHX
6   regular season   NOP
7   regular season   OKC
8   regular season   SAC
9   regular season   LAL
10  regular season   DAL
11  regular season   TOR
12  regular season   NYK
13  regular season   IND
14  regular season   BKN
15  regular season   ATL
16  regular season   MIN
17  regular season   WAS
18  regular season   CHA
19  regular season   CLE
20  regular season   MEM
21  regular season   UTA
22  regular season   DET
23  regular season   DEN
24  regular season   PHI
25  regular season   MIL
26  regular season   CHI
27  regular season   ORL
28  regular season   BOS
29  regular season   MIA
DEBUG 2021-09-27 23:06:47,604[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:06:47,604[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:06:47,628[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:06:47,629[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:06:47,629[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:06:47,629[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:06:47,629[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:06:47,630[pattern_generator.py:gen_patterns:1207]   a_5
0  108
1  108
2  101
3  103
4   69
DEBUG 2021-09-27 23:06:48,251[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:06:48,370[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:06:48] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:25:05,151[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:25:07,432[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:25:07] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:25:07,523[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:25:07] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:25:16,060[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:25:16] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:25:16,101[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:25:16] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:25:20,200[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:25:20] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:25:23,192[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:25:23,193[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:25:23,193[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:25:23,193[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:25:23,194[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:25:23,194[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:25:23,195[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:25:23,195[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:25:23,195[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:25:23,195[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:25:23,195[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:25:23,196[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:25:23,411[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:25:23,525[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:25:23,555[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:25:23,558[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:25:23,558[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:25:23,558[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:25:24,113[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:25:24,258[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:25:24,399[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:25:24,547[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:25:24,693[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:25:24,693[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:25:24,694[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:25:24,694[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:25:24,715[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:25:24,721[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:25:24,759[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:25:24,776[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:25:24,776[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:25:24,831[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:25:24,832[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:25:24,832[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:25:24,833[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:25:24,833[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:25:24,834[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1  108
2   94
3  108
4   87
DEBUG 2021-09-27 23:25:25,549[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:25:25,566[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:25:25,571[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:25:25,606[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   NOP
5   regular season   UTA
6   regular season   MIA
7   regular season   BKN
8   regular season   HOU
9   regular season   CLE
10  regular season   DAL
11  regular season   MEM
12  regular season   ATL
13  regular season   MIN
14  regular season   TOR
15  regular season   CHA
16  regular season   POR
17  regular season   IND
18  regular season   SAS
19  regular season   LAL
20  regular season   OKC
21  regular season   ORL
22  regular season   DEN
23  regular season   CHI
24  regular season   SAC
25  regular season   NYK
26  regular season   BOS
DEBUG 2021-09-27 23:25:25,641[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:25:25,641[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:25:25,665[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:25:25,666[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:25:25,666[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:25:25,666[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:25:25,666[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:25:25,667[pattern_generator.py:gen_patterns:1207]   a_5
0  108
1   90
2  108
3  118
4  109
DEBUG 2021-09-27 23:25:26,338[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:25:26,358[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:25:26,363[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:25:26,413[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   NOP
4   regular season   POR
5   regular season   LAC
6   regular season   OKC
7   regular season   PHX
8   regular season   LAL
9   regular season   DAL
10  regular season   DEN
11  regular season   DET
12  regular season   PHI
13  regular season   IND
14  regular season   CLE
15  regular season   UTA
16  regular season   SAC
17  regular season   ATL
18  regular season   MIN
19  regular season   TOR
20  regular season   WAS
21  regular season   MEM
22  regular season   BKN
23  regular season   NYK
24  regular season   MIL
25  regular season   ORL
26  regular season   CHA
27  regular season   MIA
28  regular season   BOS
29  regular season   HOU
DEBUG 2021-09-27 23:25:26,455[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:25:26,455[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:25:26,485[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:25:26,486[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:25:26,486[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:25:26,487[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:25:26,487[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:25:26,487[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1  111
2  101
3   83
4   88
DEBUG 2021-09-27 23:25:27,109[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:25:27,136[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:25:27] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:26:08,833[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:26:11,162[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:26:11] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:26:11,291[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:26:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:26:16,189[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:26:16] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:26:16,235[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:26:16] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:26:21,628[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:26:21] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:26:24,804[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:26:24,804[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:26:24,804[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:26:24,804[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:26:24,804[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:26:24,805[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:26:24,806[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:26:24,806[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:26:24,806[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:26:24,806[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:26:25,022[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:26:25,161[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:26:25,182[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:26:25,186[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:26:25,186[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:26:25,186[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:26:25,645[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:26:25,792[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:26:25,935[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:26:26,080[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:26:26,224[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:26:26,225[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:26:26,225[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:26:26,225[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:26:26,241[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:26:26,243[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:26:26,276[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:26:26,285[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:26:26,286[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:26:26,331[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:26:26,333[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:26:26,333[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:26:26,333[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:26:26,333[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:26:26,335[pattern_generator.py:gen_patterns:1207]   a_5
0  124
1  114
2  104
3  108
4  101
DEBUG 2021-09-27 23:26:27,021[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:26:27,039[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:26:27,043[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:26:27,065[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   UTA
5   regular season   NOP
6   regular season   LAC
7   regular season   CLE
8   regular season   MIA
9   regular season   MEM
10  regular season   SAC
11  regular season   HOU
12  regular season   BKN
13  regular season   CHA
14  regular season   POR
15  regular season   DAL
16  regular season   ATL
17  regular season   TOR
18  regular season   WAS
19  regular season   IND
20  regular season   SAS
21  regular season   LAL
22  regular season   OKC
23  regular season   ORL
24  regular season   DET
25  regular season   DEN
26  regular season   CHI
27  regular season   PHI
28  regular season   NYK
29  regular season   BOS
DEBUG 2021-09-27 23:26:27,088[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:26:27,088[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:26:27,118[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:26:27,119[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:26:27,119[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:26:27,119[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:26:27,119[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:26:27,120[pattern_generator.py:gen_patterns:1207]   a_5
0   99
1  116
2  106
3   94
4   94
DEBUG 2021-09-27 23:26:27,804[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:26:27,820[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:26:27,822[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:26:27,856[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   NOP
4   regular season   POR
5   regular season   LAC
6   regular season   SAS
7   regular season   LAL
8   regular season   SAC
9   regular season   DEN
10  regular season   DAL
11  regular season   OKC
12  regular season   WAS
13  regular season   CLE
14  regular season   UTA
15  regular season   BKN
16  regular season   ATL
17  regular season   MEM
18  regular season   NYK
19  regular season   MIN
20  regular season   CHA
21  regular season   IND
22  regular season   ORL
23  regular season   DET
24  regular season   PHI
25  regular season   HOU
DEBUG 2021-09-27 23:26:27,900[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:26:27,900[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:26:27,928[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:26:27,929[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:26:27,929[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:26:27,930[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:26:27,930[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:26:27,931[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1  101
2   95
3  110
4  101
DEBUG 2021-09-27 23:26:28,592[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:26:28,629[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:26:28] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:38:24,447[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:38:28,292[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:38:28] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:38:28,375[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:38:28] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:38:35,718[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:38:35] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:38:35,766[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:38:35] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:38:39,139[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:38:39] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:38:42,892[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:38:42,893[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:38:42,893[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:38:42,893[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:38:42,893[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:38:42,894[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:38:42,894[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:38:42,894[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:38:42,894[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:38:42,894[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:38:42,894[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:38:42,895[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:38:43,118[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:38:43,210[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:38:43,240[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:38:43,246[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:38:43,246[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:38:43,246[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:38:43,794[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:38:43,921[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:38:44,068[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:38:44,212[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:38:44,356[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:38:44,357[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:38:44,357[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:38:44,357[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:38:44,373[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:38:44,375[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:38:44,396[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:38:44,404[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:38:44,404[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:38:44,454[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:38:44,455[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:38:44,457[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:38:44,458[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:38:44,458[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:38:44,459[pattern_generator.py:gen_patterns:1207]   a_5
0  116
1   85
2   99
3  111
4   89
DEBUG 2021-09-27 23:38:45,227[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:38:45,242[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:38:45,244[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:38:45,297[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   LAC
5   regular season   HOU
6   regular season   NOP
7   regular season   UTA
8   regular season   MEM
9   regular season   CHA
10  regular season   ATL
11  regular season   BKN
12  regular season   MIA
13  regular season   DAL
14  regular season   POR
15  regular season   SAC
16  regular season   WAS
17  regular season   CLE
18  regular season   IND
19  regular season   TOR
20  regular season   LAL
21  regular season   OKC
22  regular season   DET
23  regular season   DEN
24  regular season   CHI
25  regular season   BOS
DEBUG 2021-09-27 23:38:45,323[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:38:45,323[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:38:45,351[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:38:45,352[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:38:45,353[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:38:45,353[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:38:45,353[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:38:45,354[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1   85
2   94
3  110
4  101
DEBUG 2021-09-27 23:38:46,011[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:38:46,026[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:38:46,029[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:38:46,053[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   NOP
4   regular season   DEN
5   regular season   OKC
6   regular season   SAS
7   regular season   LAC
8   regular season   PHX
9   regular season   LAL
10  regular season   IND
11  regular season   WAS
12  regular season   CHA
13  regular season   CLE
14  regular season   MEM
15  regular season   DET
16  regular season   MIN
17  regular season   SAC
18  regular season   DAL
19  regular season   BKN
20  regular season   UTA
21  regular season   TOR
22  regular season   NYK
23  regular season   CHI
24  regular season   PHI
25  regular season   MIA
26  regular season   BOS
DEBUG 2021-09-27 23:38:46,072[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:38:46,073[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:38:46,097[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:38:46,098[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:38:46,098[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:38:46,098[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:38:46,098[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:38:46,098[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1  116
2  124
3   97
4   83
DEBUG 2021-09-27 23:38:46,754[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:38:46,803[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:38:46] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:41:42,058[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:41:43,907[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:41:43] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:41:43,979[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:41:43] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:41:50,133[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:41:50] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:41:50,185[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:41:50] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:41:54,281[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:41:54] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:41:57,764[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:41:57,764[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:41:57,764[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:41:57,764[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:41:57,765[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:41:57,766[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:41:57,766[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:41:57,766[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:41:57,766[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:41:57,766[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:41:57,985[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:41:58,081[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:41:58,101[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:41:58,104[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:41:58,104[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:41:58,104[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:41:58,668[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:41:58,807[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:41:58,949[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:41:59,093[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:41:59,238[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:41:59,238[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:41:59,238[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:41:59,238[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:41:59,260[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:41:59,266[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:41:59,306[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:41:59,319[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:41:59,320[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:41:59,379[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:41:59,381[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:41:59,381[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:41:59,381[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:41:59,381[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:41:59,382[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1  100
2  107
3   94
4   94
DEBUG 2021-09-27 23:42:00,227[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:42:00,245[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:42:00,250[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:42:00,288[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   HOU
4   regular season   NOP
5   regular season   ATL
6   regular season   TOR
7   regular season   WAS
8   regular season   UTA
9   regular season   LAC
10  regular season   MIA
11  regular season   BKN
12  regular season   PHX
13  regular season   SAC
14  regular season   POR
15  regular season   MEM
16  regular season   DAL
17  regular season   CLE
18  regular season   IND
19  regular season   DEN
20  regular season   CHI
21  regular season   LAL
22  regular season   SAS
23  regular season   PHI
DEBUG 2021-09-27 23:42:00,317[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:42:00,318[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:42:00,352[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:42:00,352[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:42:00,353[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:42:00,353[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:42:00,353[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:42:00,353[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1  105
2  118
3   94
4  100
DEBUG 2021-09-27 23:42:01,098[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:42:01,116[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:42:01,118[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:42:01,152[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   SAC
5   regular season   DAL
6   regular season   POR
7   regular season   DEN
8   regular season   SAS
9   regular season   LAL
10  regular season   IND
11  regular season   MIN
12  regular season   TOR
13  regular season   WAS
14  regular season   CHA
15  regular season   MEM
16  regular season   OKC
17  regular season   DET
18  regular season   BKN
19  regular season   PHI
20  regular season   ATL
21  regular season   UTA
22  regular season   CLE
23  regular season   MIL
24  regular season   NYK
25  regular season   CHI
26  regular season   BOS
27  regular season   MIA
28  regular season   HOU
DEBUG 2021-09-27 23:42:01,198[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:42:01,199[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:42:01,223[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:42:01,224[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:42:01,224[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:42:01,224[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:42:01,224[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:42:01,225[pattern_generator.py:gen_patterns:1207]   a_5
0   99
1  104
2   90
3  107
4  135
DEBUG 2021-09-27 23:42:01,866[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:42:01,894[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:42:01] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:42:48,667[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:42:51,672[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:42:51] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:42:51,807[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:42:51] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:42:55,906[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:42:55] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:42:55,950[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:42:55] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:42:59,956[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:42:59] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:43:03,291[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:43:03,292[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:43:03,292[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:43:03,292[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:43:03,292[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:43:03,293[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:43:03,293[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:43:03,293[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:43:03,293[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:43:03,293[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:43:03,293[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:43:03,294[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:43:03,294[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:43:03,294[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:43:03,294[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:43:03,294[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:43:03,294[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:43:03,295[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:43:03,514[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:43:03,604[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:43:03,631[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:43:03,635[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:43:03,635[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:43:03,635[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:43:04,205[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:43:04,349[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:43:04,492[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:43:04,617[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:43:04,740[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:43:04,741[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:43:04,741[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:43:04,741[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:43:04,762[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:43:04,764[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:43:04,795[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:43:04,803[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:43:04,803[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:43:04,865[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:43:04,867[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:43:04,870[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:43:04,870[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:43:04,870[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:43:04,871[pattern_generator.py:gen_patterns:1207]   a_5
0   92
1  115
2   97
3  103
4  116
DEBUG 2021-09-27 23:43:05,694[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:43:05,708[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:43:05,710[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:43:05,751[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   HOU
5   regular season   LAC
6   regular season   UTA
7   regular season   NOP
8   regular season   WAS
9   regular season   CHA
10  regular season   TOR
11  regular season   MEM
12  regular season   SAC
13  regular season   CLE
14  regular season   DAL
15  regular season   BKN
16  regular season   ATL
17  regular season   MIA
18  regular season   IND
19  regular season   SAS
20  regular season   LAL
21  regular season   OKC
22  regular season   ORL
23  regular season   DET
24  regular season   DEN
25  regular season   PHI
26  regular season   POR
27  regular season   NYK
28  regular season   BOS
DEBUG 2021-09-27 23:43:05,788[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:43:05,788[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:43:05,825[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:43:05,826[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:43:05,826[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:43:05,826[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:43:05,826[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:43:05,827[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1   85
2   99
3  107
4  115
DEBUG 2021-09-27 23:43:06,502[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:43:06,520[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:43:06,522[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:43:06,551[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   SAS
4   regular season   SAC
5   regular season   PHX
6   regular season   POR
7   regular season   DEN
8   regular season   NOP
9   regular season   LAL
10  regular season   DAL
11  regular season   OKC
12  regular season   ATL
13  regular season   TOR
14  regular season   BKN
15  regular season   CLE
16  regular season   UTA
17  regular season   IND
18  regular season   MIN
19  regular season   CHA
20  regular season   MEM
21  regular season   DET
22  regular season   PHI
23  regular season   HOU
24  regular season   MIL
25  regular season   CHI
26  regular season   NYK
27  regular season   MIA
28  regular season   BOS
29  regular season   WAS
DEBUG 2021-09-27 23:43:06,572[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:43:06,572[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:43:06,597[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:43:06,598[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:43:06,598[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:43:06,598[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:43:06,598[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:43:06,599[pattern_generator.py:gen_patterns:1207]   a_5
0  105
1  118
2  108
3  129
4   94
DEBUG 2021-09-27 23:43:07,230[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:43:07,276[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:43:07] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:46:07,637[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:46:09,486[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:09] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:46:09,582[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:09] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:46:16,757[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:16] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:46:16,805[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:16] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:46:20,603[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:20] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:46:23,692[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:46:23,693[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:46:23,693[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:46:23,693[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:46:23,694[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:46:23,694[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:46:23,694[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:46:23,694[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:46:23,695[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:46:23,695[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:46:23,695[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:46:23,695[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:46:23,695[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:46:23,695[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:46:23,696[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:46:23,696[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:46:23,696[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:46:23,696[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:46:23,918[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:46:24,035[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:46:24,076[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:46:24,083[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:46:24,083[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:46:24,083[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:46:24,631[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:46:24,778[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:46:24,922[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:46:25,068[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:46:25,216[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:46:25,216[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:46:25,216[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:46:25,217[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:46:25,236[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:46:25,242[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:46:25,285[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:46:25,311[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:46:25,312[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:46:25,364[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:46:25,365[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:46:25,366[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:46:25,366[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:46:25,366[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:46:25,367[pattern_generator.py:gen_patterns:1207]   a_5
0   99
1  132
2  110
3  103
4  112
DEBUG 2021-09-27 23:46:26,059[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:46:26,075[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:46:26,076[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:46:26,118[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   MIN
4   regular season   NOP
5   regular season   LAC
6   regular season   UTA
7   regular season   ATL
8   regular season   CHA
9   regular season   CLE
10  regular season   SAC
11  regular season   HOU
12  regular season   DAL
13  regular season   BKN
14  regular season   POR
15  regular season   WAS
16  regular season   MEM
17  regular season   MIA
18  regular season   TOR
19  regular season   ORL
20  regular season   OKC
21  regular season   DET
22  regular season   DEN
23  regular season   CHI
24  regular season   PHI
25  regular season   NYK
DEBUG 2021-09-27 23:46:26,158[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:46:26,158[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:46:26,186[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:46:26,187[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:46:26,187[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:46:26,187[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:46:26,187[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:46:26,188[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1   98
2  104
3  111
4  103
DEBUG 2021-09-27 23:46:26,844[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:46:26,862[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:46:26,865[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:46:26,888[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   PHX
4   regular season   LAC
5   regular season   DAL
6   regular season   OKC
7   regular season   SAS
8   regular season   LAL
9   regular season   NOP
10  regular season   SAC
11  regular season   DEN
12  regular season   IND
13  regular season   TOR
14  regular season   WAS
15  regular season   CHA
16  regular season   BKN
17  regular season   PHI
18  regular season   ATL
19  regular season   DET
20  regular season   MEM
21  regular season   NYK
22  regular season   MIN
23  regular season   BOS
24  regular season   CHI
25  regular season   ORL
26  regular season   HOU
27  regular season   MIL
DEBUG 2021-09-27 23:46:26,910[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:46:26,910[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:46:26,937[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:46:26,938[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:46:26,938[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:46:26,938[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:46:26,938[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:46:26,939[pattern_generator.py:gen_patterns:1207]   a_5
0  108
1   98
2   63
3  124
4  129
DEBUG 2021-09-27 23:46:27,647[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:46:27,675[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:27] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:46:53,441[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:46:55,732[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:55] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:46:55,846[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:55] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:46:59,407[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:59] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:46:59,452[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:46:59] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:47:02,736[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:47:02] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:47:07,621[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:47:07,622[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:47:07,622[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:47:07,622[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:47:07,622[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:47:07,623[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:47:07,623[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:47:07,623[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:47:07,623[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:47:07,623[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:47:07,623[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:47:07,624[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:47:07,624[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:47:07,624[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:47:07,624[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:47:07,624[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:47:07,625[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:47:07,625[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:47:07,854[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:47:07,946[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:47:07,967[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:47:07,970[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:47:07,970[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:47:07,970[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:47:08,430[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:47:08,576[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:47:08,723[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:47:08,867[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:47:09,013[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:47:09,013[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:47:09,013[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:47:09,013[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:47:09,029[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:47:09,031[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:47:09,077[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:47:09,102[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:47:09,102[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:47:09,158[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:47:09,160[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:47:09,160[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:47:09,160[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:47:09,160[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:47:09,162[pattern_generator.py:gen_patterns:1207]   a_5
0   93
1  112
2  116
3  104
4  100
DEBUG 2021-09-27 23:47:10,086[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:47:10,103[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:47:10,105[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:47:10,148[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   HOU
4   regular season   NOP
5   regular season   LAC
6   regular season   MIN
7   regular season   BKN
8   regular season   SAC
9   regular season   CLE
10  regular season   DAL
11  regular season   ATL
12  regular season   UTA
13  regular season   MIA
14  regular season   POR
15  regular season   CHA
16  regular season   WAS
17  regular season   BOS
18  regular season   SAS
19  regular season   TOR
20  regular season   LAL
21  regular season   OKC
22  regular season   ORL
23  regular season   DET
24  regular season   DEN
25  regular season   CHI
26  regular season   PHI
DEBUG 2021-09-27 23:47:10,173[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:47:10,173[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:47:10,208[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:47:10,209[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:47:10,209[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:47:10,209[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:47:10,209[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:47:10,210[pattern_generator.py:gen_patterns:1207]   a_5
0  115
1   63
2  103
3  131
4  116
DEBUG 2021-09-27 23:47:10,936[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:47:10,951[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:47:10,953[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:47:10,999[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   SAS
4   regular season   LAC
5   regular season   POR
6   regular season   LAL
7   regular season   DAL
8   regular season   OKC
9   regular season   NOP
10  regular season   MIN
11  regular season   TOR
12  regular season   CHA
13  regular season   MEM
14  regular season   BKN
15  regular season   SAC
16  regular season   NYK
17  regular season   IND
18  regular season   DEN
19  regular season   CLE
20  regular season   DET
21  regular season   UTA
22  regular season   PHI
23  regular season   CHI
24  regular season   WAS
25  regular season   MIL
26  regular season   BOS
27  regular season   MIA
DEBUG 2021-09-27 23:47:11,029[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:47:11,029[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:47:11,057[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:47:11,058[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:47:11,058[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:47:11,058[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:47:11,058[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:47:11,059[pattern_generator.py:gen_patterns:1207]   a_5
0   94
1  134
2  110
3  116
4   99
DEBUG 2021-09-27 23:47:11,832[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:47:11,869[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:47:11] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:47:29,856[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:47:29] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:47:58,502[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:48:00,748[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:48:00] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:48:00,882[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:48:00] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:48:06,804[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:48:06] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:48:06,857[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:48:06] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:48:11,387[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:48:11] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:48:14,656[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:48:14,657[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:48:14,658[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:48:14,658[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:48:14,659[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:48:14,659[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:48:14,659[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:48:14,660[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:48:14,660[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:48:14,660[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:48:14,661[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:48:14,661[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:48:14,661[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:48:14,661[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:48:14,662[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:48:14,662[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:48:14,662[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:48:14,662[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:48:14,876[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:48:14,979[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:48:15,003[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:48:15,006[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:48:15,007[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:48:15,007[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:48:15,465[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:48:15,612[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:48:15,760[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:48:15,911[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:48:16,058[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:48:16,059[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:48:16,059[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:48:16,059[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:48:16,073[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:48:16,075[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:48:16,101[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:48:16,111[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:48:16,111[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:48:16,155[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:48:16,157[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:48:16,157[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:48:16,158[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:48:16,158[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:48:16,159[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1  107
2  112
3  104
4  100
DEBUG 2021-09-27 23:48:16,933[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:48:16,950[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:48:16,952[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:48:16,986[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   NOP
5   regular season   LAC
6   regular season   UTA
7   regular season   HOU
8   regular season   ATL
9   regular season   WAS
10  regular season   CHA
11  regular season   MEM
12  regular season   SAC
13  regular season   MIA
14  regular season   TOR
15  regular season   BKN
16  regular season   DAL
17  regular season   DET
18  regular season   ORL
19  regular season   CLE
20  regular season   SAS
21  regular season   NYK
22  regular season   IND
23  regular season   CHI
DEBUG 2021-09-27 23:48:17,007[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:48:17,008[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:48:17,039[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:48:17,039[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:48:17,040[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:48:17,040[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:48:17,040[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:48:17,040[pattern_generator.py:gen_patterns:1207]   a_5
0  108
1  106
2  111
3  112
4   95
DEBUG 2021-09-27 23:48:17,780[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:48:17,795[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:48:17,797[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:48:17,820[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   NOP
4   regular season   LAC
5   regular season   SAC
6   regular season   PHX
7   regular season   POR
8   regular season   OKC
9   regular season   DEN
10  regular season   DAL
11  regular season   CHA
12  regular season   BKN
13  regular season   CLE
14  regular season   MEM
15  regular season   LAL
16  regular season   IND
17  regular season   MIN
18  regular season   TOR
19  regular season   WAS
20  regular season   UTA
21  regular season   DET
22  regular season   NYK
23  regular season   ATL
24  regular season   BOS
25  regular season   CHI
26  regular season   MIL
27  regular season   HOU
DEBUG 2021-09-27 23:48:17,839[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:48:17,840[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:48:17,868[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:48:17,869[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:48:17,869[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:48:17,869[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:48:17,869[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:48:17,870[pattern_generator.py:gen_patterns:1207]   a_5
0  114
1  113
2   89
3  130
4  106
DEBUG 2021-09-27 23:48:18,620[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:48:18,680[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:48:18] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:49:53,719[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:49:56,001[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:49:56] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:49:56,059[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:49:56] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:50:00,237[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:50:00] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:50:00,280[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:50:00] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:50:04,022[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:50:04] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:50:06,986[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:50:06,987[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:50:06,987[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:50:06,988[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:50:06,988[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:50:06,988[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:50:06,988[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:50:06,989[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:50:06,989[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:50:06,989[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:50:06,990[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:50:06,990[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:50:06,990[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:50:06,990[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:50:06,991[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:50:06,991[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:50:06,991[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:50:06,991[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:50:07,210[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:50:07,309[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:50:07,337[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:50:07,342[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:50:07,342[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:50:07,342[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:50:07,909[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:50:08,057[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:50:08,198[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:50:08,340[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:50:08,484[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:50:08,484[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:50:08,484[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:50:08,484[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:50:08,501[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:50:08,504[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:50:08,525[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:50:08,533[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:50:08,533[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:50:08,582[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:50:08,584[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:50:08,584[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:50:08,584[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:50:08,584[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:50:08,586[pattern_generator.py:gen_patterns:1207]   a_5
0  128
1   83
2  104
3   89
4  108
DEBUG 2021-09-27 23:50:09,384[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:50:09,396[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:50:09,398[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:50:09,439[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   UTA
4   regular season   LAC
5   regular season   PHX
6   regular season   NOP
7   regular season   HOU
8   regular season   MIA
9   regular season   POR
10  regular season   SAC
11  regular season   CLE
12  regular season   ATL
13  regular season   TOR
14  regular season   WAS
15  regular season   MEM
16  regular season   BKN
17  regular season   DAL
18  regular season   DET
19  regular season   OKC
20  regular season   PHI
21  regular season   CHA
22  regular season   LAL
23  regular season   SAS
24  regular season   IND
25  regular season   DEN
26  regular season   BOS
DEBUG 2021-09-27 23:50:09,459[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:50:09,459[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:50:09,484[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:50:09,485[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:50:09,485[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:50:09,485[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:50:09,485[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:50:09,486[pattern_generator.py:gen_patterns:1207]   a_5
0  118
1  112
2   96
3  105
4  103
DEBUG 2021-09-27 23:50:10,225[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:50:10,246[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:50:10,251[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:50:10,306[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   PHX
4   regular season   LAC
5   regular season   POR
6   regular season   SAC
7   regular season   NOP
8   regular season   LAL
9   regular season   DAL
10  regular season   DEN
11  regular season   IND
12  regular season   MIN
13  regular season   TOR
14  regular season   WAS
15  regular season   CHA
16  regular season   CLE
17  regular season   OKC
18  regular season   DET
19  regular season   BKN
20  regular season   PHI
21  regular season   NYK
22  regular season   ATL
23  regular season   MEM
24  regular season   BOS
25  regular season   HOU
DEBUG 2021-09-27 23:50:10,340[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:50:10,340[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:50:10,366[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:50:10,367[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:50:10,367[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:50:10,367[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:50:10,367[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:50:10,368[pattern_generator.py:gen_patterns:1207]   a_5
0  108
1  134
2  108
3   69
4  103
DEBUG 2021-09-27 23:50:11,092[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:50:11,147[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:50:11] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:50:54,940[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:50:56,916[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:50:56] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:50:57,055[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:50:57] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:51:03,989[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:51:03] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:51:04,038[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:51:04] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:51:07,104[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:51:07] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:51:10,326[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:51:10,326[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:51:10,326[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:51:10,327[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:51:10,328[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:51:10,328[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:51:10,328[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:51:10,555[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:51:10,668[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:51:10,692[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:51:10,695[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:51:10,695[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:51:10,696[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:51:11,299[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:51:11,467[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:51:11,640[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:51:11,906[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:51:12,045[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:51:12,046[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:51:12,046[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:51:12,046[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:51:12,064[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:51:12,066[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:51:12,098[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:51:12,108[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:51:12,109[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:51:12,163[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:51:12,165[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:51:12,165[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:51:12,165[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:51:12,166[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:51:12,168[pattern_generator.py:gen_patterns:1207]   a_5
0   89
1  109
2  116
3  101
4  106
DEBUG 2021-09-27 23:51:13,076[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:51:13,090[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:51:13,092[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:51:13,114[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   MIN
5   regular season   NOP
6   regular season   SAC
7   regular season   WAS
8   regular season   MEM
9   regular season   MIA
10  regular season   BKN
11  regular season   HOU
12  regular season   UTA
13  regular season   DAL
14  regular season   CHA
15  regular season   CLE
16  regular season   TOR
17  regular season   POR
18  regular season   IND
19  regular season   SAS
20  regular season   OKC
21  regular season   ORL
22  regular season   PHI
23  regular season   ATL
DEBUG 2021-09-27 23:51:13,134[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:51:13,134[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:51:13,159[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:51:13,160[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:51:13,160[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:51:13,160[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:51:13,160[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:51:13,161[pattern_generator.py:gen_patterns:1207]   a_5
0   92
1   69
2  103
3  108
4   94
DEBUG 2021-09-27 23:51:13,923[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:51:13,944[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:51:13,950[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:51:13,995[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   POR
4   regular season   NOP
5   regular season   LAL
6   regular season   SAS
7   regular season   SAC
8   regular season   LAC
9   regular season   OKC
10  regular season   IND
11  regular season   TOR
12  regular season   CHA
13  regular season   CLE
14  regular season   MEM
15  regular season   UTA
16  regular season   DET
17  regular season   DEN
18  regular season   BKN
19  regular season   PHI
20  regular season   DAL
21  regular season   ATL
22  regular season   MIN
23  regular season   WAS
24  regular season   MIA
25  regular season   NYK
26  regular season   BOS
27  regular season   ORL
DEBUG 2021-09-27 23:51:14,015[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:51:14,015[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:51:14,039[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:51:14,039[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:51:14,039[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:51:14,039[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:51:14,040[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:51:14,040[pattern_generator.py:gen_patterns:1207]   a_5
0  101
1  106
2   94
3  100
4   97
DEBUG 2021-09-27 23:51:14,748[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:51:14,776[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:51:14] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:53:49,290[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:53:51,292[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:53:51] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:53:51,380[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:53:51] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:53:57,060[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:53:57] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:53:57,099[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:53:57] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:54:00,981[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:54:00] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:54:05,007[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:54:05,007[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:54:05,008[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:54:05,009[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:54:05,010[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:54:05,226[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:54:05,326[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:54:05,346[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:54:05,349[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:54:05,349[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:54:05,349[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:54:05,807[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:54:05,937[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:54:06,064[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:54:06,203[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:54:06,345[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:54:06,345[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:54:06,345[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:54:06,346[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:54:06,363[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:54:06,369[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:54:06,423[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:54:06,449[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:54:06,449[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:54:06,505[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:54:06,507[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:54:06,508[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:54:06,508[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:54:06,508[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:54:06,512[pattern_generator.py:gen_patterns:1207]   a_5
0  110
1  112
2  100
3  101
4   69
DEBUG 2021-09-27 23:54:07,302[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:54:07,320[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:54:07,323[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:54:07,356[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   LAC
4   regular season   PHX
5   regular season   NOP
6   regular season   HOU
7   regular season   MIA
8   regular season   POR
9   regular season   SAC
10  regular season   TOR
11  regular season   DAL
12  regular season   ATL
13  regular season   BKN
14  regular season   CLE
15  regular season   CHA
16  regular season   IND
17  regular season   SAS
18  regular season   LAL
19  regular season   WAS
20  regular season   MEM
21  regular season   UTA
22  regular season   OKC
23  regular season   ORL
24  regular season   DET
25  regular season   DEN
26  regular season   CHI
27  regular season   PHI
28  regular season   NYK
DEBUG 2021-09-27 23:54:07,403[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:54:07,403[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:54:07,438[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:54:07,439[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:54:07,439[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:54:07,439[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:54:07,439[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:54:07,440[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1   88
2   96
3  107
4   63
DEBUG 2021-09-27 23:54:08,211[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:54:08,228[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:54:08,229[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:54:08,266[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   POR
4   regular season   SAS
5   regular season   PHX
6   regular season   NOP
7   regular season   SAC
8   regular season   LAL
9   regular season   DAL
10  regular season   WAS
11  regular season   NYK
12  regular season   MIN
13  regular season   MEM
14  regular season   OKC
15  regular season   DEN
16  regular season   PHI
17  regular season   IND
18  regular season   CHA
19  regular season   UTA
20  regular season   DET
21  regular season   BKN
22  regular season   TOR
23  regular season   ORL
24  regular season   CLE
25  regular season   MIA
26  regular season   ATL
27  regular season   CHI
28  regular season   HOU
29  regular season   MIL
DEBUG 2021-09-27 23:54:08,292[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:54:08,293[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:54:08,325[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:54:08,326[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:54:08,326[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:54:08,326[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:54:08,326[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:54:08,327[pattern_generator.py:gen_patterns:1207]   a_5
0   85
1  105
2   99
3  114
4  105
DEBUG 2021-09-27 23:54:09,051[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:54:09,090[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:54:09] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-27 23:58:25,270[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-27 23:58:28,130[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:58:28] "GET / HTTP/1.1" 200 -
INFO 2021-09-27 23:58:28,222[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:58:28] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-27 23:58:35,025[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:58:35] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-27 23:58:35,074[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:58:35] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-27 23:58:37,960[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:58:37] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-27 23:58:41,885[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-27 23:58:41,885[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-27 23:58:41,886[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-27 23:58:41,887[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-27 23:58:41,888[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-27 23:58:41,888[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-27 23:58:42,111[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-27 23:58:42,249[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-27 23:58:42,274[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-27 23:58:42,278[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-27 23:58:42,278[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-27 23:58:42,278[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-27 23:58:42,831[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:58:42,961[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:58:43,087[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-27 23:58:43,217[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-27 23:58:43,346[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-27 23:58:43,346[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-27 23:58:43,346[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-27 23:58:43,347[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-27 23:58:43,358[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-27 23:58:43,360[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:58:43,391[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-27 23:58:43,405[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-27 23:58:43,406[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-27 23:58:43,480[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:58:43,486[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:58:43,486[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:58:43,486[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:58:43,486[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:58:43,491[pattern_generator.py:gen_patterns:1207]   a_5
0  116
1   98
2  108
3  101
4  105
DEBUG 2021-09-27 23:58:44,280[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-27 23:58:44,297[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:58:44,298[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:58:44,327[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   UTA
3   regular season   PHX
4   regular season   HOU
5   regular season   MIN
6   regular season   LAC
7   regular season   WAS
8   regular season   DAL
9   regular season   TOR
10  regular season   SAC
11  regular season   CLE
12  regular season   ATL
13  regular season   NOP
14  regular season   MIA
15  regular season   MEM
16  regular season   BKN
17  regular season   DEN
18  regular season   PHI
19  regular season   POR
20  regular season   OKC
21  regular season   LAL
22  regular season   SAS
23  regular season   BOS
24  regular season   IND
DEBUG 2021-09-27 23:58:44,348[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-27 23:58:44,349[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:58:44,378[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:58:44,378[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:58:44,379[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:58:44,379[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:58:44,379[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:58:44,380[pattern_generator.py:gen_patterns:1207]   a_5
0   95
1  105
2  131
3  110
4   92
DEBUG 2021-09-27 23:58:45,101[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-27 23:58:45,117[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-27 23:58:45,119[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-27 23:58:45,156[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   NOP
4   regular season   OKC
5   regular season   SAS
6   regular season   SAC
7   regular season   POR
8   regular season   DAL
9   regular season   LAL
10  regular season   LAC
11  regular season   MIN
12  regular season   TOR
13  regular season   WAS
14  regular season   CLE
15  regular season   MEM
16  regular season   DET
17  regular season   PHI
18  regular season   UTA
19  regular season   NYK
20  regular season   CHA
21  regular season   BKN
22  regular season   IND
23  regular season   DEN
24  regular season   CHI
25  regular season   MIA
26  regular season   HOU
27  regular season   MIL
DEBUG 2021-09-27 23:58:45,199[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-27 23:58:45,199[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-27 23:58:45,229[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-27 23:58:45,230[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-27 23:58:45,230[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-27 23:58:45,230[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-27 23:58:45,231[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-27 23:58:45,231[pattern_generator.py:gen_patterns:1207]   a_5
0  111
1  128
2  116
3  106
4  110
DEBUG 2021-09-27 23:58:45,926[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-27 23:58:45,981[_internal.py:_log:225]127.0.0.1 - - [27/Sep/2021 23:58:45] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-28 00:01:16,952[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 00:01:19,042[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 00:01:19] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 00:01:19,198[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 00:01:19] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 00:01:24,500[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 00:01:24] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 00:01:24,543[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 00:01:24] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 00:01:28,997[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 00:01:28] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 00:01:32,031[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 00:01:32,032[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 00:01:32,241[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 00:01:32,350[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 00:01:32,375[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 00:01:32,379[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 00:01:32,379[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 00:01:32,380[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 00:01:32,841[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 00:01:32,976[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 00:01:33,120[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 00:01:33,265[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 00:01:33,413[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 00:01:33,413[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 00:01:33,413[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 00:01:33,413[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 00:01:33,428[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 00:01:33,431[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 00:01:33,460[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 00:01:33,470[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 00:01:33,470[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 00:01:33,522[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 00:01:33,523[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 00:01:33,524[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 00:01:33,524[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 00:01:33,524[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 00:01:33,525[pattern_generator.py:gen_patterns:1207]   a_5
0  100
1   88
2  130
3   69
4  114
DEBUG 2021-09-28 00:01:34,322[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 00:01:34,339[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 00:01:34,342[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 00:01:34,382[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   HOU
5   regular season   MIN
6   regular season   DAL
7   regular season   SAC
8   regular season   NOP
9   regular season   CHA
10  regular season   WAS
11  regular season   TOR
12  regular season   BKN
13  regular season   POR
14  regular season   UTA
15  regular season   MEM
16  regular season   ATL
17  regular season   CLE
18  regular season   MIA
19  regular season   IND
20  regular season   SAS
21  regular season   LAL
22  regular season   OKC
23  regular season   DET
24  regular season   DEN
25  regular season   CHI
26  regular season   PHI
27  regular season   NYK
DEBUG 2021-09-28 00:01:34,429[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 00:01:34,429[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 00:01:34,456[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 00:01:34,457[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 00:01:34,457[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 00:01:34,457[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 00:01:34,457[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 00:01:34,457[pattern_generator.py:gen_patterns:1207]   a_5
0   93
1   99
2  112
3  118
4   90
DEBUG 2021-09-28 00:01:35,248[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 00:01:35,268[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 00:01:35,273[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 00:01:35,311[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   POR
5   regular season   NOP
6   regular season   SAS
7   regular season   DAL
8   regular season   DEN
9   regular season   SAC
10  regular season   OKC
11  regular season   ATL
12  regular season   MIN
13  regular season   TOR
14  regular season   WAS
15  regular season   CLE
16  regular season   MEM
17  regular season   UTA
18  regular season   BKN
19  regular season   IND
20  regular season   PHI
21  regular season   DET
22  regular season   NYK
23  regular season   LAL
24  regular season   BOS
25  regular season   CHI
26  regular season   HOU
27  regular season   CHA
DEBUG 2021-09-28 00:01:35,333[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 00:01:35,333[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 00:01:35,364[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 00:01:35,365[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 00:01:35,365[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 00:01:35,365[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 00:01:35,365[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 00:01:35,365[pattern_generator.py:gen_patterns:1207]   a_5
0  110
1  102
2  114
3   94
4  108
DEBUG 2021-09-28 00:01:36,036[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 00:01:36,089[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 00:01:36] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-28 09:33:12,653[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 09:33:15,024[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:33:15] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 09:33:15,123[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:33:15] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 09:33:15,327[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:33:15] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO 2021-09-28 09:33:20,848[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:33:20] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:33:20,884[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:33:20] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 09:33:25,512[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:33:25] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 09:35:37,424[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 09:35:39,703[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:35:39] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 09:35:39,778[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:35:39] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 09:35:48,562[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:35:48] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:35:48,594[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:35:48] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 09:35:52,857[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:35:52] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 09:38:40,306[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 09:38:42,374[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:38:42] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 09:38:42,487[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:38:42] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 09:38:48,765[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:38:48] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:38:48,802[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:38:48] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 09:38:53,455[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:38:53] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 09:44:37,233[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 09:44:41,011[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:44:41] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 09:44:41,118[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:44:41] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 09:44:49,919[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:44:49] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:44:49,959[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:44:49] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 09:44:54,149[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:44:54] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 09:45:30,239[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:45:30] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:46:26,320[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 09:46:28,175[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:46:28] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 09:46:28,272[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:46:28] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 09:46:33,571[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:46:33] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:46:33,623[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:46:33] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 09:46:37,823[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:46:37] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 09:48:40,223[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 09:48:43,935[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:48:43] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 09:48:43,989[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:48:43] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 09:48:49,163[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:48:49] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:48:49,195[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:48:49] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 09:48:53,376[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:48:53] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 09:49:10,685[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:49:10] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 09:49:16,926[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:49:16] "GET /db/ HTTP/1.1" 200 -
DEBUG 2021-09-28 09:50:31,184[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 09:50:31,184[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 09:50:31,185[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 09:50:31,389[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 09:50:31,534[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 09:50:31,558[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 09:50:31,561[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 09:50:31,561[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 09:50:31,561[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 09:50:32,049[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 09:50:32,177[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 09:50:32,304[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 09:50:32,444[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 09:50:32,566[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 09:50:32,567[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 09:50:32,567[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 09:50:32,567[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 09:50:32,579[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 09:50:32,582[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 09:50:32,611[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 09:50:32,621[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 09:50:32,621[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 09:50:32,676[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 09:50:32,678[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 09:50:32,678[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 09:50:32,678[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 09:50:32,679[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 09:50:32,680[pattern_generator.py:gen_patterns:1207]   a_5
0   94
1  110
2  106
3  108
4   94
DEBUG 2021-09-28 09:50:33,592[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 09:50:33,601[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 09:50:33,603[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 09:50:33,629[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   MIN
4   regular season   LAC
5   regular season   NOP
6   regular season   UTA
7   regular season   ATL
8   regular season   MIA
9   regular season   CHA
10  regular season   BKN
11  regular season   WAS
12  regular season   SAC
13  regular season   POR
14  regular season   HOU
15  regular season   DAL
16  regular season   TOR
17  regular season   IND
18  regular season   SAS
19  regular season   LAL
20  regular season   CLE
21  regular season   OKC
22  regular season   ORL
23  regular season   DET
24  regular season   DEN
25  regular season   CHI
26  regular season   NYK
27  regular season   BOS
DEBUG 2021-09-28 09:50:33,650[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 09:50:33,650[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 09:50:33,677[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 09:50:33,678[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 09:50:33,678[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 09:50:33,679[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 09:50:33,679[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 09:50:33,680[pattern_generator.py:gen_patterns:1207]   a_5
0   98
1  128
2   97
3  103
4   87
DEBUG 2021-09-28 09:50:34,523[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 09:50:34,543[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 09:50:34,545[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 09:50:34,574[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   LAC
4   regular season   POR
5   regular season   NOP
6   regular season   SAS
7   regular season   DEN
8   regular season   OKC
9   regular season   UTA
10  regular season   NYK
11  regular season   TOR
12  regular season   IND
13  regular season   CHA
14  regular season   MEM
15  regular season   DET
16  regular season   BKN
17  regular season   SAC
18  regular season   PHI
19  regular season   DAL
20  regular season   WAS
21  regular season   MIN
22  regular season   LAL
23  regular season   CLE
24  regular season   ORL
25  regular season   MIA
26  regular season   ATL
27  regular season   CHI
28  regular season   HOU
29  regular season   MIL
DEBUG 2021-09-28 09:50:34,604[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 09:50:34,604[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 09:50:34,632[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 09:50:34,633[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 09:50:34,633[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 09:50:34,633[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 09:50:34,633[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 09:50:34,635[pattern_generator.py:gen_patterns:1207]   a_5
0   85
1  110
2  103
3   92
4  101
DEBUG 2021-09-28 09:50:35,459[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 09:50:35,507[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 09:50:35] "EXP /explanation HTTP/1.1" 200 -
DEBUG 2021-09-28 11:32:40,327[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 11:32:40,328[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 11:32:40,328[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 11:32:40,328[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 11:32:40,329[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 11:32:40,329[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 11:32:40,329[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 11:32:40,329[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 11:32:40,329[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 11:32:40,330[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 11:32:40,565[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 11:32:40,666[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 11:32:40,686[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 11:32:40,689[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 11:32:40,689[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 11:32:40,689[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 11:32:41,144[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 11:32:41,291[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 11:32:41,438[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 11:32:41,589[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 11:32:41,714[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 11:32:41,714[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 11:32:41,715[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 11:32:41,715[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 11:32:41,725[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 11:32:41,729[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 11:32:41,752[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 11:32:41,760[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 11:32:41,760[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 11:32:41,824[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 11:32:41,831[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 11:32:41,831[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 11:32:41,831[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 11:32:41,832[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 11:32:41,836[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1   90
2  103
3  104
4  114
DEBUG 2021-09-28 11:32:42,626[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 11:32:42,643[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 11:32:42,644[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 11:32:42,675[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   MIN
4   regular season   LAC
5   regular season   NOP
6   regular season   HOU
7   regular season   UTA
8   regular season   MEM
9   regular season   TOR
10  regular season   POR
11  regular season   SAC
12  regular season   WAS
13  regular season   CHA
14  regular season   ATL
15  regular season   MIA
16  regular season   BKN
17  regular season   IND
18  regular season   SAS
19  regular season   CLE
20  regular season   OKC
21  regular season   ORL
22  regular season   DET
23  regular season   DEN
24  regular season   CHI
25  regular season   NYK
26  regular season   DAL
27  regular season   BOS
DEBUG 2021-09-28 11:32:42,696[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 11:32:42,696[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 11:32:42,734[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 11:32:42,735[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 11:32:42,735[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 11:32:42,735[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 11:32:42,735[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 11:32:42,736[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1  110
2  100
3   97
4   83
DEBUG 2021-09-28 11:32:43,600[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 11:32:43,618[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 11:32:43,621[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 11:32:43,655[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   POR
4   regular season   LAC
5   regular season   SAC
6   regular season   DEN
7   regular season   LAL
8   regular season   DAL
9   regular season   NOP
10  regular season   OKC
11  regular season   BKN
12  regular season   TOR
13  regular season   DET
14  regular season   UTA
15  regular season   CHA
16  regular season   NYK
17  regular season   PHX
18  regular season   ATL
19  regular season   CLE
20  regular season   MEM
21  regular season   PHI
22  regular season   IND
23  regular season   ORL
24  regular season   HOU
25  regular season   MIL
26  regular season   MIA
27  regular season   WAS
28  regular season   MIN
29  regular season   CHI
DEBUG 2021-09-28 11:32:43,696[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 11:32:43,697[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 11:32:43,732[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 11:32:43,733[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 11:32:43,733[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 11:32:43,733[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 11:32:43,733[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 11:32:43,734[pattern_generator.py:gen_patterns:1207]   a_5
0   87
1  114
2  103
3  124
4  101
DEBUG 2021-09-28 11:32:44,429[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 11:32:44,460[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 11:32:44] "EXP /explanation HTTP/1.1" 200 -
DEBUG 2021-09-28 11:32:46,608[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 11:32:46,609[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 11:32:46,609[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 11:32:46,609[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 11:32:46,609[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 11:32:46,609[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 11:32:46,610[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 11:32:46,830[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 11:32:46,945[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 11:32:46,962[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 11:32:46,965[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 11:32:46,965[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 11:32:46,965[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 11:32:47,513[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 11:32:47,657[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 11:32:47,799[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 11:32:47,942[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 11:32:48,085[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 11:32:48,085[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 11:32:48,085[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 11:32:48,086[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 11:32:48,104[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 11:32:48,106[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 11:32:48,134[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 11:32:48,142[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 11:32:48,143[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 11:32:48,198[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 11:32:48,201[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 11:32:48,201[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 11:32:48,201[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 11:32:48,201[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 11:32:48,203[pattern_generator.py:gen_patterns:1207]   a_5
0   88
1  106
2  100
3  106
4  135
DEBUG 2021-09-28 11:32:49,117[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 11:32:49,131[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 11:32:49,133[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 11:32:49,169[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   UTA
4   regular season   NOP
5   regular season   MIN
6   regular season   LAC
7   regular season   HOU
8   regular season   MEM
9   regular season   DAL
10  regular season   ATL
11  regular season   CLE
12  regular season   WAS
13  regular season   TOR
14  regular season   BKN
15  regular season   CHA
16  regular season   POR
17  regular season   IND
18  regular season   OKC
19  regular season   DET
20  regular season   DEN
21  regular season   CHI
22  regular season   PHI
23  regular season   BOS
DEBUG 2021-09-28 11:32:49,210[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 11:32:49,211[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 11:32:49,239[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 11:32:49,240[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 11:32:49,240[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 11:32:49,240[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 11:32:49,240[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 11:32:49,240[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1   92
2  104
3  103
4  112
DEBUG 2021-09-28 11:32:49,896[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 11:32:49,913[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 11:32:49,915[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 11:32:49,956[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   POR
3   regular season   LAC
4   regular season   DEN
5   regular season   OKC
6   regular season   PHX
7   regular season   SAS
8   regular season   NOP
9   regular season   DAL
10  regular season   IND
11  regular season   WAS
12  regular season   CLE
13  regular season   UTA
14  regular season   NYK
15  regular season   ATL
16  regular season   LAL
17  regular season   SAC
18  regular season   MEM
19  regular season   CHA
20  regular season   MIN
21  regular season   DET
22  regular season   HOU
23  regular season   MIL
24  regular season   TOR
25  regular season   BOS
26  regular season   MIA
27  regular season   PHI
28  regular season   BKN
DEBUG 2021-09-28 11:32:49,998[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 11:32:49,998[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 11:32:50,022[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 11:32:50,023[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 11:32:50,023[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 11:32:50,023[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 11:32:50,023[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 11:32:50,023[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1   85
2   63
3  106
4   95
DEBUG 2021-09-28 11:32:50,762[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 11:32:50,790[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 11:32:50] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-28 12:13:18,736[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:13:21,352[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:13:21] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:13:21,463[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:13:21] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 12:13:33,150[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:13:33] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:13:33,194[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:13:33] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:13:39,308[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:13:39] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:13:46,622[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:13:46] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:16:18,171[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:16:22,623[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:22] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:16:22,761[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:22] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 12:16:27,148[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:27] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:16:27,197[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:27] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:16:31,029[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:31] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:16:38,719[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:38] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:16:53,440[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:16:55,787[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:55] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:16:55,890[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:16:55] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:17:06,577[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:17:06] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:17:06,627[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:17:06] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:17:11,604[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:17:11] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:18:08,690[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:18:10,282[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:18:10] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:18:10,425[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:18:10] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:18:14,882[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:18:14] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:18:20,088[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:18:20] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:18:20,139[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:18:20] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:18:24,943[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:18:24] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:20:27,124[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:20:28,684[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:20:28] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:20:28,825[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:20:28] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:20:39,021[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:20:39] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:20:39,093[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:20:39] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:20:45,701[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:20:45] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 12:22:56,991[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 12:22:56,991[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 12:22:56,992[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 12:22:56,992[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 12:22:56,992[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 12:22:56,993[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 12:22:56,993[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 12:22:56,993[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 12:22:56,993[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 12:22:56,994[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 12:22:56,994[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 12:22:56,994[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 12:22:56,994[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 12:22:56,994[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 12:22:56,995[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 12:22:56,995[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 12:22:56,995[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 12:22:56,995[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 12:22:57,221[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 12:22:57,323[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 12:22:57,343[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 12:22:57,346[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 12:22:57,346[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 12:22:57,346[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 12:22:57,812[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 12:22:57,936[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 12:22:58,081[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 12:22:58,224[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 12:22:58,371[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 12:22:58,371[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 12:22:58,371[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 12:22:58,371[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 12:22:58,390[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 12:22:58,396[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 12:22:58,444[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 12:22:58,470[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 12:22:58,470[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 12:22:58,518[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 12:22:58,520[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 12:22:58,520[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 12:22:58,520[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 12:22:58,520[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 12:22:58,522[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1   89
2  109
3  112
4  125
DEBUG 2021-09-28 12:22:59,454[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 12:22:59,472[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 12:22:59,474[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 12:22:59,501[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   NOP
4   regular season   MIN
5   regular season   UTA
6   regular season   HOU
7   regular season   MIA
8   regular season   TOR
9   regular season   DAL
10  regular season   CHA
11  regular season   CLE
12  regular season   LAC
13  regular season   MEM
14  regular season   POR
15  regular season   WAS
16  regular season   SAC
17  regular season   BKN
18  regular season   IND
19  regular season   LAL
20  regular season   OKC
21  regular season   DET
22  regular season   CHI
23  regular season   PHI
24  regular season   NYK
25  regular season   BOS
26  regular season   ATL
DEBUG 2021-09-28 12:22:59,520[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 12:22:59,521[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 12:22:59,546[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 12:22:59,547[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 12:22:59,547[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 12:22:59,547[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 12:22:59,547[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 12:22:59,548[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1  111
2  103
3   97
4   94
DEBUG 2021-09-28 12:23:00,244[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 12:23:00,258[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 12:23:00,260[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 12:23:00,286[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   SAS
4   regular season   PHX
5   regular season   SAC
6   regular season   LAL
7   regular season   DAL
8   regular season   NOP
9   regular season   IND
10  regular season   WAS
11  regular season   CLE
12  regular season   UTA
13  regular season   OKC
14  regular season   DET
15  regular season   DEN
16  regular season   POR
17  regular season   ATL
18  regular season   BKN
19  regular season   MEM
20  regular season   CHA
21  regular season   PHI
22  regular season   MIN
23  regular season   TOR
24  regular season   NYK
25  regular season   ORL
26  regular season   MIA
27  regular season   CHI
28  regular season   HOU
DEBUG 2021-09-28 12:23:00,315[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 12:23:00,315[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 12:23:00,346[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 12:23:00,347[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 12:23:00,347[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 12:23:00,347[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 12:23:00,347[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 12:23:00,348[pattern_generator.py:gen_patterns:1207]   a_5
0   92
1   97
2  108
3  101
4  104
DEBUG 2021-09-28 12:23:00,948[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 12:23:00,999[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:23:00] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-28 12:33:26,488[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:33:29,055[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:33:29] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:33:29,186[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:33:29] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:33:37,698[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:33:37] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:33:37,734[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:33:37] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:33:47,179[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:33:47] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 12:33:57,464[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 12:33:57,464[experiments.py:run_experiment:266]{'yes': 'BOS', 'no': 'DET'}
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]user_questions : 'team=BOS VS team=DET'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 12:33:57,465[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 12:33:57,466[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 12:33:57,466[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 12:33:57,466[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 12:33:57,466[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 12:33:57,674[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_0 AS (
SELECT /*+ materialize */ F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0)
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 12:33:57,745[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 12:33:57,758[experiments.py:run_experiment:297]Before filtering any, we have 1 valid jgs 

DEBUG 2021-09-28 12:33:57,762[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 12:33:57,762[experiments.py:run_experiment:313]before filtering intermediate, we have 1 jgs
DEBUG 2021-09-28 12:33:57,762[experiments.py:run_experiment:321]after filtering out intermediate we have 1 valid jgs 

ERROR 2021-09-28 12:33:57,993[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 167, in explanation
    run_experiment(conn=globals()['conn'],
  File "/home/juseung/CaJaDe/src/experiments.py", line 326, in run_experiment
    cost_estimate, renaming_dict, apt_q = jgm.materialize_jg(n)
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 409, in materialize_jg
    if(not self.non_redundant_check(query, renaming_dict)):
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 223, in non_redundant_check
    col_info_dict = self.get_col_info(renamed_a, self.db_dict, jg_rename_dict, ec_id)
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 72, in get_col_info
    re_a_index = int(re.findall(r'([0-9]+)', renamed_attribute)[0])
IndexError: list index out of range
INFO 2021-09-28 12:33:58,004[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:33:58] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-28 12:37:37,959[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:37:38,937[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:37:38] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:37:38,969[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:37:38] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:37:46,731[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:37:46] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:37:46,765[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:37:46] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:37:59,052[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:37:59] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 12:38:07,047[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 12:38:07,047[experiments.py:run_experiment:266]{'yes': 'BOS', 'no': 'DET'}
DEBUG 2021-09-28 12:38:07,047[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 12:38:07,048[experiments.py:run_experiment:269]user_questions : 'team=BOS VS team=DET'
DEBUG 2021-09-28 12:38:07,049[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 12:38:07,049[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 12:38:07,049[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 12:38:07,049[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 12:38:07,049[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 12:38:07,049[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 12:38:07,255[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_0 AS (
SELECT /*+ materialize */ F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0)
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 12:38:07,307[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 12:38:07,331[experiments.py:run_experiment:297]Before filtering any, we have 1 valid jgs 

DEBUG 2021-09-28 12:38:07,337[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 12:38:07,337[experiments.py:run_experiment:313]before filtering intermediate, we have 1 jgs
DEBUG 2021-09-28 12:38:07,337[experiments.py:run_experiment:321]after filtering out intermediate we have 1 valid jgs 

ERROR 2021-09-28 12:38:07,570[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 167, in explanation
    run_experiment(conn=globals()['conn'],
  File "/home/juseung/CaJaDe/src/experiments.py", line 326, in run_experiment
    cost_estimate, renaming_dict, apt_q = jgm.materialize_jg(n)
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 409, in materialize_jg
    if(not self.non_redundant_check(query, renaming_dict)):
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 223, in non_redundant_check
    col_info_dict = self.get_col_info(renamed_a, self.db_dict, jg_rename_dict, ec_id)
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 72, in get_col_info
    re_a_index = int(re.findall(r'([0-9]+)', renamed_attribute)[0])
IndexError: list index out of range
INFO 2021-09-28 12:38:07,576[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:38:07] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-28 12:45:42,120[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:45:44,114[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:45:44] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:45:44,189[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:45:44] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 12:45:49,745[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:45:49] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:45:49,786[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:45:49] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:45:53,729[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:45:53] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:45:57,919[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:45:57] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:48:45,051[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:48:46,747[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:48:46] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:48:46,822[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:48:46] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:48:46,944[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:48:46] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO 2021-09-28 12:48:53,333[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:48:53] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:48:53,390[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:48:53] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:48:58,193[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:48:58] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:51:11,909[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:51:13,854[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:51:13] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:51:13,936[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:51:13] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:51:20,308[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:51:20] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:51:20,364[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:51:20] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:51:24,397[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:51:24] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:52:47,176[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:52:48,845[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:52:48] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:52:48,949[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:52:48] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:52:55,728[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:52:55] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:52:55,789[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:52:55] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:52:59,352[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:52:59] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:53:41,566[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:53:44,182[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:53:44] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:53:44,246[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:53:44] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:54:03,754[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:03] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:54:03,808[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:03] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:54:07,153[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:07] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:54:10,819[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:10] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:54:35,953[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:54:37,738[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:37] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:54:37,855[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:37] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:54:45,534[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:45] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:54:45,576[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:45] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:54:49,759[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:54:49] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:55:49,640[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:56:09,115[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:56:09] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:56:09,211[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:56:09] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:56:20,498[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:56:20] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:56:20,536[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:56:20] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:56:24,598[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:56:24] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 12:56:27,675[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:56:27] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:59:00,716[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 12:59:03,021[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:59:03] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 12:59:03,094[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:59:03] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:59:10,453[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:59:10] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 12:59:10,504[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:59:10] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 12:59:14,888[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 12:59:14] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:01:02,717[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:01:04,154[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:01:04] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:01:04,230[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:01:04] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:01:09,567[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:01:09] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:01:09,644[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:01:09] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:02:20,053[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:02:22,868[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:02:22] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:02:22,954[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:02:22] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:02:23,024[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:02:23] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
INFO 2021-09-28 13:02:30,046[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:02:30] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:02:30,121[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:02:30] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:07:31,404[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:07:33,371[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:07:33] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:07:33,481[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:07:33] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:07:44,986[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:07:44] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:07:50,400[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:07:50] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:07:50,470[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:07:50] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:07:54,409[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:07:54] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:23:56,923[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:23:59,142[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:23:59] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:23:59,229[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:23:59] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:24:03,471[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:24:03] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:24:03,541[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:24:03] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:24:07,147[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:24:07] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:24:10,607[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:24:10] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:27:04,413[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:27:06,653[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:27:06] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:27:06,793[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:27:06] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:27:10,577[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:27:10] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:27:10,625[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:27:10] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:27:16,436[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:27:16] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:27:20,224[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:27:20] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:28:50,642[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:28:52,032[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:28:52] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:28:52,099[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:28:52] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:28:55,699[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:28:55] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:28:55,746[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:28:55] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:29:00,609[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:29:00] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:29:03,205[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:29:03] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:29:57,945[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:29:59,777[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:29:59] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:29:59,886[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:29:59] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:30:10,465[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:30:10] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:30:10,507[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:30:10] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:30:14,076[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:30:14] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:30:17,145[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:30:17] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:32:03,234[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:32:05,116[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:32:05] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:32:05,174[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:32:05] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:32:11,113[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:32:11] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:32:11,161[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:32:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:32:15,376[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:32:15] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:33:02,093[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:33:03,394[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:03] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:33:03,496[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:03] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:33:10,526[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:10] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:33:10,580[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:10] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:33:14,013[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:14] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:33:48,917[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:33:50,382[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:50] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:33:50,484[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:50] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:33:56,692[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:56] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:33:56,749[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:33:56] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:34:00,299[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:34:00] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:36:49,624[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:36:51,051[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:36:51] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:36:51,124[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:36:51] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:36:57,794[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:36:57] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:37:01,094[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:37:01] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:37:01,151[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:37:01] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:37:06,391[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:37:06] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 13:44:23,511[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:44:25,154[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:44:25] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:44:25,301[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:44:25] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:44:59,528[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:44:59] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:45:28,803[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:45:28] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:45:28,882[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:45:28] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:45:48,601[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 13:45:50,233[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:45:50] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 13:45:50,306[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:45:50] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:47:20,334[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:47:20] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 13:47:20,419[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:47:20] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 13:47:24,212[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 13:47:24] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:14:06,206[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:14:07,866[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:14:07] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:14:07,949[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:14:07] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 15:14:17,330[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:14:17] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:14:17,649[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:14:17] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:14:21,233[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:14:21] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:23:56,138[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:23:57,942[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:23:57] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:23:58,037[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:23:58] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:24:06,373[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:06] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:24:06,431[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:06] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:24:13,251[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:13] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:24:45,320[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:24:46,908[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:46] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:24:46,996[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:46] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:24:54,922[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:54] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:24:54,988[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:54] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:24:58,803[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:24:58] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:29:57,017[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:29:58,684[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:29:58] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:29:58,772[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:29:58] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 15:30:07,164[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:07] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:30:07,429[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:07] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:30:11,162[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:11] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:30:36,247[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:30:37,877[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:37] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:30:38,014[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:38] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:30:50,608[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:50] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:30:50,658[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:50] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:30:54,298[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:30:54] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:31:14,705[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:31:16,252[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:31:16] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:31:16,398[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:31:16] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:31:23,512[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:31:23] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:31:23,563[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:31:23] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:31:26,874[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:31:26] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:35:22,547[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:35:24,627[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:35:24] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:35:24,717[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:35:24] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 15:35:32,001[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:35:32] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:35:32,056[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:35:32] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:35:35,571[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:35:35] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 15:36:07,121[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:36:07] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:38:00,569[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:38:02,288[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:38:02] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:38:02,379[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:38:02] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 15:38:11,381[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:38:11] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:38:11,427[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:38:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:38:18,185[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:38:18] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 15:38:27,188[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 15:38:27,189[experiments.py:run_experiment:266]{'yes': 'BOS', 'no': 'DET'}
DEBUG 2021-09-28 15:38:27,189[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 15:38:27,190[experiments.py:run_experiment:269]user_questions : 'team=BOS VS team=DET'
DEBUG 2021-09-28 15:38:27,190[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 15:38:27,190[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 15:38:27,190[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 15:38:27,190[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 15:38:27,191[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 15:38:27,191[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 15:38:27,191[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 15:38:27,191[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 15:38:27,192[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 15:38:27,192[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 15:38:27,192[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 15:38:27,192[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 15:38:27,193[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 15:38:27,193[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 15:38:27,394[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_0 AS (
SELECT /*+ materialize */ F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0)
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 15:38:27,470[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 15:38:27,495[experiments.py:run_experiment:297]Before filtering any, we have 1 valid jgs 

DEBUG 2021-09-28 15:38:27,500[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 15:38:27,501[experiments.py:run_experiment:313]before filtering intermediate, we have 1 jgs
DEBUG 2021-09-28 15:38:27,501[experiments.py:run_experiment:321]after filtering out intermediate we have 1 valid jgs 

ERROR 2021-09-28 15:38:27,737[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 167, in explanation
    run_experiment(conn=globals()['conn'],
  File "/home/juseung/CaJaDe/src/experiments.py", line 326, in run_experiment
    cost_estimate, renaming_dict, apt_q = jgm.materialize_jg(n)
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 409, in materialize_jg
    if(not self.non_redundant_check(query, renaming_dict)):
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 223, in non_redundant_check
    col_info_dict = self.get_col_info(renamed_a, self.db_dict, jg_rename_dict, ec_id)
  File "/home/juseung/CaJaDe/src/jg_materializer.py", line 72, in get_col_info
    re_a_index = int(re.findall(r'([0-9]+)', renamed_attribute)[0])
IndexError: list index out of range
INFO 2021-09-28 15:38:27,743[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:38:27] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-28 15:39:35,076[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:39:36,619[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:36] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:39:36,713[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:36] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:39:42,222[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:42] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:39:42,286[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:42] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:39:45,598[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:45] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 15:39:50,517[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 15:39:50,518[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 15:39:50,519[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 15:39:50,519[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 15:39:50,519[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 15:39:50,520[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 15:39:50,520[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 15:39:50,520[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 15:39:50,520[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 15:39:50,520[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 15:39:50,521[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 15:39:50,521[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 15:39:50,521[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 15:39:50,521[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 15:39:50,521[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 15:39:50,521[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 15:39:50,522[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 15:39:50,522[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 15:39:50,715[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 15:39:50,816[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 15:39:50,838[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 15:39:50,842[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 15:39:50,842[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 15:39:50,842[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 15:39:51,302[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:39:51,438[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:39:51,575[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:39:51,718[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 15:39:51,863[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 15:39:51,863[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 15:39:51,863[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 15:39:51,863[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 15:39:51,881[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 15:39:51,885[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:39:51,913[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 15:39:51,925[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 15:39:51,925[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 15:39:51,974[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:39:51,976[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:39:51,976[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:39:51,977[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:39:51,977[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:39:51,978[pattern_generator.py:gen_patterns:1207]   a_5
0  131
1   87
2  111
3  107
4  115
DEBUG 2021-09-28 15:39:52,745[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 15:39:52,745[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 15:39:52,745[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 15:39:52,745[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 15:39:52,746[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 15:39:52,747[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 15:39:52,747[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 15:39:52,843[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 15:39:52,850[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'nominal', 'a_16': 'ordinal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team', 'a_16': 'team_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 15:39:52,852[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:39:52,896[pattern_generator.py:gen_patterns:1012]              a_14  a_15
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   PHX
4   regular season   UTA
5   regular season   HOU
6   regular season   NOP
7   regular season   ATL
8   regular season   WAS
9   regular season   CHA
10  regular season   LAC
11  regular season   MIA
12  regular season   TOR
13  regular season   CLE
14  regular season   MEM
15  regular season   BKN
16  regular season   POR
17  regular season   DAL
18  regular season   PHI
19  regular season   BOS
20  regular season   LAL
21  regular season   SAS
22  regular season   NYK
23  regular season   DET
24  regular season   IND
25  regular season   ORL
DEBUG 2021-09-28 15:39:52,927[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 15:39:53,005[experiments.py:run_experiment:294]generate new valid_jgs
ERROR 2021-09-28 15:39:53,006[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 202, in explanation
    run_experiment(conn=globals()['conn'])
  File "/home/juseung/CaJaDe/src/experiments.py", line 362, in run_experiment
    pgen.gen_patterns(jg=vr,
  File "/home/juseung/CaJaDe/src/pattern_generator.py", line 1044, in gen_patterns
    self.cur.execute(np_recall_query)
psycopg2.errors.UndefinedTable: relation "jg_3" does not exist
LINE 5:                         FROM jg_3 WHERE a_14='regular season...
                                     ^

DEBUG 2021-09-28 15:39:53,027[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

INFO 2021-09-28 15:39:53,031[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:53] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
DEBUG 2021-09-28 15:39:53,032[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 15:39:53,033[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 15:39:53,033[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 15:39:53,591[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:39:53,734[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:39:53,876[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:39:54,021[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 15:39:54,163[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 15:39:54,163[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 15:39:54,163[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 15:39:54,164[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 15:39:54,184[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 15:39:54,187[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:39:54,229[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 15:39:54,256[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 15:39:54,256[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 15:39:54,304[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:39:54,306[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:39:54,306[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:39:54,307[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:39:54,307[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:39:54,308[pattern_generator.py:gen_patterns:1207]   a_5
0  112
1  106
2  112
3  104
4  118
DEBUG 2021-09-28 15:39:55,106[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 15:39:55,120[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'nominal', 'a_16': 'ordinal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team', 'a_16': 'team_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 15:39:55,122[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:39:55,145[pattern_generator.py:gen_patterns:1012]              a_14  a_15
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   NOP
4   regular season   UTA
5   regular season   PHX
6   regular season   HOU
7   regular season   MIA
8   regular season   BKN
9   regular season   POR
10  regular season   CHA
11  regular season   CLE
12  regular season   MEM
13  regular season   LAC
14  regular season   ATL
15  regular season   TOR
16  regular season   DAL
17  regular season   DEN
18  regular season   ORL
19  regular season   CHI
20  regular season   OKC
21  regular season   SAC
22  regular season   PHI
23  regular season   WAS
24  regular season   LAL
25  regular season   SAS
26  regular season   NYK
27  regular season   DET
DEBUG 2021-09-28 15:39:55,164[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_15', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 15:39:55,164[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 15:39:55,187[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:39:55,188[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:39:55,188[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:39:55,188[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:39:55,188[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:39:55,189[pattern_generator.py:gen_patterns:1207]   a_5
0  114
1  111
2   97
3   88
4   92
DEBUG 2021-09-28 15:39:55,970[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 15:39:55,980[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'nominal', 'a_16': 'ordinal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team', 'a_16': 'team_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 15:39:55,982[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:39:56,016[pattern_generator.py:gen_patterns:1012]              a_14  a_15
0   regular season  None
1   regular season   GSW
2   regular season   LAC
3   regular season   NOP
4   regular season   PHX
5   regular season   POR
6   regular season   SAS
7   regular season   SAC
8   regular season   DAL
9   regular season   PHI
10  regular season   MEM
11  regular season   IND
12  regular season   CHA
13  regular season   OKC
14  regular season   MIN
15  regular season   CLE
16  regular season   DEN
17  regular season   LAL
18  regular season   DET
19  regular season   UTA
20  regular season   WAS
21  regular season   BKN
22  regular season   NYK
23  regular season   TOR
24  regular season   ORL
25  regular season   ATL
26  regular season   HOU
27  regular season   MIL
DEBUG 2021-09-28 15:39:56,057[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_15', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 15:39:56,057[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 15:39:56,085[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:39:56,085[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:39:56,086[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:39:56,086[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:39:56,086[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:39:56,086[pattern_generator.py:gen_patterns:1207]   a_5
0  109
1  106
2  124
3   85
4   83
DEBUG 2021-09-28 15:39:56,832[experiments.py:run_experiment:476]total number of patterns 41
ERROR 2021-09-28 15:39:56,868[app.py:log_exception:1454]Exception on /explanation [EXP]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 213, in explanation
    globals()['cursor'].execute(query2)
psycopg2.InterfaceError: cursor already closed
INFO 2021-09-28 15:39:56,870[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:39:56] "[35m[1mEXP /explanation HTTP/1.1[0m" 500 -
INFO 2021-09-28 15:41:08,635[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 15:41:11,037[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:41:11] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 15:41:11,129[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:41:11] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:41:15,868[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:41:15] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:41:15,911[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:41:15] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 15:41:26,442[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:41:26] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 15:41:31,760[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 15:41:31,761[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 15:41:31,762[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 15:41:31,762[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 15:41:31,763[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 15:41:31,763[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 15:41:31,763[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 15:41:31,764[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 15:41:31,764[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 15:41:31,764[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 15:41:31,764[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 15:41:31,764[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 15:41:31,765[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 15:41:31,765[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 15:41:31,765[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 15:41:31,765[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 15:41:31,765[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 15:41:31,765[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 15:41:31,983[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 15:41:32,114[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 15:41:32,139[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 15:41:32,141[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 15:41:32,141[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 15:41:32,141[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 15:41:32,602[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:41:32,747[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:41:32,892[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 15:41:33,040[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 15:41:33,185[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 15:41:33,186[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 15:41:33,186[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 15:41:33,186[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 15:41:33,201[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 15:41:33,204[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:41:33,230[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 15:41:33,243[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 15:41:33,244[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 15:41:33,314[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:41:33,316[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:41:33,316[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:41:33,316[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:41:33,316[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:41:33,318[pattern_generator.py:gen_patterns:1207]   a_5
0  104
1  112
2  134
3  100
4  103
DEBUG 2021-09-28 15:41:33,994[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 15:41:34,015[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 15:41:34,019[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:41:34,064[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   MIN
3   regular season   LAC
4   regular season   UTA
5   regular season   NOP
6   regular season   CLE
7   regular season   SAC
8   regular season   MIA
9   regular season   PHX
10  regular season   TOR
11  regular season   POR
12  regular season   WAS
13  regular season   CHA
14  regular season   ATL
15  regular season   MEM
16  regular season   BKN
17  regular season   HOU
18  regular season   DAL
19  regular season   ORL
20  regular season   LAL
21  regular season   IND
22  regular season   SAS
23  regular season   DEN
24  regular season   NYK
25  regular season   DET
DEBUG 2021-09-28 15:41:34,085[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 15:41:34,085[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 15:41:34,108[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:41:34,109[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:41:34,109[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:41:34,109[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:41:34,109[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:41:34,110[pattern_generator.py:gen_patterns:1207]   a_5
0   69
1   98
2  104
3   99
4   97
DEBUG 2021-09-28 15:41:34,719[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 15:41:34,733[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 15:41:34,734[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 15:41:34,769[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   NOP
3   regular season   LAC
4   regular season   SAS
5   regular season   SAC
6   regular season   POR
7   regular season   OKC
8   regular season   PHX
9   regular season   DEN
10  regular season   IND
11  regular season   MIN
12  regular season   MEM
13  regular season   DET
14  regular season   BKN
15  regular season   PHI
16  regular season   ATL
17  regular season   DAL
18  regular season   NYK
19  regular season   LAL
20  regular season   UTA
21  regular season   TOR
22  regular season   CLE
23  regular season   HOU
24  regular season   MIL
25  regular season   CHA
26  regular season   WAS
27  regular season   CHI
28  regular season   MIA
DEBUG 2021-09-28 15:41:34,808[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 15:41:34,808[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 15:41:34,836[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 15:41:34,836[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 15:41:34,836[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 15:41:34,836[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 15:41:34,836[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 15:41:34,837[pattern_generator.py:gen_patterns:1207]   a_5
0  135
1  116
2  106
3   89
4  128
DEBUG 2021-09-28 15:41:35,433[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 15:41:35,464[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:41:35] "EXP /explanation HTTP/1.1" 200 -
INFO 2021-09-28 15:42:00,841[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:42:00] "GET /db/ HTTP/1.1" 200 -
INFO 2021-09-28 15:42:14,120[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:42:14] "GET /db/?active_table=team_game_stats HTTP/1.1" 200 -
INFO 2021-09-28 15:42:14,198[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 15:42:14] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 16:02:05,893[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 16:02:07,694[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:02:07] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 16:02:07,860[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:02:07] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 16:02:13,334[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:02:13] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 16:02:13,400[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:02:13] "GET /static/main.css HTTP/1.1" 200 -
ERROR 2021-09-28 16:02:39,307[app.py:log_exception:1454]Exception on /ajax [POST]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 149, in ajax
    cursor.execute(query)
psycopg2.errors.SyntaxError: syntax error at or near "from"
LINE 1: select *,  from team where team='BOS' group by 
                   ^

INFO 2021-09-28 16:02:39,309[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:02:39] "[35m[1mPOST /ajax HTTP/1.1[0m" 500 -
INFO 2021-09-28 16:06:14,160[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 16:06:15,987[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:06:15] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 16:06:16,059[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:06:16] "GET /static/main.css HTTP/1.1" 200 -
INFO 2021-09-28 16:06:20,248[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:06:20] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 16:06:20,288[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:06:20] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 16:06:28,262[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:06:28] "POST /ajax HTTP/1.1" 200 -
INFO 2021-09-28 16:13:21,342[_internal.py:_log:225] * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO 2021-09-28 16:13:25,931[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:13:25] "GET / HTTP/1.1" 200 -
INFO 2021-09-28 16:13:26,069[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:13:26] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
INFO 2021-09-28 16:13:31,641[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:13:31] "POST /db/ HTTP/1.1" 200 -
INFO 2021-09-28 16:13:31,679[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:13:31] "[36mGET /static/main.css HTTP/1.1[0m" 304 -
ERROR 2021-09-28 16:14:00,704[app.py:log_exception:1454]Exception on /ajax [POST]
Traceback (most recent call last):
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 2070, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1515, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1513, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/juseung/cajade/lib/python3.8/site-packages/flask/app.py", line 1499, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**req.view_args)
  File "/home/juseung/CaJaDe/demo/app.py", line 149, in ajax
    cursor.execute(query)
psycopg2.errors.SyntaxError: syntax error at or near "from"
LINE 1: select *,  from team where  group by 
                   ^

INFO 2021-09-28 16:14:00,707[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:14:00] "[35m[1mPOST /ajax HTTP/1.1[0m" 500 -
INFO 2021-09-28 16:15:31,791[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:15:31] "POST /ajax HTTP/1.1" 200 -
DEBUG 2021-09-28 16:15:39,135[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 16:15:39,135[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 16:15:39,136[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 16:15:39,136[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 16:15:39,136[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 16:15:39,137[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 16:15:39,137[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 16:15:39,137[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 16:15:39,137[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 16:15:39,138[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 16:15:39,138[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 16:15:39,138[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 16:15:39,138[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 16:15:39,139[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 16:15:39,139[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 16:15:39,139[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 16:15:39,139[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 16:15:39,140[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 16:15:39,364[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 16:15:39,470[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 16:15:39,494[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 16:15:39,498[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 16:15:39,498[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 16:15:39,498[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 16:15:39,957[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 16:15:40,101[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 16:15:40,245[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 16:15:40,387[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 16:15:40,532[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 16:15:40,533[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 16:15:40,533[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 16:15:40,533[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 16:15:40,548[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 16:15:40,550[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 16:15:40,581[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 16:15:40,595[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 16:15:40,595[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 16:15:40,646[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 16:15:40,649[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 16:15:40,650[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 16:15:40,650[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 16:15:40,650[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 16:15:40,652[pattern_generator.py:gen_patterns:1207]   a_5
0   97
1   96
2   99
3  120
4  134
DEBUG 2021-09-28 16:15:41,386[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 16:15:41,403[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 16:15:41,404[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 16:15:41,450[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   MIN
4   regular season   NOP
5   regular season   HOU
6   regular season   UTA
7   regular season   BKN
8   regular season   SAC
9   regular season   CHA
10  regular season   MIA
11  regular season   TOR
12  regular season   LAC
13  regular season   MEM
14  regular season   POR
15  regular season   CLE
16  regular season   WAS
17  regular season   IND
18  regular season   SAS
19  regular season   OKC
20  regular season   ORL
21  regular season   DET
22  regular season   DEN
23  regular season   PHI
DEBUG 2021-09-28 16:15:41,473[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 16:15:41,473[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 16:15:41,497[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 16:15:41,498[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 16:15:41,498[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 16:15:41,498[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 16:15:41,498[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 16:15:41,499[pattern_generator.py:gen_patterns:1207]   a_5
0  118
1  134
2   99
3  111
4   85
DEBUG 2021-09-28 16:15:42,166[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 16:15:42,179[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 16:15:42,181[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 16:15:42,220[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   SAS
3   regular season   POR
4   regular season   DEN
5   regular season   LAC
6   regular season   NOP
7   regular season   PHX
8   regular season   DAL
9   regular season   SAC
10  regular season   LAL
11  regular season   UTA
12  regular season   DET
13  regular season   TOR
14  regular season   MEM
15  regular season   OKC
16  regular season   ATL
17  regular season   MIN
18  regular season   WAS
19  regular season   CHA
20  regular season   BKN
21  regular season   IND
22  regular season   HOU
23  regular season   MIL
24  regular season   ORL
25  regular season   CLE
26  regular season   BOS
27  regular season   CHI
DEBUG 2021-09-28 16:15:42,244[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 16:15:42,244[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 16:15:42,268[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 16:15:42,269[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 16:15:42,269[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 16:15:42,269[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 16:15:42,270[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 16:15:42,270[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1   94
2  130
3  107
4   98
DEBUG 2021-09-28 16:15:42,932[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 16:15:42,977[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:15:42] "EXP /explanation HTTP/1.1" 200 -
DEBUG 2021-09-28 16:18:28,978[experiments.py:run_experiment:265]test__nba__0.1__100__100__False__1__0.2__y__f__o__0.3__100
DEBUG 2021-09-28 16:18:28,979[experiments.py:run_experiment:266]{'yes': '2015-16', 'no': '2012-13'}
DEBUG 2021-09-28 16:18:28,979[experiments.py:run_experiment:269]f1_min_sample_size_threshold : '100'
DEBUG 2021-09-28 16:18:28,979[experiments.py:run_experiment:269]numercial_attr_filter_method : 'y'
DEBUG 2021-09-28 16:18:28,979[experiments.py:run_experiment:269]sample_rate_for_s : '0.1'
DEBUG 2021-09-28 16:18:28,979[experiments.py:run_experiment:269]f1_sample_rate : '0.3'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]f1_calculation_type : 'o'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]result_schema : 'demotest'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]maximum_edges : '1'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]user_questions : 'season_name=2015-16 VS season_name=2012-13'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]exclude_high_cost_jg : 'f'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]min_recall_threshold : '0.2'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]dbname : 'nba'
DEBUG 2021-09-28 16:18:28,980[experiments.py:run_experiment:269]user_query : 'test'
DEBUG 2021-09-28 16:18:28,981[experiments.py:run_experiment:269]lca_s_max_size : '100'
DEBUG 2021-09-28 16:18:28,981[experiments.py:run_experiment:269]lca_s_min_size : '100'
DEBUG 2021-09-28 16:18:28,981[experiments.py:run_experiment:269]just_lca : False
DEBUG 2021-09-28 16:18:28,981[experiments.py:run_experiment:269]f1_sample_type : 's.0'
DEBUG 2021-09-28 16:18:29,180[provenance_getter.py:gen_provenance_table:65]CREATE VIEW original_pt AS WITH _temp_view_1 AS (
SELECT /*+ materialize */ 1 AS "AGG_GB_ARG0", F0."season_name" AS "AGG_GB_ARG1", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F1."season_id" AS "season_id1", F1."season_name" AS "season_name", F1."season_type" AS "season_type", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F1."game_date" AS "game_date", F1."home_points" AS "home_points", F1."away_points" AS "away_points", F1."home_possessions" AS "home_possessions", F1."away_possessions" AS "away_possessions", F1."home_id" AS "home_id", F1."away_id" AS "away_id", F1."winner_id" AS "winner_id", F1."season_id" AS "season_id", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id"
FROM ((
SELECT F0."team_id" AS "team_id", F0."team" AS "team", F0."team_id" AS "prov_team_team__id", F0."team" AS "prov_team_team"
FROM "team" AS F0) F0 CROSS JOIN (
SELECT F0."game_date" AS "game_date", F0."home_points" AS "home_points", F0."away_points" AS "away_points", F0."home_possessions" AS "home_possessions", F0."away_possessions" AS "away_possessions", F0."home_id" AS "home_id", F0."away_id" AS "away_id", F0."winner_id" AS "winner_id", F0."season_id" AS "season_id", F0."game_date" AS "prov_game_game__date", F0."home_points" AS "prov_game_home__points", F0."away_points" AS "prov_game_away__points", F0."home_possessions" AS "prov_game_home__possessions", F0."away_possessions" AS "prov_game_away__possessions", F0."home_id" AS "prov_game_home__id", F0."away_id" AS "prov_game_away__id", F0."winner_id" AS "prov_game_winner__id", F0."season_id" AS "prov_game_season__id"
FROM "game" AS F0) F1)) F0 CROSS JOIN (
SELECT F0."season_id" AS "season_id", F0."season_name" AS "season_name", F0."season_type" AS "season_type", F0."season_id" AS "prov_season_season__id", F0."season_name" AS "prov_season_season__name", F0."season_type" AS "prov_season_season__type"
FROM "season" AS F0) F1)) F0
WHERE (((F0."team_id" = F0."winner_id") AND (F0."season_id" = F0."season_id1")) AND (F0."team" = 'GSW'))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."GROUP_0" AS "GROUP_0", F1."prov_team_team__id" AS "prov_team_team__id", F1."prov_team_team" AS "prov_team_team", F1."prov_game_game__date" AS "prov_game_game__date", F1."prov_game_home__points" AS "prov_game_home__points", F1."prov_game_away__points" AS "prov_game_away__points", F1."prov_game_home__possessions" AS "prov_game_home__possessions", F1."prov_game_away__possessions" AS "prov_game_away__possessions", F1."prov_game_home__id" AS "prov_game_home__id", F1."prov_game_away__id" AS "prov_game_away__id", F1."prov_game_winner__id" AS "prov_game_winner__id", F1."prov_game_season__id" AS "prov_game_season__id", F1."prov_season_season__id" AS "prov_season_season__id", F1."prov_season_season__name" AS "prov_season_season__name", F1."prov_season_season__type" AS "prov_season_season__type"
FROM ((
SELECT count(1) AS "AGGR_0", F2."season_name" AS "GROUP_0"
FROM (("team" AS F0 CROSS JOIN "game" AS F1) CROSS JOIN "season" AS F2)
WHERE (((F0."team_id" = F1."winner_id") AND (F1."season_id" = F2."season_id")) AND (F0."team" = 'GSW'))
GROUP BY F2."season_name") F0 JOIN (
SELECT F0."AGG_GB_ARG1" AS "_P_SIDE_GROUP_0", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."AGGR_0" AS "win", F0."GROUP_0" AS "season_name", F0."prov_team_team__id" AS "prov_team_team__id", F0."prov_team_team" AS "prov_team_team", F0."prov_game_game__date" AS "prov_game_game__date", F0."prov_game_home__points" AS "prov_game_home__points", F0."prov_game_away__points" AS "prov_game_away__points", F0."prov_game_home__possessions" AS "prov_game_home__possessions", F0."prov_game_away__possessions" AS "prov_game_away__possessions", F0."prov_game_home__id" AS "prov_game_home__id", F0."prov_game_away__id" AS "prov_game_away__id", F0."prov_game_winner__id" AS "prov_game_winner__id", F0."prov_game_season__id" AS "prov_game_season__id", F0."prov_season_season__id" AS "prov_season_season__id", F0."prov_season_season__name" AS "prov_season_season__name", F0."prov_season_season__type" AS "prov_season_season__type"
FROM (SELECT * FROM _temp_view_0) F0;


;
DEBUG 2021-09-28 16:18:29,291[experiments.py:run_experiment:294]generate new valid_jgs
DEBUG 2021-09-28 16:18:29,325[experiments.py:run_experiment:297]Before filtering any, we have 5 valid jgs 

DEBUG 2021-09-28 16:18:29,327[experiments.py:run_experiment:312]DO include high cost jg!!!!!!!!!!!!!
DEBUG 2021-09-28 16:18:29,327[experiments.py:run_experiment:313]before filtering intermediate, we have 5 jgs
DEBUG 2021-09-28 16:18:29,327[experiments.py:run_experiment:321]after filtering out intermediate we have 5 valid jgs 

DEBUG 2021-09-28 16:18:29,787[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.winner_id)', {'game': ['winner_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 16:18:29,934[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.home_id)', {'game': ['home_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 16:18:30,078[jg_materializer.py:materialize_jg:316]['(team.team_id)=(PT.away_id)', {'game': ['away_id'], 'team': ['team_id']}, 'game']
DEBUG 2021-09-28 16:18:30,220[jg_materializer.py:materialize_jg:316]['(season.season_id)=(PT.season_id)', {'game': ['season_id'], 'season': ['season_id']}, 'game']
DEBUG 2021-09-28 16:18:30,364[experiments.py:run_experiment:337]before filtering redundant, we have 5 jgs
DEBUG 2021-09-28 16:18:30,364[experiments.py:run_experiment:340]after filtering out redundant we have 3 valid jgs 

DEBUG 2021-09-28 16:18:30,364[experiments.py:run_experiment:342]we found 3 valid join graphs, now materializing and generating patterns
DEBUG 2021-09-28 16:18:30,364[experiments.py:run_experiment:350]we are on join graph number 1
DEBUG 2021-09-28 16:18:30,381[pattern_generator.py:gen_patterns:730]{'max_rel_index': 2, 'max_attr_index': 14, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}}
DEBUG 2021-09-28 16:18:30,382[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 16:18:30,425[pattern_generator.py:gen_patterns:1012]             a_14
0  regular season
DEBUG 2021-09-28 16:18:30,455[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}]
DEBUG 2021-09-28 16:18:30,455[pattern_generator.py:gen_patterns:1056]1
DEBUG 2021-09-28 16:18:30,533[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 16:18:30,535[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 16:18:30,535[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 16:18:30,535[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 16:18:30,535[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 16:18:30,537[pattern_generator.py:gen_patterns:1207]   a_5
0   92
1  105
2   96
3  104
4  112
DEBUG 2021-09-28 16:18:31,256[experiments.py:run_experiment:350]we are on join graph number 2
DEBUG 2021-09-28 16:18:31,271[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 16:18:31,273[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 16:18:31,310[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   PHX
3   regular season   MIN
4   regular season   UTA
5   regular season   HOU
6   regular season   NOP
7   regular season   LAC
8   regular season   MEM
9   regular season   POR
10  regular season   CHA
11  regular season   TOR
12  regular season   ATL
13  regular season   CLE
14  regular season   MIA
15  regular season   DAL
16  regular season   SAC
17  regular season   BKN
18  regular season   WAS
19  regular season   BOS
20  regular season   ORL
21  regular season   DET
22  regular season   DEN
23  regular season   PHI
DEBUG 2021-09-28 16:18:31,337[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.5583333333333333}]
DEBUG 2021-09-28 16:18:31,337[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 16:18:31,367[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 16:18:31,368[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 16:18:31,368[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 16:18:31,368[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 16:18:31,368[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 16:18:31,369[pattern_generator.py:gen_patterns:1207]   a_5
0  103
1  116
2   83
3  116
4  101
DEBUG 2021-09-28 16:18:32,043[experiments.py:run_experiment:350]we are on join graph number 3
DEBUG 2021-09-28 16:18:32,061[pattern_generator.py:gen_patterns:730]{'max_rel_index': 3, 'max_attr_index': 16, 'dtypes': {'win': 'nominal', 'season_name': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'ordinal', 'a_5': 'ordinal', 'a_6': 'ordinal', 'a_7': 'ordinal', 'a_8': 'ordinal', 'a_9': 'ordinal', 'a_10': 'ordinal', 'a_11': 'ordinal', 'a_12': 'ordinal', 'a_13': 'nominal', 'a_14': 'nominal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_15': 'ordinal', 'a_16': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'win': 'win', 'season_name': 'season_name', 'a_1': 'prov_team_team__id', 'a_2': 'prov_team_team', 'a_3': 'prov_game_game__date', 'a_4': 'prov_game_home__points', 'a_5': 'prov_game_away__points', 'a_6': 'prov_game_home__possessions', 'a_7': 'prov_game_away__possessions', 'a_8': 'prov_game_home__id', 'a_9': 'prov_game_away__id', 'a_10': 'prov_game_winner__id', 'a_11': 'prov_game_season__id', 'a_12': 'prov_season_season__id', 'a_13': 'prov_season_season__name', 'a_14': 'prov_season_season__type', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 14}, 2: {'key': 2, 'label': 'team', 'columns': {'a_15': 'team_id', 'a_16': 'team'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 14, 'rel_max_attr_index': 16}}
DEBUG 2021-09-28 16:18:32,065[pattern_generator.py:gen_patterns:892]sample size : 100
DEBUG 2021-09-28 16:18:32,100[pattern_generator.py:gen_patterns:1012]              a_14  a_16
0   regular season  None
1   regular season   GSW
2   regular season   NOP
3   regular season   PHX
4   regular season   SAS
5   regular season   POR
6   regular season   LAC
7   regular season   DAL
8   regular season   DEN
9   regular season   LAL
10  regular season   SAC
11  regular season   TOR
12  regular season   CHA
13  regular season   PHI
14  regular season   BKN
15  regular season   OKC
16  regular season   IND
17  regular season   MIN
18  regular season   CLE
19  regular season   MEM
20  regular season   UTA
21  regular season   DET
22  regular season   NYK
23  regular season   ATL
24  regular season   MIL
25  regular season   MIA
26  regular season   WAS
27  regular season   CHI
28  regular season   HOU
DEBUG 2021-09-28 16:18:32,125[pattern_generator.py:gen_patterns:1055][{'nominal_values': [['a_14', 'regular season']], 'np_recall': 1.0}, {'nominal_values': [['a_14', 'regular season'], ['a_16', 'GSW']], 'np_recall': 0.44166666666666665}]
DEBUG 2021-09-28 16:18:32,125[pattern_generator.py:gen_patterns:1056]2
DEBUG 2021-09-28 16:18:32,156[pattern_generator.py:gen_patterns:1167]{0: [['a_4', 0, 0], ['a_5', 0, 0], ['a_6', 0, 0], ['a_7', 0, 0]]}
DEBUG 2021-09-28 16:18:32,159[pattern_generator.py:gen_patterns:1187]a_5
DEBUG 2021-09-28 16:18:32,160[pattern_generator.py:gen_patterns:1193]lagrge number of num attrs
DEBUG 2021-09-28 16:18:32,160[pattern_generator.py:gen_patterns:1194]['a_5']
DEBUG 2021-09-28 16:18:32,160[pattern_generator.py:gen_patterns:1195]{'a_5': ['a_4', 'a_7', 'a_6']}
DEBUG 2021-09-28 16:18:32,162[pattern_generator.py:gen_patterns:1207]   a_5
0   93
1  103
2  104
3   92
4   94
DEBUG 2021-09-28 16:18:32,914[experiments.py:run_experiment:476]total number of patterns 41
INFO 2021-09-28 16:18:32,942[_internal.py:_log:225]127.0.0.1 - - [28/Sep/2021 16:18:32] "EXP /explanation HTTP/1.1" 200 -
