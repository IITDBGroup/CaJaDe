DEBUG 2021-02-04 12:41:49,561[experiments.py:run_experiment:215]medicare vs private__mimic_cleaned__0.05__2__2__0.0__y__f__s__1.0__1000
DEBUG 2021-02-04 12:41:49,561[experiments.py:run_experiment:218]dbname : 'mimic_cleaned'
DEBUG 2021-02-04 12:41:49,561[experiments.py:run_experiment:218]user_questions : 'insurance=Private VS insurance=Medicare'
DEBUG 2021-02-04 12:41:49,561[experiments.py:run_experiment:218]max_sample_factor : '2'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]exclude_high_cost_jg : 'f'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]f1_sample_rate : '1.0'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]result_schema : 'mimic_feb4th_med_vs_private_new'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]f1_calculation_type : 's'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]min_recall_threshold : '0.0'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]numercial_attr_filter_method : 'y'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]maximum_edges : '2'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]sample_rate_for_s : '0.05'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]f1_min_sample_size_threshold : '1000'
DEBUG 2021-02-04 12:41:49,562[experiments.py:run_experiment:218]user_query : 'medicare vs private'
DEBUG 2021-02-04 12:41:49,684[sg_generator.py:generate_graph:205][{'f_table': 'icustays', 'p_table': 'patients', 'f_key': 'subject_id', 'p_key': 'subject_id', 'condition_str': '(patients.subject_id)=(icustays.subject_id)', 'key_dict': {'icustays': ['subject_id'], 'patients': ['subject_id']}}, {'f_table': 'procedures', 'p_table': 'patients', 'f_key': 'subject_id', 'p_key': 'subject_id', 'condition_str': '(patients.subject_id)=(procedures.subject_id)', 'key_dict': {'procedures': ['subject_id'], 'patients': ['subject_id']}}, {'f_table': 'diagnoses', 'p_table': 'patients', 'f_key': 'subject_id', 'p_key': 'subject_id', 'condition_str': '(patients.subject_id)=(diagnoses.subject_id)', 'key_dict': {'diagnoses': ['subject_id'], 'patients': ['subject_id']}}, {'f_table': 'patients_admit_info', 'p_table': 'patients', 'f_key': 'subject_id', 'p_key': 'subject_id', 'condition_str': '(patients.subject_id)=(patients_admit_info.subject_id)', 'key_dict': {'patients_admit_info': ['subject_id'], 'patients': ['subject_id']}}, {'f_table': 'icustays', 'p_table': 'admissions', 'f_key': 'hadm_id', 'p_key': 'hadm_id', 'condition_str': '(admissions.hadm_id)=(icustays.hadm_id)', 'key_dict': {'icustays': ['hadm_id'], 'admissions': ['hadm_id']}}, {'f_table': 'procedures', 'p_table': 'admissions', 'f_key': 'hadm_id', 'p_key': 'hadm_id', 'condition_str': '(admissions.hadm_id)=(procedures.hadm_id)', 'key_dict': {'procedures': ['hadm_id'], 'admissions': ['hadm_id']}}, {'f_table': 'diagnoses', 'p_table': 'admissions', 'f_key': 'hadm_id', 'p_key': 'hadm_id', 'condition_str': '(admissions.hadm_id)=(diagnoses.hadm_id)', 'key_dict': {'diagnoses': ['hadm_id'], 'admissions': ['hadm_id']}}, {'f_table': 'patients_admit_info', 'p_table': 'admissions', 'f_key': 'hadm_id', 'p_key': 'hadm_id', 'condition_str': '(admissions.hadm_id)=(patients_admit_info.hadm_id)', 'key_dict': {'patients_admit_info': ['hadm_id'], 'admissions': ['hadm_id']}}]
DEBUG 2021-02-04 12:41:49,684[sg_generator.py:generate_graph:212]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id']}}
DEBUG 2021-02-04 12:41:49,686[sg_generator.py:generate_graph:229]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id'], 'edge_keys': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id'], 'edge_keys': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}}
DEBUG 2021-02-04 12:41:49,693[provenance_getter.py:gen_provenance_table:51][('admissions', 'insurance'), ('admissions', 'hospital_expire_flag')]
DEBUG 2021-02-04 12:41:49,804[provenance_getter.py:gen_provenance_table:56]b'WITH _temp_view_2 AS (\nSELECT /*+ materialize */ F0."hadm_id" AS "hadm_id", F0."admittime" AS "admittime", F0."dischtime" AS "dischtime", F0."deathtime" AS "deathtime", F0."admission_type" AS "admission_type", F0."admission_location" AS "admission_location", F0."discharge_location" AS "discharge_location", F0."insurance" AS "insurance", F0."marital_status" AS "marital_status", F0."edregtime" AS "edregtime", F0."edouttime" AS "edouttime", F0."diagnosis" AS "diagnosis", F0."hospital_expire_flag" AS "hospital_expire_flag", F0."has_chartevents_data" AS "has_chartevents_data", F0."hospital_stay_length" AS "hospital_stay_length", F0."hadm_id" AS "prov_admissions_hadm__id", F0."admittime" AS "prov_admissions_admittime", F0."dischtime" AS "prov_admissions_dischtime", F0."deathtime" AS "prov_admissions_deathtime", F0."admission_type" AS "prov_admissions_admission__type", F0."admission_location" AS "prov_admissions_admission__location", F0."discharge_location" AS "prov_admissions_discharge__location", F0."insurance" AS "prov_admissions_insurance", F0."marital_status" AS "prov_admissions_marital__status", F0."edregtime" AS "prov_admissions_edregtime", F0."edouttime" AS "prov_admissions_edouttime", F0."diagnosis" AS "prov_admissions_diagnosis", F0."hospital_expire_flag" AS "prov_admissions_hospital__expire__flag", F0."has_chartevents_data" AS "prov_admissions_has__chartevents__data", F0."hospital_stay_length" AS "prov_admissions_hospital__stay__length"\nFROM "admissions" AS F0),\n_temp_view_1 AS (\nSELECT /*+ materialize */ F0."hospital_expire_flag" AS "AGG_GB_ARG0", 1 AS "AGG_GB_ARG1", F0."insurance" AS "AGG_GB_ARG2", F0."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F0."prov_admissions_admittime" AS "prov_admissions_admittime", F0."prov_admissions_dischtime" AS "prov_admissions_dischtime", F0."prov_admissions_deathtime" AS "prov_admissions_deathtime", F0."prov_admissions_admission__type" AS "prov_admissions_admission__type", F0."prov_admissions_admission__location" AS "prov_admissions_admission__location", F0."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F0."prov_admissions_insurance" AS "prov_admissions_insurance", F0."prov_admissions_marital__status" AS "prov_admissions_marital__status", F0."prov_admissions_edregtime" AS "prov_admissions_edregtime", F0."prov_admissions_edouttime" AS "prov_admissions_edouttime", F0."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F0."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F0."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F0."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"\nFROM (SELECT * FROM _temp_view_2) F0),\n_temp_view_0 AS (\nSELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."AGGR_1" AS "AGGR_1", F0."GROUP_0" AS "GROUP_0", F1."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F1."prov_admissions_admittime" AS "prov_admissions_admittime", F1."prov_admissions_dischtime" AS "prov_admissions_dischtime", F1."prov_admissions_deathtime" AS "prov_admissions_deathtime", F1."prov_admissions_admission__type" AS "prov_admissions_admission__type", F1."prov_admissions_admission__location" AS "prov_admissions_admission__location", F1."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F1."prov_admissions_insurance" AS "prov_admissions_insurance", F1."prov_admissions_marital__status" AS "prov_admissions_marital__status", F1."prov_admissions_edregtime" AS "prov_admissions_edregtime", F1."prov_admissions_edouttime" AS "prov_admissions_edouttime", F1."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F1."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F1."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F1."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"\nFROM ((\nSELECT sum(F0."hospital_expire_flag") AS "AGGR_0", count(1) AS "AGGR_1", F0."insurance" AS "GROUP_0"\nFROM "admissions" AS F0\nGROUP BY F0."insurance") F0 JOIN (\nSELECT F0."AGG_GB_ARG2" AS "_P_SIDE_GROUP_0", F0."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F0."prov_admissions_admittime" AS "prov_admissions_admittime", F0."prov_admissions_dischtime" AS "prov_admissions_dischtime", F0."prov_admissions_deathtime" AS "prov_admissions_deathtime", F0."prov_admissions_admission__type" AS "prov_admissions_admission__type", F0."prov_admissions_admission__location" AS "prov_admissions_admission__location", F0."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F0."prov_admissions_insurance" AS "prov_admissions_insurance", F0."prov_admissions_marital__status" AS "prov_admissions_marital__status", F0."prov_admissions_edregtime" AS "prov_admissions_edregtime", F0."prov_admissions_edouttime" AS "prov_admissions_edouttime", F0."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F0."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F0."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F0."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"\nFROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))\nSELECT F0."GROUP_0" AS "insurance", ((1.000000 * F0."AGGR_0") / F0."AGGR_1") AS "death_rate", F0."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F0."prov_admissions_admittime" AS "prov_admissions_admittime", F0."prov_admissions_dischtime" AS "prov_admissions_dischtime", F0."prov_admissions_deathtime" AS "prov_admissions_deathtime", F0."prov_admissions_admission__type" AS "prov_admissions_admission__type", F0."prov_admissions_admission__location" AS "prov_admissions_admission__location", F0."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F0."prov_admissions_insurance" AS "prov_admissions_insurance", F0."prov_admissions_marital__status" AS "prov_admissions_marital__status", F0."prov_admissions_edregtime" AS "prov_admissions_edregtime", F0."prov_admissions_edouttime" AS "prov_admissions_edouttime", F0."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F0."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F0."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F0."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"\nFROM (SELECT * FROM _temp_view_0) F0;\n\n\n'
DEBUG 2021-02-04 12:41:49,805[provenance_getter.py:gen_provenance_table:62]gen_original_pt_query:
 WITH _temp_view_2 AS (
SELECT /*+ materialize */ F0."hadm_id" AS "hadm_id", F0."admittime" AS "admittime", F0."dischtime" AS "dischtime", F0."deathtime" AS "deathtime", F0."admission_type" AS "admission_type", F0."admission_location" AS "admission_location", F0."discharge_location" AS "discharge_location", F0."insurance" AS "insurance", F0."marital_status" AS "marital_status", F0."edregtime" AS "edregtime", F0."edouttime" AS "edouttime", F0."diagnosis" AS "diagnosis", F0."hospital_expire_flag" AS "hospital_expire_flag", F0."has_chartevents_data" AS "has_chartevents_data", F0."hospital_stay_length" AS "hospital_stay_length", F0."hadm_id" AS "prov_admissions_hadm__id", F0."admittime" AS "prov_admissions_admittime", F0."dischtime" AS "prov_admissions_dischtime", F0."deathtime" AS "prov_admissions_deathtime", F0."admission_type" AS "prov_admissions_admission__type", F0."admission_location" AS "prov_admissions_admission__location", F0."discharge_location" AS "prov_admissions_discharge__location", F0."insurance" AS "prov_admissions_insurance", F0."marital_status" AS "prov_admissions_marital__status", F0."edregtime" AS "prov_admissions_edregtime", F0."edouttime" AS "prov_admissions_edouttime", F0."diagnosis" AS "prov_admissions_diagnosis", F0."hospital_expire_flag" AS "prov_admissions_hospital__expire__flag", F0."has_chartevents_data" AS "prov_admissions_has__chartevents__data", F0."hospital_stay_length" AS "prov_admissions_hospital__stay__length"
FROM "admissions" AS F0),
_temp_view_1 AS (
SELECT /*+ materialize */ F0."hospital_expire_flag" AS "AGG_GB_ARG0", 1 AS "AGG_GB_ARG1", F0."insurance" AS "AGG_GB_ARG2", F0."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F0."prov_admissions_admittime" AS "prov_admissions_admittime", F0."prov_admissions_dischtime" AS "prov_admissions_dischtime", F0."prov_admissions_deathtime" AS "prov_admissions_deathtime", F0."prov_admissions_admission__type" AS "prov_admissions_admission__type", F0."prov_admissions_admission__location" AS "prov_admissions_admission__location", F0."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F0."prov_admissions_insurance" AS "prov_admissions_insurance", F0."prov_admissions_marital__status" AS "prov_admissions_marital__status", F0."prov_admissions_edregtime" AS "prov_admissions_edregtime", F0."prov_admissions_edouttime" AS "prov_admissions_edouttime", F0."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F0."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F0."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F0."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"
FROM (SELECT * FROM _temp_view_2) F0),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."AGGR_0" AS "AGGR_0", F0."AGGR_1" AS "AGGR_1", F0."GROUP_0" AS "GROUP_0", F1."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F1."prov_admissions_admittime" AS "prov_admissions_admittime", F1."prov_admissions_dischtime" AS "prov_admissions_dischtime", F1."prov_admissions_deathtime" AS "prov_admissions_deathtime", F1."prov_admissions_admission__type" AS "prov_admissions_admission__type", F1."prov_admissions_admission__location" AS "prov_admissions_admission__location", F1."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F1."prov_admissions_insurance" AS "prov_admissions_insurance", F1."prov_admissions_marital__status" AS "prov_admissions_marital__status", F1."prov_admissions_edregtime" AS "prov_admissions_edregtime", F1."prov_admissions_edouttime" AS "prov_admissions_edouttime", F1."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F1."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F1."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F1."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"
FROM ((
SELECT sum(F0."hospital_expire_flag") AS "AGGR_0", count(1) AS "AGGR_1", F0."insurance" AS "GROUP_0"
FROM "admissions" AS F0
GROUP BY F0."insurance") F0 JOIN (
SELECT F0."AGG_GB_ARG2" AS "_P_SIDE_GROUP_0", F0."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F0."prov_admissions_admittime" AS "prov_admissions_admittime", F0."prov_admissions_dischtime" AS "prov_admissions_dischtime", F0."prov_admissions_deathtime" AS "prov_admissions_deathtime", F0."prov_admissions_admission__type" AS "prov_admissions_admission__type", F0."prov_admissions_admission__location" AS "prov_admissions_admission__location", F0."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F0."prov_admissions_insurance" AS "prov_admissions_insurance", F0."prov_admissions_marital__status" AS "prov_admissions_marital__status", F0."prov_admissions_edregtime" AS "prov_admissions_edregtime", F0."prov_admissions_edouttime" AS "prov_admissions_edouttime", F0."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F0."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F0."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F0."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"
FROM (SELECT * FROM _temp_view_1) F0) F1 ON ((F0."GROUP_0" IS NOT DISTINCT FROM F1."_P_SIDE_GROUP_0"))))
SELECT F0."GROUP_0" AS "insurance", ((1.000000 * F0."AGGR_0") / F0."AGGR_1") AS "death_rate", F0."prov_admissions_hadm__id" AS "prov_admissions_hadm__id", F0."prov_admissions_admittime" AS "prov_admissions_admittime", F0."prov_admissions_dischtime" AS "prov_admissions_dischtime", F0."prov_admissions_deathtime" AS "prov_admissions_deathtime", F0."prov_admissions_admission__type" AS "prov_admissions_admission__type", F0."prov_admissions_admission__location" AS "prov_admissions_admission__location", F0."prov_admissions_discharge__location" AS "prov_admissions_discharge__location", F0."prov_admissions_insurance" AS "prov_admissions_insurance", F0."prov_admissions_marital__status" AS "prov_admissions_marital__status", F0."prov_admissions_edregtime" AS "prov_admissions_edregtime", F0."prov_admissions_edouttime" AS "prov_admissions_edouttime", F0."prov_admissions_diagnosis" AS "prov_admissions_diagnosis", F0."prov_admissions_hospital__expire__flag" AS "prov_admissions_hospital__expire__flag", F0."prov_admissions_has__chartevents__data" AS "prov_admissions_has__chartevents__data", F0."prov_admissions_hospital__stay__length" AS "prov_admissions_hospital__stay__length"
FROM (SELECT * FROM _temp_view_0) F0;



DEBUG 2021-02-04 12:41:53,296[provenance_getter.py:gen_provenance_table:103]{'insurance': None, 'death_rate': None, 'prov_admissions_hadm__id': None, 'prov_admissions_admittime': None, 'prov_admissions_dischtime': None, 'prov_admissions_deathtime': None, 'prov_admissions_admission__type': None, 'prov_admissions_admission__location': None, 'prov_admissions_discharge__location': None, 'prov_admissions_insurance': None, 'prov_admissions_marital__status': None, 'prov_admissions_edregtime': None, 'prov_admissions_edouttime': None, 'prov_admissions_diagnosis': None, 'prov_admissions_hospital__expire__flag': None, 'prov_admissions_has__chartevents__data': None, 'prov_admissions_hospital__stay__length': None}
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,297[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,298[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,299[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:118]self.db_dict[origin_rel]['p_key']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,300[provenance_getter.py:gen_provenance_table:119]self.db_dict[origin_rel]['keys']: ['hadm_id']
DEBUG 2021-02-04 12:41:53,301[provenance_getter.py:gen_provenance_table:120]origin_rel: admissions
DEBUG 2021-02-04 12:41:53,301[provenance_getter.py:gen_provenance_table:144]pt_dict:{'attributes': {'insurance:nominal': ('PT', 'insurance'), 'death_rate:nominal': ('PT', 'death_rate'), 'prov_admissions_hadm__id:ordinal': ('admissions', 'hadm_id'), 'prov_admissions_admittime:nominal': ('admissions', 'admittime'), 'prov_admissions_dischtime:nominal': ('admissions', 'dischtime'), 'prov_admissions_deathtime:nominal': ('admissions', 'deathtime'), 'prov_admissions_admission__type:nominal': ('admissions', 'admission_type'), 'prov_admissions_admission__location:nominal': ('admissions', 'admission_location'), 'prov_admissions_discharge__location:nominal': ('admissions', 'discharge_location'), 'prov_admissions_insurance:nominal': ('admissions', 'insurance'), 'prov_admissions_marital__status:nominal': ('admissions', 'marital_status'), 'prov_admissions_edregtime:nominal': ('admissions', 'edregtime'), 'prov_admissions_edouttime:nominal': ('admissions', 'edouttime'), 'prov_admissions_diagnosis:nominal': ('admissions', 'diagnosis'), 'prov_admissions_hospital__expire__flag:ordinal': ('admissions', 'hospital_expire_flag'), 'prov_admissions_has__chartevents__data:nominal': ('admissions', 'has_chartevents_data'), 'prov_admissions_hospital__stay__length:ordinal': ('admissions', 'hospital_stay_length')}, 'keys': ['prov_admissions_hadm__id'], 'user_attrs': ['prov_admissions_insurance', 'prov_admissions_hospital__expire__flag']}
DEBUG 2021-02-04 12:41:53,565[experiments.py:run_experiment:241]generate new valid_jgs
DEBUG 2021-02-04 12:41:53,601[jg_generator.py:Generate_JGs:339][jg_number: 1, materialize_cost:0, join_graph_details: , jg_number: 10, materialize_cost:0, join_graph_details: 1: PT, 2: patients_admit_info, cond: (PT.hadm_id)=(patients_admit_info.hadm_id) | 2: patients_admit_info, 3: patients, cond: (patients.subject_id)=(patients_admit_info.subject_id), jg_number: 15, materialize_cost:0, join_graph_details: 1: PT, 2: icustays, cond: (PT.hadm_id)=(icustays.hadm_id) | 2: icustays, 3: patients, cond: (patients.subject_id)=(icustays.subject_id), jg_number: 20, materialize_cost:0, join_graph_details: 1: PT, 2: diagnoses, cond: (PT.hadm_id)=(diagnoses.hadm_id) | 2: diagnoses, 3: patients, cond: (patients.subject_id)=(diagnoses.subject_id), jg_number: 25, materialize_cost:0, join_graph_details: 1: PT, 2: procedures, cond: (PT.hadm_id)=(procedures.hadm_id) | 2: procedures, 3: patients, cond: (patients.subject_id)=(procedures.subject_id)]
DEBUG 2021-02-04 12:41:53,604[jg_materializer.py:materialize_jg:276]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id'], 'edge_keys': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id'], 'edge_keys': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'PT': {'attributes': {'insurance:nominal': ('PT', 'insurance'), 'death_rate:nominal': ('PT', 'death_rate'), 'prov_admissions_hadm__id:ordinal': ('admissions', 'hadm_id'), 'prov_admissions_admittime:nominal': ('admissions', 'admittime'), 'prov_admissions_dischtime:nominal': ('admissions', 'dischtime'), 'prov_admissions_deathtime:nominal': ('admissions', 'deathtime'), 'prov_admissions_admission__type:nominal': ('admissions', 'admission_type'), 'prov_admissions_admission__location:nominal': ('admissions', 'admission_location'), 'prov_admissions_discharge__location:nominal': ('admissions', 'discharge_location'), 'prov_admissions_insurance:nominal': ('admissions', 'insurance'), 'prov_admissions_marital__status:nominal': ('admissions', 'marital_status'), 'prov_admissions_edregtime:nominal': ('admissions', 'edregtime'), 'prov_admissions_edouttime:nominal': ('admissions', 'edouttime'), 'prov_admissions_diagnosis:nominal': ('admissions', 'diagnosis'), 'prov_admissions_hospital__expire__flag:ordinal': ('admissions', 'hospital_expire_flag'), 'prov_admissions_has__chartevents__data:nominal': ('admissions', 'has_chartevents_data'), 'prov_admissions_hospital__stay__length:ordinal': ('admissions', 'hospital_stay_length'), 'pnumber:nominal': ('PT', 'pnumber'), 'is_user:nominal': ('PT', 'is_user')}, 'keys': ['prov_admissions_hadm__id'], 'user_attrs': ['prov_admissions_insurance', 'prov_admissions_hospital__expire__flag']}}
DEBUG 2021-02-04 12:41:53,604[jg_materializer.py:non_redundant_check:185]{'max_rel_index': 2, 'max_attr_index': 15, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}}
DEBUG 2021-02-04 12:41:53,719[jg_materializer.py:gen_ec:115]provenance of (select insurance, 1.0*SUM(hospital_expire_flag)/count(*) as death_rate from admissions group by insurance);
DEBUG 2021-02-04 12:41:53,720[jg_materializer.py:gen_ec:120]['{insurance}', '{prov_admissions_hadm__id}', '{prov_admissions_admittime}', '{prov_admissions_dischtime}', '{prov_admissions_deathtime}', '{prov_admissions_admission__type}', '{prov_admissions_admission__location}', '{prov_admissions_discharge__location}', '{prov_admissions_insurance}', '{prov_admissions_marital__status}', '{prov_admissions_edregtime}', '{prov_admissions_edouttime}', '{prov_admissions_diagnosis}', '{prov_admissions_hospital__expire__flag}', '{prov_admissions_has__chartevents__data}', '{prov_admissions_hospital__stay__length}', '{death_rate}']
DEBUG 2021-02-04 12:41:53,720[jg_materializer.py:non_redundant_check:194][['insurance'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['death_rate']]
DEBUG 2021-02-04 12:41:53,834[jg_materializer.py:gen_ec:115]SELECT A_1."insurance" AS insurance, A_1."death_rate" AS death_rate, A_1."prov_admissions_hadm__id" AS a_1, A_1."prov_admissions_admittime" AS a_2, A_1."prov_admissions_dischtime" AS a_3, A_1."prov_admissions_deathtime" AS a_4, A_1."prov_admissions_admission__type" AS a_5, A_1."prov_admissions_admission__location" AS a_6, A_1."prov_admissions_discharge__location" AS a_7, A_1."prov_admissions_insurance" AS a_8, A_1."prov_admissions_marital__status" AS a_9, A_1."prov_admissions_edregtime" AS a_10, A_1."prov_admissions_edouttime" AS a_11, A_1."prov_admissions_diagnosis" AS a_12, A_1."prov_admissions_hospital__expire__flag" AS a_13, A_1."prov_admissions_has__chartevents__data" AS a_14, A_1."prov_admissions_hospital__stay__length" AS a_15, A_1."pnumber" AS pnumber, A_1."is_user" AS is_user 
 FROM PT AS A_1;

DEBUG 2021-02-04 12:41:53,835[jg_materializer.py:gen_ec:120]['{insurance}', '{death_rate}', '{a_1}', '{a_2}', '{a_3}', '{a_4}', '{a_5}', '{a_6}', '{a_7}', '{a_8}', '{a_9}', '{a_10}', '{a_11}', '{a_12}', '{a_13}', '{a_14}', '{a_15}', '{pnumber}', '{is_user}']
DEBUG 2021-02-04 12:41:53,835[jg_materializer.py:non_redundant_check:199][['insurance'], ['death_rate'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user']]
DEBUG 2021-02-04 12:41:53,835[jg_materializer.py:modifiy_jg_ec:170][['insurance'], ['death_rate'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user']]
DEBUG 2021-02-04 12:41:53,836[jg_materializer.py:materialize_jg:276]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id'], 'edge_keys': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id'], 'edge_keys': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'PT': {'attributes': {'insurance:nominal': ('PT', 'insurance'), 'death_rate:nominal': ('PT', 'death_rate'), 'prov_admissions_hadm__id:ordinal': ('admissions', 'hadm_id'), 'prov_admissions_admittime:nominal': ('admissions', 'admittime'), 'prov_admissions_dischtime:nominal': ('admissions', 'dischtime'), 'prov_admissions_deathtime:nominal': ('admissions', 'deathtime'), 'prov_admissions_admission__type:nominal': ('admissions', 'admission_type'), 'prov_admissions_admission__location:nominal': ('admissions', 'admission_location'), 'prov_admissions_discharge__location:nominal': ('admissions', 'discharge_location'), 'prov_admissions_insurance:nominal': ('admissions', 'insurance'), 'prov_admissions_marital__status:nominal': ('admissions', 'marital_status'), 'prov_admissions_edregtime:nominal': ('admissions', 'edregtime'), 'prov_admissions_edouttime:nominal': ('admissions', 'edouttime'), 'prov_admissions_diagnosis:nominal': ('admissions', 'diagnosis'), 'prov_admissions_hospital__expire__flag:ordinal': ('admissions', 'hospital_expire_flag'), 'prov_admissions_has__chartevents__data:nominal': ('admissions', 'has_chartevents_data'), 'prov_admissions_hospital__stay__length:ordinal': ('admissions', 'hospital_stay_length'), 'pnumber:nominal': ('PT', 'pnumber'), 'is_user:nominal': ('PT', 'is_user')}, 'keys': ['prov_admissions_hadm__id'], 'user_attrs': ['prov_admissions_insurance', 'prov_admissions_hospital__expire__flag']}}
DEBUG 2021-02-04 12:41:53,837[jg_materializer.py:non_redundant_check:185]{'max_rel_index': 4, 'max_attr_index': 28, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'ordinal', 'a_17': 'nominal', 'a_18': 'nominal', 'a_19': 'nominal', 'a_20': 'ordinal', 'a_21': 'ordinal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'nominal', 'a_26': 'ordinal', 'a_27': 'nominal', 'a_28': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'patients_admit_info', 'columns': {'a_16': 'subject_id', 'a_17': 'ethnicity', 'a_18': 'religion', 'a_19': 'language', 'a_20': 'age', 'a_21': 'hadm_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 21}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_22': 'dod_ssn', 'a_23': 'dod_hosp', 'a_24': 'dod', 'a_25': 'dob', 'a_26': 'subject_id', 'a_27': 'gender', 'a_28': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 21, 'rel_max_attr_index': 28}}
DEBUG 2021-02-04 12:41:53,837[jg_materializer.py:non_redundant_check:194][['insurance'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['death_rate']]
DEBUG 2021-02-04 12:41:53,951[jg_materializer.py:gen_ec:115]SELECT A_1."insurance" AS insurance, A_1."death_rate" AS death_rate, A_1."prov_admissions_hadm__id" AS a_1, A_1."prov_admissions_admittime" AS a_2, A_1."prov_admissions_dischtime" AS a_3, A_1."prov_admissions_deathtime" AS a_4, A_1."prov_admissions_admission__type" AS a_5, A_1."prov_admissions_admission__location" AS a_6, A_1."prov_admissions_discharge__location" AS a_7, A_1."prov_admissions_insurance" AS a_8, A_1."prov_admissions_marital__status" AS a_9, A_1."prov_admissions_edregtime" AS a_10, A_1."prov_admissions_edouttime" AS a_11, A_1."prov_admissions_diagnosis" AS a_12, A_1."prov_admissions_hospital__expire__flag" AS a_13, A_1."prov_admissions_has__chartevents__data" AS a_14, A_1."prov_admissions_hospital__stay__length" AS a_15, A_1."pnumber" AS pnumber, A_1."is_user" AS is_user, A_2.subject_id AS a_16, A_2.ethnicity AS a_17, A_2.religion AS a_18, A_2.language AS a_19, A_2.age AS a_20, A_2.hadm_id AS a_21, A_3.dod_ssn AS a_22, A_3.dod_hosp AS a_23, A_3.dod AS a_24, A_3.dob AS a_25, A_3.subject_id AS a_26, A_3.gender AS a_27, A_3.expire_flag AS a_28 
 FROM PT AS A_1, patients_admit_info AS A_2, patients AS A_3 
 WHERE (A_1."prov_admissions_hadm__id")=(A_2.hadm_id) AND (A_3.subject_id)=(A_2.subject_id); 

DEBUG 2021-02-04 12:41:53,952[jg_materializer.py:gen_ec:120]['{insurance}', '{death_rate}', '{a_1 a_21}', '{a_2}', '{a_3}', '{a_4}', '{a_5}', '{a_6}', '{a_7}', '{a_8}', '{a_9}', '{a_10}', '{a_11}', '{a_12}', '{a_13}', '{a_14}', '{a_15}', '{pnumber}', '{is_user}', '{a_16 a_26}', '{a_20}', '{a_19}', '{a_18}', '{a_17}', '{a_27}', '{a_25}', '{a_24}', '{a_23}', '{a_22}', '{a_28}']
DEBUG 2021-02-04 12:41:53,952[jg_materializer.py:non_redundant_check:199][['insurance'], ['death_rate'], ['a_1', 'a_21'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_16', 'a_26'], ['a_20'], ['a_19'], ['a_18'], ['a_17'], ['a_27'], ['a_25'], ['a_24'], ['a_23'], ['a_22'], ['a_28']]
DEBUG 2021-02-04 12:41:53,953[jg_materializer.py:modifiy_jg_ec:170][['insurance'], ['death_rate'], ['a_21', 'a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_26', 'a_16'], ['a_20'], ['a_19'], ['a_18'], ['a_17'], ['a_27'], ['a_25'], ['a_24'], ['a_23'], ['a_22'], ['a_28']]
DEBUG 2021-02-04 12:41:53,979[jg_materializer.py:non_redundant_check:242]^^^^^^^final ec_df^^^^^^^^
DEBUG 2021-02-04 12:41:53,979[jg_materializer.py:non_redundant_check:243]Empty DataFrame
Columns: [table_identity, table, original_attr_name]
Index: []
DEBUG 2021-02-04 12:41:53,982[jg_materializer.py:materialize_jg:276]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id'], 'edge_keys': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id'], 'edge_keys': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'PT': {'attributes': {'insurance:nominal': ('PT', 'insurance'), 'death_rate:nominal': ('PT', 'death_rate'), 'prov_admissions_hadm__id:ordinal': ('admissions', 'hadm_id'), 'prov_admissions_admittime:nominal': ('admissions', 'admittime'), 'prov_admissions_dischtime:nominal': ('admissions', 'dischtime'), 'prov_admissions_deathtime:nominal': ('admissions', 'deathtime'), 'prov_admissions_admission__type:nominal': ('admissions', 'admission_type'), 'prov_admissions_admission__location:nominal': ('admissions', 'admission_location'), 'prov_admissions_discharge__location:nominal': ('admissions', 'discharge_location'), 'prov_admissions_insurance:nominal': ('admissions', 'insurance'), 'prov_admissions_marital__status:nominal': ('admissions', 'marital_status'), 'prov_admissions_edregtime:nominal': ('admissions', 'edregtime'), 'prov_admissions_edouttime:nominal': ('admissions', 'edouttime'), 'prov_admissions_diagnosis:nominal': ('admissions', 'diagnosis'), 'prov_admissions_hospital__expire__flag:ordinal': ('admissions', 'hospital_expire_flag'), 'prov_admissions_has__chartevents__data:nominal': ('admissions', 'has_chartevents_data'), 'prov_admissions_hospital__stay__length:ordinal': ('admissions', 'hospital_stay_length'), 'pnumber:nominal': ('PT', 'pnumber'), 'is_user:nominal': ('PT', 'is_user')}, 'keys': ['prov_admissions_hadm__id'], 'user_attrs': ['prov_admissions_insurance', 'prov_admissions_hospital__expire__flag']}}
DEBUG 2021-02-04 12:41:53,982[jg_materializer.py:non_redundant_check:185]{'max_rel_index': 4, 'max_attr_index': 34, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'ordinal', 'a_17': 'ordinal', 'a_18': 'ordinal', 'a_19': 'ordinal', 'a_20': 'nominal', 'a_21': 'nominal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'nominal', 'a_26': 'nominal', 'a_27': 'nominal', 'a_28': 'nominal', 'a_29': 'nominal', 'a_30': 'nominal', 'a_31': 'nominal', 'a_32': 'ordinal', 'a_33': 'nominal', 'a_34': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'icustays', 'columns': {'a_16': 'los', 'a_17': 'subject_id', 'a_18': 'hadm_id', 'a_19': 'icustay_id', 'a_20': 'dbsource', 'a_21': 'first_careunit', 'a_22': 'last_careunit', 'a_23': 'first_wardid', 'a_24': 'last_wardid', 'a_25': 'intime', 'a_26': 'outtime', 'a_27': 'los_group'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 27}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_28': 'dod_ssn', 'a_29': 'dod_hosp', 'a_30': 'dod', 'a_31': 'dob', 'a_32': 'subject_id', 'a_33': 'gender', 'a_34': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 27, 'rel_max_attr_index': 34}}
DEBUG 2021-02-04 12:41:53,983[jg_materializer.py:non_redundant_check:194][['insurance'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['death_rate']]
DEBUG 2021-02-04 12:41:54,097[jg_materializer.py:gen_ec:115]SELECT A_1."insurance" AS insurance, A_1."death_rate" AS death_rate, A_1."prov_admissions_hadm__id" AS a_1, A_1."prov_admissions_admittime" AS a_2, A_1."prov_admissions_dischtime" AS a_3, A_1."prov_admissions_deathtime" AS a_4, A_1."prov_admissions_admission__type" AS a_5, A_1."prov_admissions_admission__location" AS a_6, A_1."prov_admissions_discharge__location" AS a_7, A_1."prov_admissions_insurance" AS a_8, A_1."prov_admissions_marital__status" AS a_9, A_1."prov_admissions_edregtime" AS a_10, A_1."prov_admissions_edouttime" AS a_11, A_1."prov_admissions_diagnosis" AS a_12, A_1."prov_admissions_hospital__expire__flag" AS a_13, A_1."prov_admissions_has__chartevents__data" AS a_14, A_1."prov_admissions_hospital__stay__length" AS a_15, A_1."pnumber" AS pnumber, A_1."is_user" AS is_user, A_2.los AS a_16, A_2.subject_id AS a_17, A_2.hadm_id AS a_18, A_2.icustay_id AS a_19, A_2.dbsource AS a_20, A_2.first_careunit AS a_21, A_2.last_careunit AS a_22, A_2.first_wardid AS a_23, A_2.last_wardid AS a_24, A_2.intime AS a_25, A_2.outtime AS a_26, A_2.los_group AS a_27, A_3.dod_ssn AS a_28, A_3.dod_hosp AS a_29, A_3.dod AS a_30, A_3.dob AS a_31, A_3.subject_id AS a_32, A_3.gender AS a_33, A_3.expire_flag AS a_34 
 FROM PT AS A_1, icustays AS A_2, patients AS A_3 
 WHERE (A_1."prov_admissions_hadm__id")=(A_2.hadm_id) AND (A_3.subject_id)=(A_2.subject_id); 

DEBUG 2021-02-04 12:41:54,098[jg_materializer.py:gen_ec:120]['{insurance}', '{death_rate}', '{a_1 a_18}', '{a_2}', '{a_3}', '{a_4}', '{a_5}', '{a_6}', '{a_7}', '{a_8}', '{a_9}', '{a_10}', '{a_11}', '{a_12}', '{a_13}', '{a_14}', '{a_15}', '{pnumber}', '{is_user}', '{a_17 a_32}', '{a_19}', '{a_20}', '{a_21}', '{a_22}', '{a_23}', '{a_24}', '{a_25}', '{a_26}', '{a_16}', '{a_27}', '{a_33}', '{a_31}', '{a_30}', '{a_29}', '{a_28}', '{a_34}']
DEBUG 2021-02-04 12:41:54,098[jg_materializer.py:non_redundant_check:199][['insurance'], ['death_rate'], ['a_1', 'a_18'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_17', 'a_32'], ['a_19'], ['a_20'], ['a_21'], ['a_22'], ['a_23'], ['a_24'], ['a_25'], ['a_26'], ['a_16'], ['a_27'], ['a_33'], ['a_31'], ['a_30'], ['a_29'], ['a_28'], ['a_34']]
DEBUG 2021-02-04 12:41:54,099[jg_materializer.py:modifiy_jg_ec:170][['insurance'], ['death_rate'], ['a_18', 'a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_32', 'a_17'], ['a_19'], ['a_20'], ['a_21'], ['a_22'], ['a_23'], ['a_24'], ['a_25'], ['a_26'], ['a_16'], ['a_27'], ['a_33'], ['a_31'], ['a_30'], ['a_29'], ['a_28'], ['a_34']]
DEBUG 2021-02-04 12:41:54,123[jg_materializer.py:non_redundant_check:242]^^^^^^^final ec_df^^^^^^^^
DEBUG 2021-02-04 12:41:54,123[jg_materializer.py:non_redundant_check:243]Empty DataFrame
Columns: [table_identity, table, original_attr_name]
Index: []
DEBUG 2021-02-04 12:41:54,125[jg_materializer.py:materialize_jg:276]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id'], 'edge_keys': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id'], 'edge_keys': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'PT': {'attributes': {'insurance:nominal': ('PT', 'insurance'), 'death_rate:nominal': ('PT', 'death_rate'), 'prov_admissions_hadm__id:ordinal': ('admissions', 'hadm_id'), 'prov_admissions_admittime:nominal': ('admissions', 'admittime'), 'prov_admissions_dischtime:nominal': ('admissions', 'dischtime'), 'prov_admissions_deathtime:nominal': ('admissions', 'deathtime'), 'prov_admissions_admission__type:nominal': ('admissions', 'admission_type'), 'prov_admissions_admission__location:nominal': ('admissions', 'admission_location'), 'prov_admissions_discharge__location:nominal': ('admissions', 'discharge_location'), 'prov_admissions_insurance:nominal': ('admissions', 'insurance'), 'prov_admissions_marital__status:nominal': ('admissions', 'marital_status'), 'prov_admissions_edregtime:nominal': ('admissions', 'edregtime'), 'prov_admissions_edouttime:nominal': ('admissions', 'edouttime'), 'prov_admissions_diagnosis:nominal': ('admissions', 'diagnosis'), 'prov_admissions_hospital__expire__flag:ordinal': ('admissions', 'hospital_expire_flag'), 'prov_admissions_has__chartevents__data:nominal': ('admissions', 'has_chartevents_data'), 'prov_admissions_hospital__stay__length:ordinal': ('admissions', 'hospital_stay_length'), 'pnumber:nominal': ('PT', 'pnumber'), 'is_user:nominal': ('PT', 'is_user')}, 'keys': ['prov_admissions_hadm__id'], 'user_attrs': ['prov_admissions_insurance', 'prov_admissions_hospital__expire__flag']}}
DEBUG 2021-02-04 12:41:54,126[jg_materializer.py:non_redundant_check:185]{'max_rel_index': 4, 'max_attr_index': 27, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'ordinal', 'a_17': 'nominal', 'a_18': 'nominal', 'a_19': 'ordinal', 'a_20': 'ordinal', 'a_21': 'nominal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'ordinal', 'a_26': 'nominal', 'a_27': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'diagnoses', 'columns': {'a_16': 'hadm_id', 'a_17': 'icd9_code', 'a_18': 'chapter', 'a_19': 'subject_id', 'a_20': 'seq_num'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 20}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_21': 'dod_ssn', 'a_22': 'dod_hosp', 'a_23': 'dod', 'a_24': 'dob', 'a_25': 'subject_id', 'a_26': 'gender', 'a_27': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 20, 'rel_max_attr_index': 27}}
DEBUG 2021-02-04 12:41:54,126[jg_materializer.py:non_redundant_check:194][['insurance'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['death_rate']]
DEBUG 2021-02-04 12:41:54,241[jg_materializer.py:gen_ec:115]SELECT A_1."insurance" AS insurance, A_1."death_rate" AS death_rate, A_1."prov_admissions_hadm__id" AS a_1, A_1."prov_admissions_admittime" AS a_2, A_1."prov_admissions_dischtime" AS a_3, A_1."prov_admissions_deathtime" AS a_4, A_1."prov_admissions_admission__type" AS a_5, A_1."prov_admissions_admission__location" AS a_6, A_1."prov_admissions_discharge__location" AS a_7, A_1."prov_admissions_insurance" AS a_8, A_1."prov_admissions_marital__status" AS a_9, A_1."prov_admissions_edregtime" AS a_10, A_1."prov_admissions_edouttime" AS a_11, A_1."prov_admissions_diagnosis" AS a_12, A_1."prov_admissions_hospital__expire__flag" AS a_13, A_1."prov_admissions_has__chartevents__data" AS a_14, A_1."prov_admissions_hospital__stay__length" AS a_15, A_1."pnumber" AS pnumber, A_1."is_user" AS is_user, A_2.hadm_id AS a_16, A_2.icd9_code AS a_17, A_2.chapter AS a_18, A_2.subject_id AS a_19, A_2.seq_num AS a_20, A_3.dod_ssn AS a_21, A_3.dod_hosp AS a_22, A_3.dod AS a_23, A_3.dob AS a_24, A_3.subject_id AS a_25, A_3.gender AS a_26, A_3.expire_flag AS a_27 
 FROM PT AS A_1, diagnoses AS A_2, patients AS A_3 
 WHERE (A_1."prov_admissions_hadm__id")=(A_2.hadm_id) AND (A_3.subject_id)=(A_2.subject_id); 

DEBUG 2021-02-04 12:41:54,242[jg_materializer.py:gen_ec:120]['{insurance}', '{death_rate}', '{a_1 a_16}', '{a_2}', '{a_3}', '{a_4}', '{a_5}', '{a_6}', '{a_7}', '{a_8}', '{a_9}', '{a_10}', '{a_11}', '{a_12}', '{a_13}', '{a_14}', '{a_15}', '{pnumber}', '{is_user}', '{a_19 a_25}', '{a_20}', '{a_17}', '{a_18}', '{a_26}', '{a_24}', '{a_23}', '{a_22}', '{a_21}', '{a_27}']
DEBUG 2021-02-04 12:41:54,242[jg_materializer.py:non_redundant_check:199][['insurance'], ['death_rate'], ['a_1', 'a_16'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_19', 'a_25'], ['a_20'], ['a_17'], ['a_18'], ['a_26'], ['a_24'], ['a_23'], ['a_22'], ['a_21'], ['a_27']]
DEBUG 2021-02-04 12:41:54,243[jg_materializer.py:modifiy_jg_ec:170][['insurance'], ['death_rate'], ['a_1', 'a_16'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_25', 'a_19'], ['a_20'], ['a_17'], ['a_18'], ['a_26'], ['a_24'], ['a_23'], ['a_22'], ['a_21'], ['a_27']]
DEBUG 2021-02-04 12:41:54,267[jg_materializer.py:non_redundant_check:242]^^^^^^^final ec_df^^^^^^^^
DEBUG 2021-02-04 12:41:54,267[jg_materializer.py:non_redundant_check:243]Empty DataFrame
Columns: [table_identity, table, original_attr_name]
Index: []
DEBUG 2021-02-04 12:41:54,269[jg_materializer.py:materialize_jg:276]{'admissions': {'attributes': [('edouttime', 'nominal'), ('edregtime', 'nominal'), ('hospital_stay_length', 'ordinal'), ('hadm_id', 'ordinal'), ('admittime', 'nominal'), ('dischtime', 'nominal'), ('deathtime', 'nominal'), ('admission_type', 'nominal'), ('admission_location', 'nominal'), ('discharge_location', 'nominal'), ('insurance', 'nominal'), ('marital_status', 'nominal'), ('has_chartevents_data', 'nominal'), ('hospital_expire_flag', 'ordinal'), ('diagnosis', 'nominal')], 'keys': ['hadm_id'], 'p_key': ['hadm_id'], 'edge_keys': ['hadm_id']}, 'diagnoses': {'attributes': [('hadm_id', 'ordinal'), ('icd9_code', 'nominal'), ('chapter', 'nominal'), ('subject_id', 'ordinal'), ('seq_num', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'icustays': {'attributes': [('los', 'ordinal'), ('subject_id', 'ordinal'), ('hadm_id', 'ordinal'), ('icustay_id', 'ordinal'), ('dbsource', 'nominal'), ('first_careunit', 'nominal'), ('last_careunit', 'nominal'), ('first_wardid', 'nominal'), ('last_wardid', 'nominal'), ('intime', 'nominal'), ('outtime', 'nominal'), ('los_group', 'nominal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'icustay_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'patients': {'attributes': [('dod_ssn', 'nominal'), ('dod_hosp', 'nominal'), ('dod', 'nominal'), ('dob', 'nominal'), ('subject_id', 'ordinal'), ('gender', 'nominal'), ('expire_flag', 'nominal')], 'keys': ['subject_id'], 'p_key': ['subject_id'], 'edge_keys': ['subject_id']}, 'patients_admit_info': {'attributes': [('subject_id', 'ordinal'), ('ethnicity', 'nominal'), ('religion', 'nominal'), ('language', 'nominal'), ('age', 'ordinal'), ('hadm_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'procedures': {'attributes': [('chapter', 'nominal'), ('icd9_code', 'nominal'), ('seq_num', 'ordinal'), ('hadm_id', 'ordinal'), ('subject_id', 'ordinal')], 'keys': ['hadm_id', 'subject_id'], 'p_key': ['hadm_id', 'seq_num', 'subject_id'], 'edge_keys': ['hadm_id', 'subject_id']}, 'PT': {'attributes': {'insurance:nominal': ('PT', 'insurance'), 'death_rate:nominal': ('PT', 'death_rate'), 'prov_admissions_hadm__id:ordinal': ('admissions', 'hadm_id'), 'prov_admissions_admittime:nominal': ('admissions', 'admittime'), 'prov_admissions_dischtime:nominal': ('admissions', 'dischtime'), 'prov_admissions_deathtime:nominal': ('admissions', 'deathtime'), 'prov_admissions_admission__type:nominal': ('admissions', 'admission_type'), 'prov_admissions_admission__location:nominal': ('admissions', 'admission_location'), 'prov_admissions_discharge__location:nominal': ('admissions', 'discharge_location'), 'prov_admissions_insurance:nominal': ('admissions', 'insurance'), 'prov_admissions_marital__status:nominal': ('admissions', 'marital_status'), 'prov_admissions_edregtime:nominal': ('admissions', 'edregtime'), 'prov_admissions_edouttime:nominal': ('admissions', 'edouttime'), 'prov_admissions_diagnosis:nominal': ('admissions', 'diagnosis'), 'prov_admissions_hospital__expire__flag:ordinal': ('admissions', 'hospital_expire_flag'), 'prov_admissions_has__chartevents__data:nominal': ('admissions', 'has_chartevents_data'), 'prov_admissions_hospital__stay__length:ordinal': ('admissions', 'hospital_stay_length'), 'pnumber:nominal': ('PT', 'pnumber'), 'is_user:nominal': ('PT', 'is_user')}, 'keys': ['prov_admissions_hadm__id'], 'user_attrs': ['prov_admissions_insurance', 'prov_admissions_hospital__expire__flag']}}
DEBUG 2021-02-04 12:41:54,269[jg_materializer.py:non_redundant_check:185]{'max_rel_index': 4, 'max_attr_index': 27, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'nominal', 'a_17': 'nominal', 'a_18': 'ordinal', 'a_19': 'ordinal', 'a_20': 'ordinal', 'a_21': 'nominal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'ordinal', 'a_26': 'nominal', 'a_27': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'procedures', 'columns': {'a_16': 'chapter', 'a_17': 'icd9_code', 'a_18': 'seq_num', 'a_19': 'hadm_id', 'a_20': 'subject_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 20}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_21': 'dod_ssn', 'a_22': 'dod_hosp', 'a_23': 'dod', 'a_24': 'dob', 'a_25': 'subject_id', 'a_26': 'gender', 'a_27': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 20, 'rel_max_attr_index': 27}}
DEBUG 2021-02-04 12:41:54,269[jg_materializer.py:non_redundant_check:194][['insurance'], ['a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['death_rate']]
DEBUG 2021-02-04 12:41:54,384[jg_materializer.py:gen_ec:115]SELECT A_1."insurance" AS insurance, A_1."death_rate" AS death_rate, A_1."prov_admissions_hadm__id" AS a_1, A_1."prov_admissions_admittime" AS a_2, A_1."prov_admissions_dischtime" AS a_3, A_1."prov_admissions_deathtime" AS a_4, A_1."prov_admissions_admission__type" AS a_5, A_1."prov_admissions_admission__location" AS a_6, A_1."prov_admissions_discharge__location" AS a_7, A_1."prov_admissions_insurance" AS a_8, A_1."prov_admissions_marital__status" AS a_9, A_1."prov_admissions_edregtime" AS a_10, A_1."prov_admissions_edouttime" AS a_11, A_1."prov_admissions_diagnosis" AS a_12, A_1."prov_admissions_hospital__expire__flag" AS a_13, A_1."prov_admissions_has__chartevents__data" AS a_14, A_1."prov_admissions_hospital__stay__length" AS a_15, A_1."pnumber" AS pnumber, A_1."is_user" AS is_user, A_2.chapter AS a_16, A_2.icd9_code AS a_17, A_2.seq_num AS a_18, A_2.hadm_id AS a_19, A_2.subject_id AS a_20, A_3.dod_ssn AS a_21, A_3.dod_hosp AS a_22, A_3.dod AS a_23, A_3.dob AS a_24, A_3.subject_id AS a_25, A_3.gender AS a_26, A_3.expire_flag AS a_27 
 FROM PT AS A_1, procedures AS A_2, patients AS A_3 
 WHERE (A_1."prov_admissions_hadm__id")=(A_2.hadm_id) AND (A_3.subject_id)=(A_2.subject_id); 

DEBUG 2021-02-04 12:41:54,384[jg_materializer.py:gen_ec:120]['{insurance}', '{death_rate}', '{a_1 a_19}', '{a_2}', '{a_3}', '{a_4}', '{a_5}', '{a_6}', '{a_7}', '{a_8}', '{a_9}', '{a_10}', '{a_11}', '{a_12}', '{a_13}', '{a_14}', '{a_15}', '{pnumber}', '{is_user}', '{a_20 a_25}', '{a_18}', '{a_17}', '{a_16}', '{a_26}', '{a_24}', '{a_23}', '{a_22}', '{a_21}', '{a_27}']
DEBUG 2021-02-04 12:41:54,384[jg_materializer.py:non_redundant_check:199][['insurance'], ['death_rate'], ['a_1', 'a_19'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_20', 'a_25'], ['a_18'], ['a_17'], ['a_16'], ['a_26'], ['a_24'], ['a_23'], ['a_22'], ['a_21'], ['a_27']]
DEBUG 2021-02-04 12:41:54,385[jg_materializer.py:modifiy_jg_ec:170][['insurance'], ['death_rate'], ['a_19', 'a_1'], ['a_2'], ['a_3'], ['a_4'], ['a_5'], ['a_6'], ['a_7'], ['a_8'], ['a_9'], ['a_10'], ['a_11'], ['a_12'], ['a_13'], ['a_14'], ['a_15'], ['pnumber'], ['is_user'], ['a_25', 'a_20'], ['a_18'], ['a_17'], ['a_16'], ['a_26'], ['a_24'], ['a_23'], ['a_22'], ['a_21'], ['a_27']]
DEBUG 2021-02-04 12:41:54,410[jg_materializer.py:non_redundant_check:242]^^^^^^^final ec_df^^^^^^^^
DEBUG 2021-02-04 12:41:54,410[jg_materializer.py:non_redundant_check:243]Empty DataFrame
Columns: [table_identity, table, original_attr_name]
Index: []
DEBUG 2021-02-04 12:41:54,411[experiments.py:run_experiment:268]we found 5 valid join graphs, now materializing and generating patterns
DEBUG 2021-02-04 12:41:54,412[experiments.py:run_experiment:272]we are on join graph number 1
DEBUG 2021-02-04 12:41:54,412[experiments.py:run_experiment:274]'medicare vs private'
DEBUG 2021-02-04 12:41:54,558[pattern_generator.py:gen_patterns:595]jg_apt_size : 50797
DEBUG 2021-02-04 12:41:54,841[pattern_generator.py:gen_patterns:631]{'sample': {'yes': 22582, 'no': 28215}}
DEBUG 2021-02-04 12:41:54,891[pattern_generator.py:gen_patterns:697]{'max_rel_index': 2, 'max_attr_index': 15, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}}
DEBUG 2021-02-04 12:41:54,891[pattern_generator.py:gen_patterns:698]{'a_14', 'a_9', 'death_rate', 'insurance', 'a_10', 'a_15', 'is_user', 'a_5', 'a_11', 'a_13', 'a_1', 'a_7', 'pnumber', 'a_2', 'a_3', 'a_8', 'a_6', 'a_4', 'a_12'}
DEBUG 2021-02-04 12:41:54,892[pattern_generator.py:gen_patterns:734]max_sample_factor*original_pt_size: 117952
DEBUG 2021-02-04 12:41:54,893[pattern_generator.py:gen_patterns:735]math.ceil(user_p_size*s_rate_for_s) : 1130
DEBUG 2021-02-04 12:41:54,893[pattern_generator.py:gen_patterns:742]500
DEBUG 2021-02-04 12:41:57,228[pattern_generator.py:gen_patterns:981]   a_15
0  15.0
1  15.0
2  24.0
3   1.0
4   5.0
DEBUG 2021-02-04 12:41:59,765[pattern_generator.py:gen_patterns:990][['a_15', 1.0]]
DEBUG 2021-02-04 12:42:11,717[experiments.py:run_experiment:272]we are on join graph number 2
DEBUG 2021-02-04 12:42:11,717[experiments.py:run_experiment:274]'medicare vs private'
DEBUG 2021-02-04 12:42:12,054[pattern_generator.py:gen_patterns:595]jg_apt_size : 50797
DEBUG 2021-02-04 12:42:12,433[pattern_generator.py:gen_patterns:631]{'sample': {'yes': 22582, 'no': 28215}}
DEBUG 2021-02-04 12:42:12,492[pattern_generator.py:gen_patterns:697]{'max_rel_index': 4, 'max_attr_index': 28, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'ordinal', 'a_17': 'nominal', 'a_18': 'nominal', 'a_19': 'nominal', 'a_20': 'ordinal', 'a_21': 'ordinal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'nominal', 'a_26': 'ordinal', 'a_27': 'nominal', 'a_28': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'patients_admit_info', 'columns': {'a_16': 'subject_id', 'a_17': 'ethnicity', 'a_18': 'religion', 'a_19': 'language', 'a_20': 'age', 'a_21': 'hadm_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 21}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_22': 'dod_ssn', 'a_23': 'dod_hosp', 'a_24': 'dod', 'a_25': 'dob', 'a_26': 'subject_id', 'a_27': 'gender', 'a_28': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 21, 'rel_max_attr_index': 28}}
DEBUG 2021-02-04 12:42:12,492[pattern_generator.py:gen_patterns:698]{'a_28', 'a_23', 'a_22', 'a_27', 'a_25', 'a_26', 'a_24'}
DEBUG 2021-02-04 12:42:12,494[pattern_generator.py:gen_patterns:734]max_sample_factor*original_pt_size: 117952
DEBUG 2021-02-04 12:42:12,494[pattern_generator.py:gen_patterns:735]math.ceil(user_p_size*s_rate_for_s) : 1130
DEBUG 2021-02-04 12:42:12,494[pattern_generator.py:gen_patterns:742]500
DEBUG 2021-02-04 12:42:16,258[pattern_generator.py:gen_patterns:981]   a_15   a_20
0  15.0  82.68
1  15.0  59.66
2  24.0  59.52
3   1.0  65.13
4   5.0  53.53
DEBUG 2021-02-04 12:42:21,074[pattern_generator.py:gen_patterns:990][['a_20', 0.9480569452421497], ['a_15', 0.05194305475785031]]
DEBUG 2021-02-04 12:43:36,114[experiments.py:run_experiment:272]we are on join graph number 3
DEBUG 2021-02-04 12:43:36,114[experiments.py:run_experiment:274]'medicare vs private'
DEBUG 2021-02-04 12:43:36,504[pattern_generator.py:gen_patterns:595]jg_apt_size : 53047
DEBUG 2021-02-04 12:43:36,954[pattern_generator.py:gen_patterns:631]{'sample': {'yes': 22090, 'no': 27640}}
DEBUG 2021-02-04 12:43:37,026[pattern_generator.py:gen_patterns:697]{'max_rel_index': 4, 'max_attr_index': 34, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'ordinal', 'a_17': 'ordinal', 'a_18': 'ordinal', 'a_19': 'ordinal', 'a_20': 'nominal', 'a_21': 'nominal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'nominal', 'a_26': 'nominal', 'a_27': 'nominal', 'a_28': 'nominal', 'a_29': 'nominal', 'a_30': 'nominal', 'a_31': 'nominal', 'a_32': 'ordinal', 'a_33': 'nominal', 'a_34': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'icustays', 'columns': {'a_16': 'los', 'a_17': 'subject_id', 'a_18': 'hadm_id', 'a_19': 'icustay_id', 'a_20': 'dbsource', 'a_21': 'first_careunit', 'a_22': 'last_careunit', 'a_23': 'first_wardid', 'a_24': 'last_wardid', 'a_25': 'intime', 'a_26': 'outtime', 'a_27': 'los_group'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 27}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_28': 'dod_ssn', 'a_29': 'dod_hosp', 'a_30': 'dod', 'a_31': 'dob', 'a_32': 'subject_id', 'a_33': 'gender', 'a_34': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 27, 'rel_max_attr_index': 34}}
DEBUG 2021-02-04 12:43:37,027[pattern_generator.py:gen_patterns:698]{'a_28', 'a_32', 'a_30', 'a_34', 'a_31', 'a_29', 'a_33'}
DEBUG 2021-02-04 12:43:37,028[pattern_generator.py:gen_patterns:734]max_sample_factor*original_pt_size: 117952
DEBUG 2021-02-04 12:43:37,028[pattern_generator.py:gen_patterns:735]math.ceil(user_p_size*s_rate_for_s) : 1162
DEBUG 2021-02-04 12:43:37,028[pattern_generator.py:gen_patterns:742]500
DEBUG 2021-02-04 12:43:41,672[pattern_generator.py:gen_patterns:981]   a_15    a_16
0  16.0  2.0747
1   5.0  0.8868
2   9.0  3.8797
3   5.0  0.7127
4   8.0  1.0979
DEBUG 2021-02-04 12:43:47,073[pattern_generator.py:gen_patterns:990][['a_16', 0.7524833503861493], ['a_15', 0.24751664961385073]]
DEBUG 2021-02-04 12:45:11,351[experiments.py:run_experiment:272]we are on join graph number 4
DEBUG 2021-02-04 12:45:11,351[experiments.py:run_experiment:274]'medicare vs private'
DEBUG 2021-02-04 12:45:14,503[pattern_generator.py:gen_patterns:595]jg_apt_size : 568970
DEBUG 2021-02-04 12:45:19,607[pattern_generator.py:gen_patterns:631]{'sample': {'yes': 22582, 'no': 28215}}
DEBUG 2021-02-04 12:45:20,211[pattern_generator.py:gen_patterns:697]{'max_rel_index': 4, 'max_attr_index': 27, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'ordinal', 'a_17': 'nominal', 'a_18': 'nominal', 'a_19': 'ordinal', 'a_20': 'ordinal', 'a_21': 'nominal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'ordinal', 'a_26': 'nominal', 'a_27': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'diagnoses', 'columns': {'a_16': 'hadm_id', 'a_17': 'icd9_code', 'a_18': 'chapter', 'a_19': 'subject_id', 'a_20': 'seq_num'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 20}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_21': 'dod_ssn', 'a_22': 'dod_hosp', 'a_23': 'dod', 'a_24': 'dob', 'a_25': 'subject_id', 'a_26': 'gender', 'a_27': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 20, 'rel_max_attr_index': 27}}
DEBUG 2021-02-04 12:45:20,211[pattern_generator.py:gen_patterns:698]{'a_23', 'a_22', 'a_27', 'a_21', 'a_25', 'a_26', 'a_24'}
DEBUG 2021-02-04 12:45:20,213[pattern_generator.py:gen_patterns:734]max_sample_factor*original_pt_size: 117952
DEBUG 2021-02-04 12:45:20,213[pattern_generator.py:gen_patterns:735]math.ceil(user_p_size*s_rate_for_s) : 10027
DEBUG 2021-02-04 12:45:20,213[pattern_generator.py:gen_patterns:742]500
DEBUG 2021-02-04 12:45:26,008[pattern_generator.py:gen_patterns:981]   a_15
0  10.0
1  11.0
2   6.0
3   3.0
4   7.0
DEBUG 2021-02-04 12:45:28,645[pattern_generator.py:gen_patterns:990][['a_15', 1.0]]
DEBUG 2021-02-04 12:47:42,613[experiments.py:run_experiment:272]we are on join graph number 5
DEBUG 2021-02-04 12:47:42,614[experiments.py:run_experiment:274]'medicare vs private'
DEBUG 2021-02-04 12:47:43,817[pattern_generator.py:gen_patterns:595]jg_apt_size : 210184
DEBUG 2021-02-04 12:47:45,368[pattern_generator.py:gen_patterns:631]{'sample': {'yes': 20327, 'no': 24895}}
DEBUG 2021-02-04 12:47:45,600[pattern_generator.py:gen_patterns:697]{'max_rel_index': 4, 'max_attr_index': 27, 'dtypes': {'insurance': 'nominal', 'death_rate': 'nominal', 'a_1': 'ordinal', 'a_2': 'nominal', 'a_3': 'nominal', 'a_4': 'nominal', 'a_5': 'nominal', 'a_6': 'nominal', 'a_7': 'nominal', 'a_8': 'nominal', 'a_9': 'nominal', 'a_10': 'nominal', 'a_11': 'nominal', 'a_12': 'nominal', 'a_13': 'ordinal', 'a_14': 'nominal', 'a_15': 'ordinal', 'pnumber': 'nominal', 'is_user': 'nominal', 'a_16': 'nominal', 'a_17': 'nominal', 'a_18': 'ordinal', 'a_19': 'ordinal', 'a_20': 'ordinal', 'a_21': 'nominal', 'a_22': 'nominal', 'a_23': 'nominal', 'a_24': 'nominal', 'a_25': 'ordinal', 'a_26': 'nominal', 'a_27': 'nominal'}, 1: {'key': 1, 'label': 'PT', 'columns': {'insurance': 'insurance', 'death_rate': 'death_rate', 'a_1': 'prov_admissions_hadm__id', 'a_2': 'prov_admissions_admittime', 'a_3': 'prov_admissions_dischtime', 'a_4': 'prov_admissions_deathtime', 'a_5': 'prov_admissions_admission__type', 'a_6': 'prov_admissions_admission__location', 'a_7': 'prov_admissions_discharge__location', 'a_8': 'prov_admissions_insurance', 'a_9': 'prov_admissions_marital__status', 'a_10': 'prov_admissions_edregtime', 'a_11': 'prov_admissions_edouttime', 'a_12': 'prov_admissions_diagnosis', 'a_13': 'prov_admissions_hospital__expire__flag', 'a_14': 'prov_admissions_has__chartevents__data', 'a_15': 'prov_admissions_hospital__stay__length', 'pnumber': 'pnumber', 'is_user': 'is_user'}, 'renamed_rel': 'A_1', 'rel_min_attr_index': 0, 'rel_max_attr_index': 15}, 2: {'key': 2, 'label': 'procedures', 'columns': {'a_16': 'chapter', 'a_17': 'icd9_code', 'a_18': 'seq_num', 'a_19': 'hadm_id', 'a_20': 'subject_id'}, 'renamed_rel': 'A_2', 'rel_min_attr_index': 15, 'rel_max_attr_index': 20}, 3: {'key': 3, 'label': 'patients', 'columns': {'a_21': 'dod_ssn', 'a_22': 'dod_hosp', 'a_23': 'dod', 'a_24': 'dob', 'a_25': 'subject_id', 'a_26': 'gender', 'a_27': 'expire_flag'}, 'renamed_rel': 'A_3', 'rel_min_attr_index': 20, 'rel_max_attr_index': 27}}
DEBUG 2021-02-04 12:47:45,601[pattern_generator.py:gen_patterns:698]{'a_23', 'a_22', 'a_27', 'a_21', 'a_25', 'a_26', 'a_24'}
DEBUG 2021-02-04 12:47:45,602[pattern_generator.py:gen_patterns:734]max_sample_factor*original_pt_size: 117952
DEBUG 2021-02-04 12:47:45,602[pattern_generator.py:gen_patterns:735]math.ceil(user_p_size*s_rate_for_s) : 4489
DEBUG 2021-02-04 12:47:45,602[pattern_generator.py:gen_patterns:742]500
DEBUG 2021-02-04 12:47:49,860[pattern_generator.py:gen_patterns:981]   a_15
0  25.0
1   2.0
2  11.0
3   9.0
4  56.0
DEBUG 2021-02-04 12:47:52,708[pattern_generator.py:gen_patterns:990][['a_15', 1.0]]
DEBUG 2021-02-04 12:48:48,749[experiments.py:run_experiment:362]total number of patterns 1610
